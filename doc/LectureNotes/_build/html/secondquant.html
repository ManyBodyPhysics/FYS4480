
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. Introduction to second quantization &#8212; Quantum Mechanics for Many-Particle Systems; from standard methods to quantum computing and machine learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'secondquant';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Full configuration interaction theory" href="fci.html" />
    <link rel="prev" title="1. Introduction to many-body physics" href="notation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Quantum Mechanics for Many-Particle Systems; from standard methods to quantum computing and machine learning - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Quantum Mechanics for Many-Particle Systems; from standard methods to quantum computing and machine learning - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Quantum mechanics for many-particle systems
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About the course</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="schedule.html">Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="teachers.html">Instructor information</a></li>
<li class="toctree-l1"><a class="reference internal" href="textbooks.html">Textbooks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics of Many-Body Physics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notation.html">1. Introduction to many-body physics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. Introduction to  second quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="fci.html">3. Full configuration interaction theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="hfock.html">4. Hartree-Fock theory</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Post Hartree-Fock Methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="mbpt.html">6. Many-body perturbation theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="cc.html">7. The Coupled Cluster Method</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Stochastic Methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="vmcdmc.html">10. Variational Monte Carlo methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="gradientmethods.html">11. Gradient Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="resamplingmethods.html">12. Resampling Techniques, Bootstrap and Blocking</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deep Learning methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="boltzmannmachines.html">13. Boltzmann Machines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computational Aspects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="vectorization.html">14. Optimization and Vectorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">15. Parallelization with MPI and OpenMPI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/secondquant.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/secondquant.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to  second quantization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-body-operators-in-second-quantization">2.1. One-body operators in second quantization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-body-operators-in-second-quantization">2.2. Two-body operators in second quantization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-wick-s-theorem">2.3. Proof of Wick’s theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaction-schroedinger-and-heisenberg-pictures">2.4. Interaction, Schroedinger and Heisenberg pictures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-wick-s-theorem">2.5. Time dependent wick’s theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gell-man-and-low-s-theorem-and-adiabatic-switching">2.6. Gell-Man and Low’s theorem and Adiabatic switching</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#particle-hole-formalism">2.7. Particle-hole formalism</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summarizing-and-defining-a-normal-ordered-hamiltonian">2.8. Summarizing and defining a normal-ordered Hamiltonian</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators-in-second-quantization">2.9. Operators in second quantization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schr-odinger-picture">2.10. Schr”odinger picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaction-picture">2.11. Interaction picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heisenberg-picture">2.12. Heisenberg picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adiabatic-hypothesis">2.13. Adiabatic hypothesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wigner-jordan-transformation-and-second-quantization">2.14. Wigner-Jordan transformation and second quantization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#baker-campbell-hausdorf">2.15. Baker-Campbell-Hausdorf</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-relation-between-basis-functions">2.16. Exercise 1: Relation between basis functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-matrix-elements">2.17. Exercise 2: Matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-normal-ordered-one-body-operator">2.18. Exercise 3: Normal-ordered one-body operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-normal-ordered-two-body-operator">2.19. Exercise 4: Normal-ordered two-body operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5-matrix-elements-using-the-slater-condon-rule">2.20. Exercise 5: Matrix elements using the Slater-Condon rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6-program-to-set-up-slater-determinants">2.21. Exercise 6: Program to set up Slater determinants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-using-sympy-to-compute-matrix-elements">2.22. Exercise 7: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-using-sympy-to-compute-matrix-elements">2.23. Exercise 8: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9-using-sympy-to-compute-matrix-elements">2.24. Exercise 9: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-using-sympy-to-compute-matrix-elements">2.25. Exercise 10: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-using-sympy-to-compute-matrix-elements">2.26. Exercise 11: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12-using-sympy-to-compute-matrix-elements">2.27. Exercise 12: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-13-using-sympy-to-compute-matrix-elements">2.28. Exercise 13: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-14-diagrammatic-representation-of-hartree-fock-equations">2.29. Exercise 14: Diagrammatic representation of Hartree-Fock equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-15-derivation-of-hartree-fock-equations">2.30. Exercise 15: Derivation of Hartree-Fock equations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <!-- HTML file automatically generated from DocOnce source (https://github.com/doconce/doconce/)
doconce format html secondquant.do.txt  --><section class="tex2jax_ignore mathjax_ignore" id="introduction-to-second-quantization">
<h1><span class="section-number">2. </span>Introduction to  second quantization<a class="headerlink" href="#introduction-to-second-quantization" title="Link to this heading">#</a></h1>
<p>We introduce the time-independent  operators
<span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> and <span class="math notranslate nohighlight">\(a_\alpha\)</span>   which create and annihilate, respectively, a particle
in the single-particle state
<span class="math notranslate nohighlight">\(\varphi_\alpha\)</span>.
We define the fermion creation operator
<span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span></p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-1a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha^{\dagger}|0\rangle \equiv  |\alpha\rangle  \label{eq:2-1a} \tag{1},
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-1b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha^{\dagger}|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \equiv  |\alpha\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \label{eq:2-1b} \tag{2}
\end{equation}
\]</div>
<p>In Eq. (<a class="reference internal" href="#eq:2-1a"><span class="xref myst">1</span></a>)
the operator  <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span>  acts on the vacuum state
<span class="math notranslate nohighlight">\(|0\rangle\)</span>, which does not contain any particles. Alternatively, we could define  a closed-shell nucleus or atom as our new vacuum, but then
we need to introduce the particle-hole  formalism, see the discussion to come.</p>
<p>In Eq. (<a class="reference internal" href="#eq:2-1b"><span class="xref myst">2</span></a>) <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> acts on an antisymmetric <span class="math notranslate nohighlight">\(n\)</span>-particle state and
creates an antisymmetric <span class="math notranslate nohighlight">\((n+1)\)</span>-particle state, where the one-body state
<span class="math notranslate nohighlight">\(\varphi_\alpha\)</span> is occupied, under the condition that
<span class="math notranslate nohighlight">\(\alpha \ne \alpha_1, \alpha_2, \dots, \alpha_n\)</span>.
It follows that we can express an antisymmetric state as the product of the creation
operators acting on the vacuum state.</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle \label{eq:2-2} \tag{3}
\end{equation}
\]</div>
<p>It is easy to derive the commutation and anticommutation rules  for the fermionic creation operators
<span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span>. Using the antisymmetry of the states
(<a class="reference internal" href="#eq:2-2"><span class="xref myst">3</span></a>)</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-3a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\dots \alpha_i\dots \alpha_k\dots \alpha_n\rangle_{\mathrm{AS}} = 
		- |\alpha_1\dots \alpha_k\dots \alpha_i\dots \alpha_n\rangle_{\mathrm{AS}} \label{eq:2-3a} \tag{4}
\end{equation}
\]</div>
<p>we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-3b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	 a_{\alpha_i}^{\dagger}  a_{\alpha_k}^{\dagger} = - a_{\alpha_k}^{\dagger} a_{\alpha_i}^{\dagger} \label{eq:2-3b} \tag{5}
\end{equation}
\]</div>
<p>Using the Pauli principle</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-4a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\dots \alpha_i\dots \alpha_i\dots \alpha_n\rangle_{\mathrm{AS}} = 0 \label{eq:2-4a} \tag{6}
\end{equation}
\]</div>
<p>it follows that</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-4b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_{\alpha_i}^{\dagger}  a_{\alpha_i}^{\dagger} = 0. \label{eq:2-4b} \tag{7}
\end{equation}
\]</div>
<p>If we combine Eqs. (<a class="reference internal" href="#eq:2-3b"><span class="xref myst">5</span></a>) and (<a class="reference internal" href="#eq:2-4b"><span class="xref myst">7</span></a>), we obtain the well-known anti-commutation rule</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-5"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_{\alpha}^{\dagger}  a_{\beta}^{\dagger} + a_{\beta}^{\dagger}  a_{\alpha}^{\dagger} \equiv 
		\{a_{\alpha}^{\dagger},a_{\beta}^{\dagger}\} = 0 \label{eq:2-5} \tag{8}
\end{equation}
\]</div>
<p>The hermitian conjugate  of <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> is</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-6"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_{\alpha} = ( a_{\alpha}^{\dagger} )^{\dagger} \label{eq:2-6} \tag{9}
\end{equation}
\]</div>
<p>If we take the hermitian conjugate of Eq. (<a class="reference internal" href="#eq:2-5"><span class="xref myst">8</span></a>), we arrive at</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-7"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\{a_{\alpha},a_{\beta}\} = 0 \label{eq:2-7} \tag{10}
\end{equation}
\]</div>
<p>What is the physical interpretation of the operator <span class="math notranslate nohighlight">\(a_\alpha\)</span> and what is the effect of
<span class="math notranslate nohighlight">\(a_\alpha\)</span> on a given state <span class="math notranslate nohighlight">\(|\alpha_1\alpha_2\dots\alpha_n\rangle_{\mathrm{AS}}\)</span>?
Consider the following matrix element</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-8"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_m'\rangle \label{eq:2-8} \tag{11}
\end{equation}
\]</div>
<p>where both sides are antisymmetric. We  distinguish between two cases. The first (1) is when
<span class="math notranslate nohighlight">\(\alpha \in \{\alpha_i\}\)</span>. Using the Pauli principle of Eq. (<a class="reference internal" href="#eq:2-4a"><span class="xref myst">6</span></a>) it follows</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-9a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
		\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha = 0 \label{eq:2-9a} \tag{12}
\end{equation}
\]</div>
<p>The second (2) case is when <span class="math notranslate nohighlight">\(\alpha \notin \{\alpha_i\}\)</span>. It follows that an hermitian conjugation</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-9b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
		\langle \alpha_1\alpha_2 \dots \alpha_n|a_\alpha = \langle\alpha\alpha_1\alpha_2 \dots \alpha_n|  \label{eq:2-9b} \tag{13}
\end{equation}
\]</div>
<p>Eq. (<a class="reference internal" href="#eq:2-9b"><span class="xref myst">13</span></a>) holds for case (1) since the lefthand side is zero due to the Pauli principle. We write
Eq. (<a class="reference internal" href="#eq:2-8"><span class="xref myst">11</span></a>) as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-10"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_m'\rangle = 
	\langle \alpha_1\alpha_2 \dots \alpha_n|\alpha\alpha_1'\alpha_2' \dots \alpha_m'\rangle \label{eq:2-10} \tag{14}
\end{equation}
\]</div>
<p>Here we must have <span class="math notranslate nohighlight">\(m = n+1\)</span> if Eq. (<a class="reference internal" href="#eq:2-10"><span class="xref myst">14</span></a>) has to be trivially different from zero.</p>
<p>For the last case, the minus and plus signs apply when the sequence
<span class="math notranslate nohighlight">\(\alpha ,\alpha_1, \alpha_2, \dots, \alpha_n\)</span> and
<span class="math notranslate nohighlight">\(\alpha_1', \alpha_2', \dots, \alpha_{n+1}'\)</span> are related to each other via even and odd permutations.
If we assume that  <span class="math notranslate nohighlight">\(\alpha \notin \{\alpha_i\}\)</span> we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-12"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_{n+1}'\rangle = 0 \label{eq:2-12} \tag{15}
\end{equation}
\]</div>
<p>when <span class="math notranslate nohighlight">\(\alpha \in \{\alpha_i'\}\)</span>. If <span class="math notranslate nohighlight">\(\alpha \notin \{\alpha_i'\}\)</span>, we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-13a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha\underbrace{|\alpha_1'\alpha_2' \dots \alpha_{n+1}'}\rangle_{\neq \alpha} = 0 \label{eq:2-13a} \tag{16}
\end{equation}
\]</div>
<p>and in particular</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-13b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha |0\rangle = 0 \label{eq:2-13b} \tag{17}
\end{equation}
\]</div>
<p>If <span class="math notranslate nohighlight">\(\{\alpha\alpha_i\} = \{\alpha_i'\}\)</span>, performing the right permutations, the sequence
<span class="math notranslate nohighlight">\(\alpha ,\alpha_1, \alpha_2, \dots, \alpha_n\)</span> is identical with the sequence
<span class="math notranslate nohighlight">\(\alpha_1', \alpha_2', \dots, \alpha_{n+1}'\)</span>. This results in</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-14"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 1 \label{eq:2-14} \tag{18}
\end{equation}
\]</div>
<p>and thus</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-15"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha |\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-15} \tag{19}
\end{equation}
\]</div>
<p>The action of the operator
<span class="math notranslate nohighlight">\(a_\alpha\)</span> from the left on a state vector  is to to remove  one particle in the state
<span class="math notranslate nohighlight">\(\alpha\)</span>.
If the state vector does not contain the single-particle state <span class="math notranslate nohighlight">\(\alpha\)</span>, the outcome of the operation is zero.
The operator  <span class="math notranslate nohighlight">\(a_\alpha\)</span> is normally called for a destruction or annihilation operator.</p>
<p>The next step is to establish the  commutator algebra of <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> and
<span class="math notranslate nohighlight">\(a_\beta\)</span>.</p>
<p>The action of the anti-commutator
<span class="math notranslate nohighlight">\(\{a_\alpha^{\dagger}\)</span>,<span class="math notranslate nohighlight">\(a_\alpha\}\)</span> on a given <span class="math notranslate nohighlight">\(n\)</span>-particle state is</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\alpha \underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} = 0 \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-16a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	a_\alpha a_\alpha^{\dagger} \underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} =
	a_\alpha \underbrace{|\alpha \alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} = 
	\underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} \label{eq:2-16a} \tag{20}
\end{equation}
\]</div>
<p>if the single-particle state <span class="math notranslate nohighlight">\(\alpha\)</span> is not contained in the state.</p>
<p>If it is present
we arrive at</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\alpha |\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle =
	a_\alpha^{\dagger} a_\alpha (-1)^k |\alpha \alpha_1\alpha_2 \dots \alpha_{n-1}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= (-1)^k |\alpha \alpha_1\alpha_2 \dots \alpha_{n-1}\rangle =
	|\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-16b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	a_\alpha a_\alpha^{\dagger}|\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle = 0 \label{eq:2-16b} \tag{21}
\end{equation}
\]</div>
<p>From Eqs. (<a class="reference internal" href="#eq:2-16a"><span class="xref myst">20</span></a>) and  (<a class="reference internal" href="#eq:2-16b"><span class="xref myst">21</span></a>) we arrive at</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-17"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\{a_\alpha^{\dagger} , a_\alpha \} = a_\alpha^{\dagger} a_\alpha + a_\alpha a_\alpha^{\dagger} = 1 \label{eq:2-17} \tag{22}
\end{equation}
\]</div>
<p>The action of <span class="math notranslate nohighlight">\(\left\{a_\alpha^{\dagger}, a_\beta\right\}\)</span>, with
<span class="math notranslate nohighlight">\(\alpha \ne \beta\)</span> on a given state yields three possibilities.
The first case is a state vector which contains both <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>, then either
<span class="math notranslate nohighlight">\(\alpha\)</span> or <span class="math notranslate nohighlight">\(\beta\)</span> and finally none of them.</p>
<p>The first case results in</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\beta |\alpha\beta\alpha_1\alpha_2 \dots \alpha_{n-2}\rangle = 0 \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-18a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	a_\beta a_\alpha^{\dagger} |\alpha\beta\alpha_1\alpha_2 \dots \alpha_{n-2}\rangle = 0 \label{eq:2-18a} \tag{23}
\end{equation}
\]</div>
<p>while the second case gives</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\beta |\beta \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle = 
	 	|\alpha \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq  \alpha}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
a_\beta a_\alpha^{\dagger} |\beta \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle =
		a_\beta |\alpha\beta\underbrace{\beta \alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-18b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= - |\alpha\underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle \label{eq:2-18b} \tag{24}
\end{equation}
\]</div>
<p>Finally if the state vector does not contain <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span></p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\beta |\underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle = 0 \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-18c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	a_\beta a_\alpha^{\dagger} |\underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle = 
		a_\beta |\alpha \underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle = 0 \label{eq:2-18c} \tag{25}
\end{equation}
\]</div>
<p>For all three cases we have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-19"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\{a_\alpha^{\dagger},a_\beta \} = a_\alpha^{\dagger} a_\beta + a_\beta a_\alpha^{\dagger} = 0, \quad \alpha \neq \beta \label{eq:2-19} \tag{26}
\end{equation}
\]</div>
<p>We can summarize  our findings in Eqs. (<a class="reference internal" href="#eq:2-17"><span class="xref myst">22</span></a>) and (<a class="reference internal" href="#eq:2-19"><span class="xref myst">26</span></a>) as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-20"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\{a_\alpha^{\dagger},a_\beta \} = \delta_{\alpha\beta} \label{eq:2-20} \tag{27}
\end{equation}
\]</div>
<p>with  <span class="math notranslate nohighlight">\(\delta_{\alpha\beta}\)</span> is the Kroenecker <span class="math notranslate nohighlight">\(\delta\)</span>-symbol.</p>
<p>The properties of the creation and annihilation operators can be summarized as (for fermions)</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger}|0\rangle \equiv  |\alpha\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger}|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \equiv  |\alpha\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}}.
\]</div>
<p>from which follows</p>
<div class="math notranslate nohighlight">
\[
|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
\]</div>
<p>The hermitian conjugate has the folowing properties</p>
<div class="math notranslate nohighlight">
\[
a_{\alpha} = ( a_{\alpha}^{\dagger} )^{\dagger}.
\]</div>
<p>Finally we found</p>
<div class="math notranslate nohighlight">
\[
a_\alpha\underbrace{|\alpha_1'\alpha_2' \dots \alpha_{n+1}'}\rangle_{\neq \alpha} = 0, \quad
		\textrm{in particular } a_\alpha |0\rangle = 0,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
a_\alpha |\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = |\alpha_1\alpha_2 \dots \alpha_{n}\rangle,
\]</div>
<p>and the corresponding commutator algebra</p>
<div class="math notranslate nohighlight">
\[
\{a_{\alpha}^{\dagger},a_{\beta}^{\dagger}\} = \{a_{\alpha},a_{\beta}\} = 0 \hspace{0.5cm} 
\{a_\alpha^{\dagger},a_\beta \} = \delta_{\alpha\beta}.
\]</div>
<section id="one-body-operators-in-second-quantization">
<h2><span class="section-number">2.1. </span>One-body operators in second quantization<a class="headerlink" href="#one-body-operators-in-second-quantization" title="Link to this heading">#</a></h2>
<p>A very useful operator is the so-called number-operator.  Most physics cases  we will
study in this text conserve the total number of particles.  The number operator is therefore
a useful quantity which allows us to test that our many-body formalism  conserves the number of particles.
In for example <span class="math notranslate nohighlight">\((d,p)\)</span> or <span class="math notranslate nohighlight">\((p,d)\)</span> reactions it is important to be able to describe quantum mechanical states
where particles get added or removed.
A creation operator <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> adds one particle to the single-particle state
<span class="math notranslate nohighlight">\(\alpha\)</span> of a give many-body state vector, while an annihilation operator <span class="math notranslate nohighlight">\(a_\alpha\)</span>
removes a particle from a single-particle
state <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>Let us consider an operator proportional with <span class="math notranslate nohighlight">\(a_\alpha^{\dagger} a_\beta\)</span> and
<span class="math notranslate nohighlight">\(\alpha=\beta\)</span>. It acts on an <span class="math notranslate nohighlight">\(n\)</span>-particle state
resulting in</p>
<!-- Equation labels as ordinary links -->
<div id="_auto1"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
	a_\alpha^{\dagger} a_\alpha |\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 
	\begin{cases}
		0  &amp;\alpha \notin \{\alpha_i\} \\
		\\
		|\alpha_1\alpha_2 \dots \alpha_{n}\rangle &amp; \alpha \in \{\alpha_i\}
	\end{cases}
\label{_auto1} \tag{28}
\end{equation}
\end{split}\]</div>
<p>Summing over all possible one-particle states we arrive at</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-21"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\left( \sum_\alpha a_\alpha^{\dagger} a_\alpha \right) |\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 
	n |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-21} \tag{29}
\end{equation}
\]</div>
<p>The operator</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-22"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{N} = \sum_\alpha a_\alpha^{\dagger} a_\alpha \label{eq:2-22} \tag{30}
\end{equation}
\]</div>
<p>is called the number operator since it counts the number of particles in a give state vector when it acts
on the different single-particle states.  It acts on one single-particle state at the time and falls
therefore under category one-body operators.
Next we look at another important one-body operator, namely <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> and study its operator form in the
occupation number representation.</p>
<p>We want to obtain an expression for a one-body operator which conserves the number of particles.
Here we study the one-body operator for the kinetic energy plus an eventual external one-body potential.
The action of this operator on a particular <span class="math notranslate nohighlight">\(n\)</span>-body state with its pertinent expectation value has already
been studied in coordinate  space.
In coordinate space the operator reads</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-23"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_0 = \sum_i \hat{h}_0(x_i) \label{eq:2-23} \tag{31}
\end{equation}
\]</div>
<p>and the anti-symmetric <span class="math notranslate nohighlight">\(n\)</span>-particle Slater determinant is defined as</p>
<div class="math notranslate nohighlight">
\[
\Phi(x_1, x_2,\dots ,x_n,\alpha_1,\alpha_2,\dots, \alpha_n)= \frac{1}{\sqrt{n!}} \sum_p (-1)^p\hat{P}\psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n).
\]</div>
<p>Defining</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-25"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{h}_0(x_i) \psi_{\alpha_i}(x_i) = \sum_{\alpha_k'} \psi_{\alpha_k'}(x_i) \langle\alpha_k'|\hat{h}_0|\alpha_k\rangle \label{eq:2-25} \tag{32}
\end{equation}
\]</div>
<p>we can easily  evaluate the action of <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> on each product of one-particle functions in Slater determinant.
From Eq. (<a class="reference internal" href="#eq:2-25"><span class="xref myst">32</span></a>)  we obtain the following result without  permuting any particle pair</p>
<div class="math notranslate nohighlight">
\[
\left( \sum_i \hat{h}_0(x_i) \right) \psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
=\sum_{\alpha_1'} \langle \alpha_1'|\hat{h}_0|\alpha_1\rangle 
		\psi_{\alpha_1'}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+\sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2'}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-26"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+\sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n'}(x_n) \label{eq:2-26} \tag{33}
\end{equation}
\]</div>
<p>If we interchange particles <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(2\)</span>  we obtain</p>
<div class="math notranslate nohighlight">
\[
\left( \sum_i \hat{h}_0(x_i) \right) \psi_{\alpha_1}(x_2)\psi_{\alpha_1}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
=\sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle 
		\psi_{\alpha_1}(x_2)\psi_{\alpha_2'}(x_1) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+\sum_{\alpha_1'} \langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		\psi_{\alpha_1'}(x_2)\psi_{\alpha_2}(x_1) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-27"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+\sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		\psi_{\alpha_1}(x_2)\psi_{\alpha_1}(x_2) \dots \psi_{\alpha_n'}(x_n) \label{eq:2-27} \tag{34}
\end{equation}
\]</div>
<p>We can continue by computing all possible permutations.
We rewrite also our Slater determinant in its second quantized form and skip the dependence on the quantum numbers <span class="math notranslate nohighlight">\(x_i.\)</span>
Summing up all contributions and taking care of all phases
<span class="math notranslate nohighlight">\((-1)^p\)</span> we arrive at</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0|\alpha_1,\alpha_2,\dots, \alpha_n\rangle = \sum_{\alpha_1'}\langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		|\alpha_1'\alpha_2 \dots \alpha_{n}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		|\alpha_1\alpha_2' \dots \alpha_{n}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-28"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+ \sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		|\alpha_1\alpha_2 \dots \alpha_{n}'\rangle \label{eq:2-28} \tag{35}
\end{equation}
\]</div>
<p>In Eq. (<a class="reference internal" href="#eq:2-28"><span class="xref myst">35</span></a>)
we have expressed the action of the one-body operator
of Eq. (<a class="reference internal" href="#eq:2-23"><span class="xref myst">31</span></a>) on the  <span class="math notranslate nohighlight">\(n\)</span>-body state in its second quantized form.
This equation can be further manipulated if we use the properties of the creation and annihilation operator
on each primed quantum number, that is</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-29"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\alpha_2 \dots \alpha_k' \dots \alpha_{n}\rangle = 
		a_{\alpha_k'}^{\dagger}  a_{\alpha_k} |\alpha_1\alpha_2 \dots \alpha_k \dots \alpha_{n}\rangle \label{eq:2-29} \tag{36}
\end{equation}
\]</div>
<p>Inserting this in the right-hand side of Eq. (<a class="reference internal" href="#eq:2-28"><span class="xref myst">35</span></a>) results in</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0|\alpha_1\alpha_2 \dots \alpha_{n}\rangle = \sum_{\alpha_1'}\langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		a_{\alpha_1'}^{\dagger}  a_{\alpha_1} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		a_{\alpha_2'}^{\dagger}  a_{\alpha_2} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		a_{\alpha_n'}^{\dagger}  a_{\alpha_n} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \sum_{\alpha, \beta} \langle \alpha|\hat{h}_0|\beta\rangle a_\alpha^{\dagger} a_\beta 
		|\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-30a} \tag{37}
\end{equation}
\]</div>
<p>In the number occupation representation or second quantization we get the following expression for a one-body
operator which conserves the number of particles</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_0 = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle a_\alpha^{\dagger} a_\beta \label{eq:2-30b} \tag{38}
\end{equation}
\]</div>
<p>Obviously, <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> can be replaced by any other one-body  operator which preserved the number
of particles. The stucture of the operator is therefore not limited to say the kinetic or single-particle energy only.</p>
<p>The opearator <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> takes a particle from the single-particle state <span class="math notranslate nohighlight">\(\beta\)</span>  to the single-particle state <span class="math notranslate nohighlight">\(\alpha\)</span>
with a probability for the transition given by the expectation value <span class="math notranslate nohighlight">\(\langle \alpha|\hat{h}_0|\beta\rangle\)</span>.</p>
<p>It is instructive to verify Eq. (<a class="reference internal" href="#eq:2-30b"><span class="xref myst">38</span></a>) by computing the expectation value of <span class="math notranslate nohighlight">\(\hat{H}_0\)</span>
between two single-particle states</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle \alpha_1|\hat{h}_0|\alpha_2\rangle = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle
		\langle 0|a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger}|0\rangle \label{eq:2-30c} \tag{39}
\end{equation}
\]</div>
<p>Using the commutation relations for the creation and annihilation operators we have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30d"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger} = (\delta_{\alpha \alpha_1} - a_\alpha^{\dagger} a_{\alpha_1} )(\delta_{\beta \alpha_2} - a_{\alpha_2}^{\dagger} a_{\beta} ), \label{eq:2-30d} \tag{40}
\end{equation}
\]</div>
<p>which results in</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30e"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\langle 0|a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger}|0\rangle = \delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} \label{eq:2-30e} \tag{41}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30f"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\langle \alpha_1|\hat{h}_0|\alpha_2\rangle = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} = \langle \alpha_1|\hat{h}_0|\alpha_2\rangle \label{eq:2-30f} \tag{42}
\end{equation}
\]</div>
</section>
<section id="two-body-operators-in-second-quantization">
<h2><span class="section-number">2.2. </span>Two-body operators in second quantization<a class="headerlink" href="#two-body-operators-in-second-quantization" title="Link to this heading">#</a></h2>
<p>Let us now derive the expression for our two-body interaction part, which also conserves the number of particles.
We can proceed in exactly the same way as for the one-body operator. In the coordinate representation our
two-body interaction part takes the following expression</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-31"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I = \sum_{i &lt; j} V(x_i,x_j) \label{eq:2-31} \tag{43}
\end{equation}
\]</div>
<p>where the summation runs over distinct pairs. The term <span class="math notranslate nohighlight">\(V\)</span> can be an interaction model for the nucleon-nucleon interaction
or the interaction between two electrons. It can also include additional two-body interaction terms.</p>
<p>The action of this operator on a product of
two single-particle functions is defined as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-32"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	V(x_i,x_j) \psi_{\alpha_k}(x_i) \psi_{\alpha_l}(x_j) = \sum_{\alpha_k'\alpha_l'} 
		\psi_{\alpha_k}'(x_i)\psi_{\alpha_l}'(x_j) 
		\langle \alpha_k'\alpha_l'|\hat{v}|\alpha_k\alpha_l\rangle \label{eq:2-32} \tag{44}
\end{equation}
\]</div>
<p>We can now let <span class="math notranslate nohighlight">\(\hat{H}_I\)</span> act on all terms in the linear combination for <span class="math notranslate nohighlight">\(|\alpha_1\alpha_2\dots\alpha_n\rangle\)</span>. Without any permutations we have</p>
<div class="math notranslate nohighlight">
\[
\left( \sum_{i &lt; j} V(x_i,x_j) \right) \psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2)\dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \sum_{\alpha_1'\alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		\psi_{\alpha_1}'(x_1)\psi_{\alpha_2}'(x_2)\dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_1'\alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		\psi_{\alpha_1}'(x_1)\psi_{\alpha_2}(x_2)\dots \psi_{\alpha_n}'(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_2'\alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}'(x_2)\dots \psi_{\alpha_n}'(x_n) \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-33"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	  + \dots \label{eq:2-33} \tag{45}
\end{equation}
\]</div>
<p>where on the rhs we have a term for each distinct pairs.</p>
<p>For the other terms on the rhs we obtain similar expressions  and summing over all terms we obtain</p>
<div class="math notranslate nohighlight">
\[
H_I |\alpha_1\alpha_2\dots\alpha_n\rangle = \sum_{\alpha_1', \alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		|\alpha_1'\alpha_2'\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_1', \alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		|\alpha_1'\alpha_2\dots\alpha_n'\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_2', \alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		|\alpha_1\alpha_2'\dots\alpha_n'\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-34"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	 + \dots \label{eq:2-34} \tag{46}
\end{equation}
\]</div>
<p>We introduce second quantization via the relation</p>
<div class="math notranslate nohighlight">
\[
a_{\alpha_k'}^{\dagger} a_{\alpha_l'}^{\dagger} a_{\alpha_l} a_{\alpha_k} 
		|\alpha_1\alpha_2\dots\alpha_k\dots\alpha_l\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= (-1)^{k-1} (-1)^{l-2} a_{\alpha_k'}^{\dagger} a_{\alpha_l'}^{\dagger} a_{\alpha_l} a_{\alpha_k}
		|\alpha_k\alpha_l \underbrace{\alpha_1\alpha_2\dots\alpha_n}_{\neq \alpha_k,\alpha_l}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= (-1)^{k-1} (-1)^{l-2} 
	|\alpha_k'\alpha_l' \underbrace{\alpha_1\alpha_2\dots\alpha_n}_{\neq \alpha_k',\alpha_l'}\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-35"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= |\alpha_1\alpha_2\dots\alpha_k'\dots\alpha_l'\dots\alpha_n\rangle \label{eq:2-35} \tag{47}
\end{equation}
\]</div>
<p>Inserting this in (<a class="reference internal" href="#eq:2-34"><span class="xref myst">46</span></a>) gives</p>
<div class="math notranslate nohighlight">
\[
H_I |\alpha_1\alpha_2\dots\alpha_n\rangle
	= \sum_{\alpha_1', \alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		a_{\alpha_1'}^{\dagger} a_{\alpha_2'}^{\dagger} a_{\alpha_2} a_{\alpha_1}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \sum_{\alpha_1', \alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		a_{\alpha_1'}^{\dagger} a_{\alpha_n'}^{\dagger} a_{\alpha_n} a_{\alpha_1}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \sum_{\alpha_2', \alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		a_{\alpha_2'}^{\dagger} a_{\alpha_n'}^{\dagger} a_{\alpha_n} a_{\alpha_2}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-36"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \sum_{\alpha, \beta, \gamma, \delta} ' \langle \alpha\beta|\hat{v}|\gamma\delta\rangle
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma
		|\alpha_1\alpha_2\dots\alpha_n\rangle \label{eq:2-36} \tag{48}
\end{equation}
\]</div>
<p>Here we let <span class="math notranslate nohighlight">\(\sum'\)</span> indicate that the sums running over <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> run over all
single-particle states, while the summations  <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span>
run over all pairs of single-particle states. We wish to remove this restriction and since</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-37"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle \alpha\beta|\hat{v}|\gamma\delta\rangle = \langle \beta\alpha|\hat{v}|\delta\gamma\rangle \label{eq:2-37} \tag{49}
\end{equation}
\]</div>
<p>we get</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-38a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma = 
		\sum_{\alpha\beta} \langle \beta\alpha|\hat{v}|\delta\gamma\rangle 
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma \label{eq:2-38a} \tag{50} 
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-38b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \sum_{\alpha\beta}\langle \beta\alpha|\hat{v}|\delta\gamma\rangle
		a^{\dagger}_\beta a^{\dagger}_\alpha a_\gamma a_\delta \label{eq:2-38b} \tag{51}
\end{equation}
\]</div>
<p>where we  have used the anti-commutation rules.</p>
<p>Changing the summation indices
<span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> in (<a class="reference internal" href="#eq:2-38b"><span class="xref myst">51</span></a>) we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-38c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma =
		 \sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\delta\gamma\rangle 
		  a^{\dagger}_\alpha a^{\dagger}_\beta  a_\gamma a_\delta \label{eq:2-38c} \tag{52}
\end{equation}
\]</div>
<p>From this it follows that the restriction on the summation over <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span> can be removed if we multiply with a factor <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>, resulting in</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-39"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I = \frac{1}{2} \sum_{\alpha\beta\gamma\delta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma \label{eq:2-39} \tag{53}
\end{equation}
\]</div>
<p>where we sum freely over all single-particle states <span class="math notranslate nohighlight">\(\alpha\)</span>,
<span class="math notranslate nohighlight">\(\beta\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span> og <span class="math notranslate nohighlight">\(\delta\)</span>.</p>
<p>With this expression we can now verify that the second quantization form of <span class="math notranslate nohighlight">\(\hat{H}_I\)</span> in Eq. (<a class="reference internal" href="#eq:2-39"><span class="xref myst">53</span></a>)
results in the same matrix between two anti-symmetrized two-particle states as its corresponding coordinate
space representation. We have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-40"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle \alpha_1 \alpha_2|\hat{H}_I|\beta_1 \beta_2\rangle =
		\frac{1}{2} \sum_{\alpha\beta\gamma\delta}
			\langle \alpha\beta|\hat{v}|\gamma\delta\rangle \langle 0|a_{\alpha_2} a_{\alpha_1} 
			 a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma 
			 a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger}|0\rangle. \label{eq:2-40} \tag{54}
\end{equation}
\]</div>
<p>Using the commutation relations we get</p>
<div class="math notranslate nohighlight">
\[
a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		a_\delta a_\gamma a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		( a_\delta \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} - 
		a_\delta  a_{\beta_1}^{\dagger} a_\gamma a_{\beta_2}^{\dagger} ) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} a_\delta -
		a_\delta a_{\beta_1}^{\dagger}\delta_{\gamma \beta_2} +
		a_\delta a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} a_\gamma ) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} a_\delta \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-41"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
		 \qquad - \delta_{\delta \beta_1} \delta_{\gamma \beta_2} + \delta_{\gamma \beta_2} a_{\beta_1}^{\dagger} a_\delta
		+ a_\delta a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} a_\gamma ) \label{eq:2-41} \tag{55}
\end{equation}
\]</div>
<p>The vacuum expectation value of this product of operators becomes</p>
<div class="math notranslate nohighlight">
\[
\langle 0|a_{\alpha_2} a_{\alpha_1} a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma 
		a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger}|0\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -
		\delta_{\delta \beta_1} \delta_{\gamma \beta_2} ) 
		\langle 0|a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta|0\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-42b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -\delta_{\delta \beta_1} \delta_{\gamma \beta_2} )
	(\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} -\delta_{\beta \alpha_1} \delta_{\alpha \alpha_2} ) \label{eq:2-42b} \tag{56}
\end{equation}
\]</div>
<p>Insertion of
Eq. (<a class="reference internal" href="#eq:2-42b"><span class="xref myst">56</span></a>) in Eq. (<a class="reference internal" href="#eq:2-40"><span class="xref myst">54</span></a>) results in</p>
<div class="math notranslate nohighlight">
\[
\langle \alpha_1\alpha_2|\hat{H}_I|\beta_1\beta_2\rangle = \frac{1}{2} \big[ 
		\langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle- \langle \alpha_1\alpha_2|\hat{v}|\beta_2\beta_1\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
- \langle \alpha_2\alpha_1|\hat{v}|\beta_1\beta_2\rangle + \langle \alpha_2\alpha_1|\hat{v}|\beta_2\beta_1\rangle \big] \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle - \langle \alpha_1\alpha_2|\hat{v}|\beta_2\beta_1\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-43b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle_{\mathrm{AS}}. \label{eq:2-43b} \tag{57}
\end{equation}
\]</div>
<p>The two-body operator can also be expressed in terms of the anti-symmetrized matrix elements we discussed previously as</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I = \frac{1}{2} \sum_{\alpha\beta\gamma\delta}  \langle \alpha \beta|\hat{v}|\gamma \delta\rangle
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \frac{1}{4} \sum_{\alpha\beta\gamma\delta} \left[ \langle \alpha \beta|\hat{v}|\gamma \delta\rangle -
		\langle \alpha \beta|\hat{v}|\delta\gamma \rangle \right] 
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-45"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \frac{1}{4} \sum_{\alpha\beta\gamma\delta} \langle \alpha \beta|\hat{v}|\gamma \delta\rangle_{\mathrm{AS}}
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \label{eq:2-45} \tag{58}
\end{equation}
\]</div>
<p>The factors in front of the operator, either  <span class="math notranslate nohighlight">\(\frac{1}{4}\)</span> or
<span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> tells whether we use antisymmetrized matrix elements or not.</p>
<p>We can now express the Hamiltonian operator for a many-fermion system  in the occupation basis representation
as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-46b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	H = \sum_{\alpha, \beta} \langle \alpha|\hat{t}+\hat{u}_{\mathrm{ext}}|\beta\rangle a_\alpha^{\dagger} a_\beta + \frac{1}{4} \sum_{\alpha\beta\gamma\delta}
		\langle \alpha \beta|\hat{v}|\gamma \delta\rangle a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma. \label{eq:2-46b} \tag{59}
\end{equation}
\]</div>
<p>This is the form we will use in the rest of these lectures, assuming that we work with anti-symmetrized two-body matrix elements.</p>
</section>
<section id="proof-of-wick-s-theorem">
<h2><span class="section-number">2.3. </span>Proof of Wick’s theorem<a class="headerlink" href="#proof-of-wick-s-theorem" title="Link to this heading">#</a></h2>
<p>Discuss also Wick’s generalized theorem</p>
</section>
<section id="interaction-schroedinger-and-heisenberg-pictures">
<h2><span class="section-number">2.4. </span>Interaction, Schroedinger and Heisenberg pictures<a class="headerlink" href="#interaction-schroedinger-and-heisenberg-pictures" title="Link to this heading">#</a></h2>
</section>
<section id="time-dependent-wick-s-theorem">
<h2><span class="section-number">2.5. </span>Time dependent wick’s theorem<a class="headerlink" href="#time-dependent-wick-s-theorem" title="Link to this heading">#</a></h2>
</section>
<section id="gell-man-and-low-s-theorem-and-adiabatic-switching">
<h2><span class="section-number">2.6. </span>Gell-Man and Low’s theorem and Adiabatic switching<a class="headerlink" href="#gell-man-and-low-s-theorem-and-adiabatic-switching" title="Link to this heading">#</a></h2>
</section>
<section id="particle-hole-formalism">
<h2><span class="section-number">2.7. </span>Particle-hole formalism<a class="headerlink" href="#particle-hole-formalism" title="Link to this heading">#</a></h2>
<p>Second quantization is a useful and elegant formalism  for constructing many-body  states and
quantum mechanical operators. One can express and translate many physical processes
into simple pictures such as Feynman diagrams. Expecation values of many-body states are also easily calculated.
However, although the equations are seemingly easy to set up, from  a practical point of view, that is
the solution of Schroedinger’s equation, there is no particular gain.
The many-body equation is equally hard to solve, irrespective of representation.
The cliche that
there is no free lunch brings us down to earth again.<br />
Note however that a transformation to a particular
basis, for cases where the interaction obeys specific symmetries, can ease the solution of Schroedinger’s equation.</p>
<p>But there is at least one important case where second quantization comes to our rescue.
It is namely easy to introduce another reference state than the pure vacuum <span class="math notranslate nohighlight">\(|0\rangle \)</span>, where all single-particle states are active.
With many particles present it is often useful to introduce another reference state  than the vacuum state<span class="math notranslate nohighlight">\(|0\rangle \)</span>. We will label this state <span class="math notranslate nohighlight">\(|c\rangle\)</span> (<span class="math notranslate nohighlight">\(c\)</span> for core) and as we will see it can reduce
considerably the complexity and thereby the dimensionality of the many-body problem. It allows us to sum up to infinite order specific many-body correlations.  The particle-hole representation is one of these handy representations.</p>
<p>In the original particle representation these states are products of the creation operators  <span class="math notranslate nohighlight">\(a_{\alpha_i}^\dagger\)</span> acting on the true vacuum <span class="math notranslate nohighlight">\(|0\rangle \)</span>.
Following Eq. (<a class="reference internal" href="#eq:2-2"><span class="xref myst">3</span></a>) we have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-47a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
 |\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\rangle = a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots
					a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger |0\rangle  \label{eq:2-47a} \tag{60} 
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-47b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	|\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\alpha_{n+1}\rangle =
		a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger
		a_{\alpha_{n+1}}^\dagger |0\rangle  \label{eq:2-47b} \tag{61} 
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-47c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	|\alpha_1\alpha_2\dots\alpha_{n-1}\rangle = a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots
		a_{\alpha_{n-1}}^\dagger |0\rangle  \label{eq:2-47c} \tag{62}
\end{equation}
\]</div>
<p>If we use Eq. (<a class="reference internal" href="#eq:2-47a"><span class="xref myst">60</span></a>) as our new reference state, we can simplify considerably the representation of
this state</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-48a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|c\rangle  \equiv |\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\rangle =
		a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger |0\rangle  \label{eq:2-48a} \tag{63}
\end{equation}
\]</div>
<p>The new reference states for the <span class="math notranslate nohighlight">\(n+1\)</span> and <span class="math notranslate nohighlight">\(n-1\)</span> states can then be written as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-48b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\alpha_{n+1}\rangle = (-1)^n a_{\alpha_{n+1}}^\dagger |c\rangle 
		\equiv (-1)^n |\alpha_{n+1}\rangle_c \label{eq:2-48b} \tag{64} 
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-48c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	|\alpha_1\alpha_2\dots\alpha_{n-1}\rangle = (-1)^{n-1} a_{\alpha_n} |c\rangle  
		\equiv (-1)^{n-1} |\alpha_{n-1}\rangle_c \label{eq:2-48c} \tag{65} 
\end{equation}
\]</div>
<p>The first state has one additional particle with respect to the new vacuum state
<span class="math notranslate nohighlight">\(|c\rangle \)</span>  and is normally referred to as a one-particle state or one particle added to the
many-body reference state.
The second state has one particle less than the reference vacuum state  <span class="math notranslate nohighlight">\(|c\rangle \)</span> and is referred to as
a one-hole state.
When dealing with a new reference state it is often convenient to introduce
new creation and annihilation operators since we have
from Eq. (<a class="reference internal" href="#eq:2-48c"><span class="xref myst">65</span></a>)</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-49"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha |c\rangle  \neq 0 \label{eq:2-49} \tag{66}
\end{equation}
\]</div>
<p>since  <span class="math notranslate nohighlight">\(\alpha\)</span> is contained  in <span class="math notranslate nohighlight">\(|c\rangle \)</span>, while for the true vacuum we have
<span class="math notranslate nohighlight">\(a_\alpha |0\rangle  = 0\)</span> for all <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>The new reference state leads to the definition of new creation and annihilation operators
which satisfy the following relations</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-50a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	b_\alpha |c\rangle  = 0 \label{eq:2-50a} \tag{67} 
\end{equation}
\]</div>
<div class="math notranslate nohighlight">
\[
\{b_\alpha^\dagger , b_\beta^\dagger \} = \{b_\alpha , b_\beta \} = 0 \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-50c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	\{b_\alpha^\dagger , b_\beta \} = \delta_{\alpha \beta} \label{eq:2-50c} \tag{68}
\end{equation}
\]</div>
<p>We assume also that the new reference state is properly normalized</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-51"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle c | c \rangle = 1 \label{eq:2-51} \tag{69}
\end{equation}
\]</div>
<p>The physical interpretation of these new operators is that of so-called quasiparticle states.
This means that a state defined by the addition of one extra particle to a reference state <span class="math notranslate nohighlight">\(|c\rangle \)</span> may not necesseraly be interpreted as one particle coupled to a core.
We define now new creation operators that act on a state <span class="math notranslate nohighlight">\(\alpha\)</span> creating a new quasiparticle state</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-52"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
	b_\alpha^\dagger|c\rangle  = \Bigg\{ \begin{array}{ll}
		a_\alpha^\dagger |c\rangle  = |\alpha\rangle, &amp; \alpha &gt; F \\
		\\
		a_\alpha |c\rangle  = |\alpha^{-1}\rangle, &amp; \alpha \leq F
	\end{array} \label{eq:2-52} \tag{70}
\end{equation}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the Fermi level representing the last  occupied single-particle orbit
of the new reference state <span class="math notranslate nohighlight">\(|c\rangle \)</span>.</p>
<p>The annihilation is the hermitian conjugate of the creation operator</p>
<div class="math notranslate nohighlight">
\[
b_\alpha = (b_\alpha^\dagger)^\dagger,
\]</div>
<p>resulting in</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-54"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
	b_\alpha^\dagger = \Bigg\{ \begin{array}{ll}
		a_\alpha^\dagger &amp; \alpha &gt; F \\
		\\
		a_\alpha &amp; \alpha \leq F
	\end{array} \qquad 
	b_\alpha = \Bigg\{ \begin{array}{ll}
		a_\alpha &amp; \alpha &gt; F \\
		\\
		 a_\alpha^\dagger &amp; \alpha \leq F
	\end{array} \label{eq:2-54} \tag{71}
\end{equation}
\end{split}\]</div>
<p>With the new creation and annihilation operator  we can now construct
many-body quasiparticle states, with one-particle-one-hole states, two-particle-two-hole
states etc in the same fashion as we previously constructed many-particle states.
We can write a general particle-hole state as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-56"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \equiv
		\underbrace{b_{\beta_1}^\dagger b_{\beta_2}^\dagger \dots b_{\beta_{n_p}}^\dagger}_{&gt;F}
		\underbrace{b_{\gamma_1}^\dagger b_{\gamma_2}^\dagger \dots b_{\gamma_{n_h}}^\dagger}_{\leq F} |c\rangle \label{eq:2-56} \tag{72}
\end{equation}
\]</div>
<p>We can now rewrite our one-body and two-body operators in terms of the new creation and annihilation operators.
The number operator becomes</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-57b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{N} = \sum_\alpha a_\alpha^\dagger a_\alpha= 
\sum_{\alpha &gt; F} b_\alpha^\dagger b_\alpha + n_c - \sum_{\alpha \leq F} b_\alpha^\dagger b_\alpha \label{eq:2-57b} \tag{73}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(n_c\)</span> is the number of particle in the new vacuum state <span class="math notranslate nohighlight">\(|c\rangle \)</span>.<br />
The action of <span class="math notranslate nohighlight">\(\hat{N}\)</span> on a many-body state results in</p>
<!-- Equation labels as ordinary links -->
<div id="2-59"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	N |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle = (n_p + n_c - n_h) |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \label{2-59} \tag{74}
\end{equation}
\]</div>
<p>Here  <span class="math notranslate nohighlight">\(n=n_p +n_c - n_h\)</span> is the total number of particles in the quasi-particle state of
Eq. (<a class="reference internal" href="#eq:2-56"><span class="xref myst">72</span></a>). Note that  <span class="math notranslate nohighlight">\(\hat{N}\)</span> counts the total number of particles  present</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-60"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	N_{qp} = \sum_\alpha b_\alpha^\dagger b_\alpha, \label{eq:2-60} \tag{75}
\end{equation}
\]</div>
<p>gives us the number of quasi-particles as can be seen by computing</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-61"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	N_{qp}= |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle
		= (n_p + n_h)|\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \label{eq:2-61} \tag{76}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(n_{qp} = n_p + n_h\)</span> is the total number of quasi-particles.</p>
<p>We express the one-body operator <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> in terms of the quasi-particle creation and annihilation operators, resulting in</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0 = \sum_{\alpha\beta &gt; F} \langle \alpha|\hat{h}_0|\beta\rangle  b_\alpha^\dagger b_\beta +
		\sum_{\alpha &gt; F, \beta \leq F } \left[\langle \alpha|\hat{h}_0|\beta\rangle b_\alpha^\dagger b_\beta^\dagger + \langle \beta|\hat{h}_0|\alpha\rangle b_\beta  b_\alpha \right] \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-63b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+ \sum_{\alpha \leq F} \langle \alpha|\hat{h}_0|\alpha\rangle - \sum_{\alpha\beta \leq F} \langle \beta|\hat{h}_0|\alpha\rangle b_\alpha^\dagger b_\beta \label{eq:2-63b} \tag{77}
\end{equation}
\]</div>
<p>The first term  gives contribution only for particle states, while the last one
contributes only for holestates. The second term can create or destroy a set of
quasi-particles and
the third term is the contribution  from the vacuum state <span class="math notranslate nohighlight">\(|c\rangle\)</span>.</p>
<p>Before we continue with the expressions for the two-body operator, we introduce a nomenclature we will use for the rest of this
text. It is inspired by the notation used in quantum chemistry.
We reserve the labels <span class="math notranslate nohighlight">\(i,j,k,\dots\)</span> for hole states and <span class="math notranslate nohighlight">\(a,b,c,\dots\)</span> for states above <span class="math notranslate nohighlight">\(F\)</span>, viz. particle states.
This means also that we will skip the constraint <span class="math notranslate nohighlight">\(\leq F\)</span> or <span class="math notranslate nohighlight">\(&gt; F\)</span> in the summation symbols.
Our operator <span class="math notranslate nohighlight">\(\hat{H}_0\)</span>  reads now</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0 = \sum_{ab} \langle a|\hat{h}|b\rangle b_a^\dagger b_b +
		\sum_{ai} \left[
		\langle a|\hat{h}|i\rangle b_a^\dagger b_i^\dagger + 
		\langle i|\hat{h}|a\rangle b_i  b_a \right] \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-63c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+ \sum_{i} \langle i|\hat{h}|i\rangle - 
		\sum_{ij} \langle j|\hat{h}|i\rangle
		b_i^\dagger b_j \label{eq:2-63c} \tag{78}
\end{equation}
\]</div>
<p>The two-particle operator in the particle-hole formalism  is more complicated since we have
to translate four indices <span class="math notranslate nohighlight">\(\alpha\beta\gamma\delta\)</span> to the possible combinations of particle and hole
states.  When performing the commutator algebra we can regroup the operator in five different terms</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-65"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I = \hat{H}_I^{(a)} + \hat{H}_I^{(b)} + \hat{H}_I^{(c)} + \hat{H}_I^{(d)} + \hat{H}_I^{(e)} \label{eq:2-65} \tag{79}
\end{equation}
\]</div>
<p>Using anti-symmetrized  matrix elements,
bthe term  <span class="math notranslate nohighlight">\(\hat{H}_I^{(a)}\)</span> is</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-66"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I^{(a)} = \frac{1}{4}
	\sum_{abcd} \langle ab|\hat{V}|cd\rangle 
		b_a^\dagger b_b^\dagger b_d b_c \label{eq:2-66} \tag{80}
\end{equation}
\]</div>
<p>The next term <span class="math notranslate nohighlight">\(\hat{H}_I^{(b)}\)</span>  reads</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-67b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	 \hat{H}_I^{(b)} = \frac{1}{4} \sum_{abci}\left(\langle ab|\hat{V}|ci\rangle b_a^\dagger b_b^\dagger b_i^\dagger b_c +\langle ai|\hat{V}|cb\rangle b_a^\dagger b_i b_b b_c\right) \label{eq:2-67b} \tag{81}
\end{equation}
\]</div>
<p>This term conserves the number of quasiparticles but creates or removes a
three-particle-one-hole  state.
For <span class="math notranslate nohighlight">\(\hat{H}_I^{(c)}\)</span>  we have</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I^{(c)} = \frac{1}{4}
		\sum_{abij}\left(\langle ab|\hat{V}|ij\rangle b_a^\dagger b_b^\dagger b_j^\dagger b_i^\dagger +
		\langle ij|\hat{V}|ab\rangle b_a  b_b b_j b_i \right)+  \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-68c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
		\frac{1}{2}\sum_{abij}\langle ai|\hat{V}|bj\rangle b_a^\dagger b_j^\dagger b_b b_i + 
		\frac{1}{2}\sum_{abi}\langle ai|\hat{V}|bi\rangle b_a^\dagger b_b. \label{eq:2-68c} \tag{82}
\end{equation}
\]</div>
<p>The first line stands for the creation of a two-particle-two-hole state, while the second line represents
the creation to two one-particle-one-hole pairs
while the last term represents a contribution to the particle single-particle energy
from the hole states, that is an interaction between the particle states and the hole states
within the new vacuum  state.
The fourth term reads</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I^{(d)} = \frac{1}{4} 
	 	\sum_{aijk}\left(\langle ai|\hat{V}|jk\rangle b_a^\dagger b_k^\dagger b_j^\dagger b_i+
\langle ji|\hat{V}|ak\rangle b_k^\dagger b_j b_i b_a\right)+\nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-69d"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
\frac{1}{4}\sum_{aij}\left(\langle ai|\hat{V}|ji\rangle b_a^\dagger b_j^\dagger+
\langle ji|\hat{V}|ai\rangle - \langle ji|\hat{V}|ia\rangle b_j b_a \right). \label{eq:2-69d} \tag{83} 
\end{equation}
\]</div>
<p>The terms in the first line  stand for the creation of a particle-hole state
interacting with hole states, we will label this as a two-hole-one-particle contribution.
The remaining terms are a particle-hole state interacting with the holes in the vacuum state.
Finally we have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-70d"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I^{(e)} = \frac{1}{4}
		 \sum_{ijkl}
		 \langle kl|\hat{V}|ij\rangle b_i^\dagger b_j^\dagger b_l b_k+
	        \frac{1}{2}\sum_{ijk}\langle ij|\hat{V}|kj\rangle b_k^\dagger b_i
	        +\frac{1}{2}\sum_{ij}\langle ij|\hat{V}|ij\rangle \label{eq:2-70d} \tag{84}
\end{equation}
\]</div>
<p>The first terms represents the
interaction between two holes while the second stands for the interaction between a hole and the remaining holes in the vacuum state.
It represents a contribution to single-hole energy  to first order.
The last term collects all contributions to the energy of the ground state of a closed-shell system arising
from hole-hole correlations.</p>
</section>
<section id="summarizing-and-defining-a-normal-ordered-hamiltonian">
<h2><span class="section-number">2.8. </span>Summarizing and defining a normal-ordered Hamiltonian<a class="headerlink" href="#summarizing-and-defining-a-normal-ordered-hamiltonian" title="Link to this heading">#</a></h2>
<div class="math notranslate nohighlight">
\[
\Phi_{AS}(\alpha_1, \dots, \alpha_A; x_1, \dots x_A)=
            \frac{1}{\sqrt{A}} \sum_{\hat{P}} (-1)^P \hat{P} \prod_{i=1}^A \psi_{\alpha_i}(x_i),
\]</div>
<p>which is equivalent with <span class="math notranslate nohighlight">\(|\alpha_1 \dots \alpha_A\rangle= a_{\alpha_1}^{\dagger} \dots a_{\alpha_A}^{\dagger} |0\rangle\)</span>. We have also</p>
<div class="math notranslate nohighlight">
\[
a_p^\dagger|0\rangle = |p\rangle, \quad a_p |q\rangle = \delta_{pq}|0\rangle
\]</div>
<div class="math notranslate nohighlight">
\[
\delta_{pq} = \left\{a_p, a_q^\dagger \right\},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
0 = \left\{a_p^\dagger, a_q \right\} = \left\{a_p, a_q \right\} = \left\{a_p^\dagger, a_q^\dagger \right\}
\]</div>
<div class="math notranslate nohighlight">
\[
|\Phi_0\rangle = |\alpha_1 \dots \alpha_A\rangle, \quad \alpha_1, \dots, \alpha_A \leq \alpha_F
\]</div>
<div class="math notranslate nohighlight">
\[
\left\{a_p^\dagger, a_q \right\}= \delta_{pq}, p, q \leq \alpha_F
\]</div>
<div class="math notranslate nohighlight">
\[
\left\{a_p, a_q^\dagger \right\} = \delta_{pq}, p, q &gt; \alpha_F
\]</div>
<p>with         <span class="math notranslate nohighlight">\(i,j,\ldots \leq \alpha_F, \quad a,b,\ldots &gt; \alpha_F, \quad p,q, \ldots - \textrm{any}\)</span></p>
<div class="math notranslate nohighlight">
\[
a_i|\Phi_0\rangle = |\Phi_i\rangle, \hspace{0.5cm} a_a^\dagger|\Phi_0\rangle = |\Phi^a\rangle
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
a_i^\dagger|\Phi_0\rangle = 0 \hspace{0.5cm}  a_a|\Phi_0\rangle = 0
\]</div>
<p>The one-body operator is defined as</p>
<div class="math notranslate nohighlight">
\[
\hat{F} = \sum_{pq} \langle p|\hat{f}|q\rangle a_p^\dagger a_q
\]</div>
<p>while the two-body opreator is defined as</p>
<div class="math notranslate nohighlight">
\[
\hat{V} = \frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle_{AS} a_p^\dagger a_q^\dagger a_s a_r
\]</div>
<p>where we have defined the antisymmetric matrix elements</p>
<div class="math notranslate nohighlight">
\[
\langle pq|\hat{v}|rs\rangle_{AS} = \langle pq|\hat{v}|rs\rangle - \langle pq|\hat{v}|sr\rangle.
\]</div>
<p>We can also define a three-body operator</p>
<div class="math notranslate nohighlight">
\[
\hat{V}_3 = \frac{1}{36} \sum_{pqrstu} \langle pqr|\hat{v}_3|stu\rangle_{AS} 
                a_p^\dagger a_q^\dagger a_r^\dagger a_u a_t a_s
\]</div>
<p>with the antisymmetrized matrix element</p>
<!-- Equation labels as ordinary links -->
<div id="_auto2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
            \langle pqr|\hat{v}_3|stu\rangle_{AS} = \langle pqr|\hat{v}_3|stu\rangle + \langle pqr|\hat{v}_3|tus\rangle + \langle pqr|\hat{v}_3|ust\rangle- \langle pqr|\hat{v}_3|sut\rangle - \langle pqr|\hat{v}_3|tsu\rangle - \langle pqr|\hat{v}_3|uts\rangle.
\label{_auto2} \tag{85}
\end{equation}
\]</div>
</section>
<section id="operators-in-second-quantization">
<h2><span class="section-number">2.9. </span>Operators in second quantization<a class="headerlink" href="#operators-in-second-quantization" title="Link to this heading">#</a></h2>
<p>In the build-up of an FCI code that is meant to tackle large dimensionalities
is the action of the Hamiltonian <span class="math notranslate nohighlight">\(\hat{H}\)</span> on a
Slater determinant represented in second quantization as</p>
<div class="math notranslate nohighlight">
\[
|\alpha_1\dots \alpha_n\rangle = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
\]</div>
<p>The time consuming part stems from the action of the Hamiltonian
on the above determinant,</p>
<div class="math notranslate nohighlight">
\[
\left(\sum_{\alpha\beta} \langle \alpha|t+u|\beta\rangle a_\alpha^{\dagger} a_\beta + \frac{1}{4} \sum_{\alpha\beta\gamma\delta}
                \langle \alpha \beta|\hat{v}|\gamma \delta\rangle a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma\right)a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
\]</div>
<p>A practically useful way to implement this action is to encode a Slater determinant as a bit pattern.</p>
<p>Assume that we have at our disposal <span class="math notranslate nohighlight">\(n\)</span> different single-particle orbits
<span class="math notranslate nohighlight">\(\alpha_0,\alpha_2,\dots,\alpha_{n-1}\)</span> and that we can distribute  among these orbits <span class="math notranslate nohighlight">\(N\le n\)</span> particles.</p>
<p>A Slater  determinant can then be coded as an integer of <span class="math notranslate nohighlight">\(n\)</span> bits. As an example, if we have <span class="math notranslate nohighlight">\(n=16\)</span> single-particle states
<span class="math notranslate nohighlight">\(\alpha_0,\alpha_1,\dots,\alpha_{15}\)</span> and <span class="math notranslate nohighlight">\(N=4\)</span> fermions occupying the states <span class="math notranslate nohighlight">\(\alpha_3\)</span>, <span class="math notranslate nohighlight">\(\alpha_6\)</span>, <span class="math notranslate nohighlight">\(\alpha_{10}\)</span> and <span class="math notranslate nohighlight">\(\alpha_{13}\)</span>
we could write this Slater determinant as</p>
<div class="math notranslate nohighlight">
\[
\Phi_{\Lambda} = a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle.
\]</div>
<p>The unoccupied single-particle states have bit value <span class="math notranslate nohighlight">\(0\)</span> while the occupied ones are represented by bit state <span class="math notranslate nohighlight">\(1\)</span>.
In the binary notation we would write this   16 bits long integer as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{cccccccccccccccc}
{\alpha_0}&amp;{\alpha_1}&amp;{\alpha_2}&amp;{\alpha_3}&amp;{\alpha_4}&amp;{\alpha_5}&amp;{\alpha_6}&amp;{\alpha_7} &amp; {\alpha_8} &amp;{\alpha_9} &amp; {\alpha_{10}} &amp;{\alpha_{11}} &amp;{\alpha_{12}} &amp;{\alpha_{13}} &amp;{\alpha_{14}} &amp; {\alpha_{15}} \\
{0} &amp; {0} &amp;{0} &amp;{1} &amp;{0} &amp;{0} &amp;{1} &amp;{0} &amp;{0} &amp;{0} &amp;{1} &amp;{0} &amp;{0} &amp;{1} &amp;{0} &amp; {0} \\
\end{array}
\end{split}\]</div>
<p>which translates into the decimal number</p>
<div class="math notranslate nohighlight">
\[
2^3+2^6+2^{10}+2^{13}=9288.
\]</div>
<p>We can thus encode a Slater determinant as a bit pattern.</p>
<p>With <span class="math notranslate nohighlight">\(N\)</span> particles that can be distributed over <span class="math notranslate nohighlight">\(n\)</span> single-particle states, the total number of Slater determinats (and defining thereby the dimensionality of the system) is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathrm{dim}(\mathcal{H}) = \left(\begin{array}{c} n \\N\end{array}\right).
\end{split}\]</div>
<p>The total number of bit patterns is <span class="math notranslate nohighlight">\(2^n\)</span>.</p>
<p>We assume again that we have at our disposal <span class="math notranslate nohighlight">\(n\)</span> different single-particle orbits
<span class="math notranslate nohighlight">\(\alpha_0,\alpha_2,\dots,\alpha_{n-1}\)</span> and that we can distribute  among these orbits <span class="math notranslate nohighlight">\(N\le n\)</span> particles.
The ordering among these states is important as it defines the order of the creation operators.
We will write the determinant</p>
<div class="math notranslate nohighlight">
\[
\Phi_{\Lambda} = a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>in a more compact way as</p>
<div class="math notranslate nohighlight">
\[
\Phi_{3,6,10,13} = |0001001000100100\rangle.
\]</div>
<p>The action of a creation operator is thus</p>
<div class="math notranslate nohighlight">
\[
a^{\dagger}_{\alpha_4}\Phi_{3,6,10,13} = a^{\dagger}_{\alpha_4}|0001001000100100\rangle=a^{\dagger}_{\alpha_4}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>which becomes</p>
<div class="math notranslate nohighlight">
\[
-a_{\alpha_3}^{\dagger} a^{\dagger}_{\alpha_4} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=-|0001101000100100\rangle.
\]</div>
<p>Similarly</p>
<div class="math notranslate nohighlight">
\[
a^{\dagger}_{\alpha_6}\Phi_{3,6,10,13} = a^{\dagger}_{\alpha_6}|0001001000100100\rangle=a^{\dagger}_{\alpha_6}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>which becomes</p>
<div class="math notranslate nohighlight">
\[
-a^{\dagger}_{\alpha_4} (a_{\alpha_6}^{\dagger})^ 2 a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=0!
\]</div>
<p>This gives a simple recipe:</p>
<ul class="simple">
<li><p>If one of the bits <span class="math notranslate nohighlight">\(b_j\)</span> is <span class="math notranslate nohighlight">\(1\)</span> and we act with a creation operator on this bit, we return a null vector</p></li>
<li><p>If <span class="math notranslate nohighlight">\(b_j=0\)</span>, we set it to <span class="math notranslate nohighlight">\(1\)</span> and return a sign factor <span class="math notranslate nohighlight">\((-1)^l\)</span>, where <span class="math notranslate nohighlight">\(l\)</span> is the number of bits set before bit <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
</ul>
<p>Consider the action of <span class="math notranslate nohighlight">\(a^{\dagger}_{\alpha_2}\)</span> on various slater determinants:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ccc}
a^{\dagger}_{\alpha_2}\Phi_{00111}&amp; = a^{\dagger}_{\alpha_2}|00111\rangle&amp;=0\times |00111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01011}&amp; = a^{\dagger}_{\alpha_2}|01011\rangle&amp;=(-1)\times |01111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01101}&amp; = a^{\dagger}_{\alpha_2}|01101\rangle&amp;=0\times |01101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01110}&amp; = a^{\dagger}_{\alpha_2}|01110\rangle&amp;=0\times |01110\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10011}&amp; = a^{\dagger}_{\alpha_2}|10011\rangle&amp;=(-1)\times |10111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10101}&amp; = a^{\dagger}_{\alpha_2}|10101\rangle&amp;=0\times |10101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10110}&amp; = a^{\dagger}_{\alpha_2}|10110\rangle&amp;=0\times |10110\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{11001}&amp; = a^{\dagger}_{\alpha_2}|11001\rangle&amp;=(+1)\times |11101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{11010}&amp; = a^{\dagger}_{\alpha_2}|11010\rangle&amp;=(+1)\times |11110\rangle\\
\end{array}
\end{split}\]</div>
<p>What is the simplest way to obtain the phase when we act with one annihilation(creation) operator
on the given Slater determinant representation?</p>
<p>We have an SD representation</p>
<div class="math notranslate nohighlight">
\[
\Phi_{\Lambda} = a_{\alpha_0}^{\dagger} a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>in a more compact way as</p>
<div class="math notranslate nohighlight">
\[
\Phi_{0,3,6,10,13} = |1001001000100100\rangle.
\]</div>
<p>The action of</p>
<div class="math notranslate nohighlight">
\[
a^{\dagger}_{\alpha_4}a_{\alpha_0}\Phi_{0,3,6,10,13} = a^{\dagger}_{\alpha_4}|0001001000100100\rangle=a^{\dagger}_{\alpha_4}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>which becomes</p>
<div class="math notranslate nohighlight">
\[
-a_{\alpha_3}^{\dagger} a^{\dagger}_{\alpha_4} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=-|0001101000100100\rangle.
\]</div>
<p>The action</p>
<div class="math notranslate nohighlight">
\[
a_{\alpha_0}\Phi_{0,3,6,10,13} = |0001001000100100\rangle,
\]</div>
<p>can be obtained by subtracting the logical sum (AND operation) of <span class="math notranslate nohighlight">\(\Phi_{0,3,6,10,13}\)</span> and
a word which represents only <span class="math notranslate nohighlight">\(\alpha_0\)</span>, that is</p>
<div class="math notranslate nohighlight">
\[
|1000000000000000\rangle,
\]</div>
<p>from <span class="math notranslate nohighlight">\(\Phi_{0,3,6,10,13}= |1001001000100100\rangle\)</span>.</p>
<p>This operation gives <span class="math notranslate nohighlight">\(|0001001000100100\rangle\)</span>.</p>
<p>Similarly, we can form <span class="math notranslate nohighlight">\(a^{\dagger}_{\alpha_4}a_{\alpha_0}\Phi_{0,3,6,10,13}\)</span>, say, by adding
<span class="math notranslate nohighlight">\(|0000100000000000\rangle\)</span> to <span class="math notranslate nohighlight">\(a_{\alpha_0}\Phi_{0,3,6,10,13}\)</span>, first checking that their logical sum
is zero in order to make sure that orbital <span class="math notranslate nohighlight">\(\alpha_4\)</span> is not already occupied.</p>
<p>It is trickier however to get the phase <span class="math notranslate nohighlight">\((-1)^l\)</span>.
One possibility is as follows</p>
<ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(S_1\)</span> be a word that represents the <span class="math notranslate nohighlight">\(1-\)</span>bit to be removed and all others set to zero.</p></li>
</ul>
<p>In the previous example <span class="math notranslate nohighlight">\(S_1=|1000000000000000\rangle\)</span></p>
<ul class="simple">
<li><p>Define <span class="math notranslate nohighlight">\(S_2\)</span> as the similar word that represents the bit to be added, that is in our case</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(S_2=|0000100000000000\rangle\)</span>.</p>
<ul class="simple">
<li><p>Compute then <span class="math notranslate nohighlight">\(S=S_1-S_2\)</span>, which here becomes</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
S=|0111000000000000\rangle
\]</div>
<ul class="simple">
<li><p>Perform then the logical AND operation of <span class="math notranslate nohighlight">\(S\)</span> with the word containing</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Phi_{0,3,6,10,13} = |1001001000100100\rangle,
\]</div>
<p>which results in <span class="math notranslate nohighlight">\(|0001000000000000\rangle\)</span>. Counting the number of <span class="math notranslate nohighlight">\(1-\)</span>bits gives the phase.  Here you need however an algorithm for bitcounting. Several efficient ones available.</p>
</section>
<section id="schr-odinger-picture">
<h2><span class="section-number">2.10. </span>Schr”odinger picture<a class="headerlink" href="#schr-odinger-picture" title="Link to this heading">#</a></h2>
<p>The time-dependent Schr”odinger equation (or equation of motion) reads</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}|\Psi_S(t)\rangle = \hat{H}\Psi_S(t)\rangle,
\]</div>
<p>where the subscript <span class="math notranslate nohighlight">\(S\)</span> stands for Schr”odinger here.
A formal solution is given by</p>
<div class="math notranslate nohighlight">
\[
|\Psi_S(t)\rangle = \exp{(-\imath\hat{H}(t-t_0)/\hbar)}|\Psi_S(t_0)\rangle.
\]</div>
<p>The Hamiltonian <span class="math notranslate nohighlight">\(\hat{H}\)</span> is hermitian and the exponent represents a unitary
operator with an operation carried ut on the wave function at a time <span class="math notranslate nohighlight">\(t_0\)</span>.</p>
</section>
<section id="interaction-picture">
<h2><span class="section-number">2.11. </span>Interaction picture<a class="headerlink" href="#interaction-picture" title="Link to this heading">#</a></h2>
<p>Our Hamiltonian is normally written out as the sum of an unperturbed part <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> and an interaction part <span class="math notranslate nohighlight">\(\hat{H}_I\)</span>, that is</p>
<div class="math notranslate nohighlight">
\[
\hat{H}=\hat{H}_0+\hat{H}_I.
\]</div>
<p>In general we have <span class="math notranslate nohighlight">\([\hat{H}_0,\hat{H}_I]\ne 0\)</span> since <span class="math notranslate nohighlight">\([\hat{T},\hat{V}]\ne 0\)</span>.
We wish now to define a unitary transformation in terms of <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> by defining</p>
<div class="math notranslate nohighlight">
\[
|\Psi_I(t)\rangle = \exp{(\imath\hat{H}_0t/\hbar)}|\Psi_S(t)\rangle,
\]</div>
<p>which is again a unitary transformation carried out now at the time <span class="math notranslate nohighlight">\(t\)</span> on the
wave function in the Schr”odinger picture.</p>
<p>We can easily find the equation of motion by taking the time derivative</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}|\Psi_I(t)\rangle = -\hat{H}_0\exp{(\imath\hat{H}_0t/\hbar)}\Psi_S(t)\rangle+\exp{(\imath\hat{H}_0t/\hbar)}
\imath \hbar\frac{\partial }{\partial t}\Psi_S(t)\rangle.
\]</div>
<p>Using the definition of the Schr”odinger equation, we can rewrite the last equation as</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}|\Psi_I(t)\rangle = \exp{(\imath\hat{H}_0t/\hbar)}\left[-\hat{H}_0+\hat{H}_0+\hat{H}_I\right]\exp{(-\imath\hat{H}_0t/\hbar)}\Psi_I(t)\rangle,
\]</div>
<p>which gives us</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}|\Psi_I(t)\rangle = \hat{H}_I(t)\Psi_I(t)\rangle,
\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I(t)=
\exp{(\imath\hat{H}_0t/\hbar)}\hat{H}_I\exp{(-\imath\hat{H}_0t/\hbar)}.
\]</div>
<p>The order of the operators is important since <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> and <span class="math notranslate nohighlight">\(\hat{H}_I\)</span> do generally not commute.
The expectation value of
an arbitrary operator in the interaction picture can now be written as</p>
<div class="math notranslate nohighlight">
\[
\langle \Psi'_S(t)|\hat{O}_S|\Psi_S(t)\rangle = 
\langle \Psi'_I(t) |\exp{(\imath\hat{H}_0t/\hbar)}\hat{O}_I
\exp{(-\imath\hat{H}_0t/\hbar)}|\Psi_I(t)\rangle,
\]</div>
<p>and using the definition</p>
<div class="math notranslate nohighlight">
\[
\hat{O}_I(t)=
\exp{(\imath\hat{H}_0t/\hbar)}\hat{O}_I\exp{(-\imath\hat{H}_0t/\hbar)},
\]</div>
<p>we obtain</p>
<div class="math notranslate nohighlight">
\[
\langle \Psi'_S(t)|\hat{O}_S|\Psi_S(t)\rangle = 
\langle \Psi'_I(t) |\hat{O}_I(t)|\Psi_I(t)\rangle,
\]</div>
<p>stating that a unitary transformation does not change expectation values!</p>
<p>If we take the time derivative of the operator in the interaction picture we arrive at the following equation of motion</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}\hat{O}_I(t) = \exp{(\imath\hat{H}_0t/\hbar)}\left[\hat{O}_S\hat{H}_0-\hat{H}_0\hat{O}_S\right]\exp{(-\imath\hat{H}_0t/\hbar)}=\left[\hat{O}_I(t),\hat{H}_0\right].
\]</div>
<p>Here we have used the time-independence of the Schr”odinger equation
together with the observation that any function of an operator commutes with the operator itself.</p>
<p>In order to solve the equation of motion equation in the interaction picture, we define a unitary operator
time-development operator <span class="math notranslate nohighlight">\(\hat{U}(t,t')\)</span>. Later we will derive its
connection with the linked-diagram theorem, which yields a
linked expression for the actual operator.
The action of the operator on the wave function is</p>
<div class="math notranslate nohighlight">
\[
|\Psi_I(t) \rangle = \hat{U}(t,t_0)|\Psi_I(t_0)\rangle,
\]</div>
<p>with the obvious value <span class="math notranslate nohighlight">\(\hat{U}(t_0,t_0)=1\)</span>.</p>
<p>The time-development operator <span class="math notranslate nohighlight">\(U\)</span> has the
properties that</p>
<div class="math notranslate nohighlight">
\[
\hat{U}^{\dagger}(t,t')\hat{U}(t,t')=\hat{U}(t,t')\hat{U}^{\dagger}(t,t')=1,
\]</div>
<p>which implies that <span class="math notranslate nohighlight">\(U\)</span> is unitary</p>
<div class="math notranslate nohighlight">
\[
\hat{U}^{\dagger}(t,t')=\hat{U}^{-1}(t,t').
\]</div>
<p>Further,</p>
<div class="math notranslate nohighlight">
\[
\hat{U}(t,t')\hat{U}(t't'')=\hat{U}(t,t'')
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\hat{U}(t,t')\hat{U}(t',t)=1,
\]</div>
<p>which leads to</p>
<div class="math notranslate nohighlight">
\[
\hat{U}(t,t')=\hat{U}^{\dagger}(t',t).
\]</div>
<p>Using our definition of Schr”odinger’s equation in the interaction picture, we can then construct the operator <span class="math notranslate nohighlight">\(\hat{U}\)</span>. We have defined</p>
<div class="math notranslate nohighlight">
\[
|\Psi_I(t)\rangle = \exp{(\imath\hat{H}_0t/\hbar)}|\Psi_S(t)\rangle,
\]</div>
<p>which can be rewritten as</p>
<div class="math notranslate nohighlight">
\[
|\Psi_I(t)\rangle = \exp{(\imath\hat{H}_0t/\hbar)}\exp{(-\imath\hat{H}(t-t_0)/\hbar)}|\Psi_S(t_0)\rangle,
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
|\Psi_I(t)\rangle = \exp{(\imath\hat{H}_0t/\hbar)}\exp{(-\imath\hat{H}(t-t_0)/\hbar)}\exp{(-\imath\hat{H}_0t_0/\hbar)}|\Psi_I(t_0)\rangle.
\]</div>
<p>From the last expression we can define</p>
<div class="math notranslate nohighlight">
\[
\hat{U}(t,t_0)=\exp{(\imath\hat{H}_0t/\hbar)}\exp{(-\imath\hat{H}(t-t_0)/\hbar)}\exp{(-\imath\hat{H}_0t_0/\hbar)}.
\]</div>
<p>It is then easy to convince oneself that the properties defined above are satisfied by the definition of <span class="math notranslate nohighlight">\(\hat{U}\)</span>.</p>
<p>We derive the equation of motion for <span class="math notranslate nohighlight">\(\hat{U}\)</span> using the above definition.
This results in</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}\hat{U}(t,t_0) = \hat{H}_I(t)\hat{U}(t,t_0),
\]</div>
<p>which we integrate from <span class="math notranslate nohighlight">\(t_0\)</span> to a time <span class="math notranslate nohighlight">\(t\)</span> resulting in</p>
<div class="math notranslate nohighlight">
\[
\hat{U}(t,t_0)-\hat{U}(t_0,t_0)=\hat{U}(t,t_0)-1=-\frac{\imath}{\hbar}\int_{t_0}^t dt' \hat{H}_I(t')\hat{U}(t',t_0),
\]</div>
<p>which can be rewritten as</p>
<div class="math notranslate nohighlight">
\[
\hat{U}(t,t_0)=1-\frac{\imath}{\hbar}\int_{t_0}^t dt' \hat{H}_I(t')\hat{U}(t',t_0).
\]</div>
<p>We can solve this equation iteratively keeping in mind the time-ordering of the of the operators</p>
<div class="math notranslate nohighlight">
\[
\hat{U}(t,t_0)=1-\frac{\imath}{\hbar}\int_{t_0}^t dt' \hat{H}_I(t')+\left(\frac{-\imath}{\hbar}\right)^2\int_{t_0}^t dt'\int_{t_0}^{t'} dt'' \hat{H}_I(t')\hat{H}_I(t'')+\dots
\]</div>
<p>The third term can be written as</p>
<div class="math notranslate nohighlight">
\[
\int_{t_0}^t dt'\int_{t_0}^{t'} dt'' \hat{H}_I(t')\hat{H}_I(t'')=
\frac{1}{2}\int_{t_0}^t dt'\int_{t_0}^{t'} dt'' \hat{H}_I(t')\hat{H}_I(t'')
+\frac{1}{2}\int_{t_0}^t dt''\int_{t''}^{t} dt' \hat{H}_I(t')\hat{H}_I(t'').
\]</div>
<p>We obtain this expression by changing the integration order in the second term
via a change of the integration variables <span class="math notranslate nohighlight">\(t'\)</span> and <span class="math notranslate nohighlight">\(t''\)</span>  in</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2}\int_{t_0}^t dt'\int_{t_0}^{t'} dt'' \hat{H}_I(t')\hat{H}_I(t'').
\]</div>
<p>We can rewrite the terms which contain the double integral as</p>
<div class="math notranslate nohighlight">
\[
\int_{t_0}^t dt'\int_{t_0}^{t'} dt'' \hat{H}_I(t')\hat{H}_I(t'')=
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{1}{2}\int_{t_0}^t dt'\int_{t_0}^{t'} dt''\left[\hat{H}_I(t')\hat{H}_I(t'')\Theta(t'-t'')
+\hat{H}_I(t')\hat{H}_I(t'')\Theta(t''-t')\right],
\]</div>
<p>with <span class="math notranslate nohighlight">\(\Theta(t''-t')\)</span> being the standard Heavyside or step function. The step function allows us to give a specific time-ordering to the above expression.</p>
<p>With the <span class="math notranslate nohighlight">\(\Theta\)</span>-function we can rewrite the last expression as</p>
<div class="math notranslate nohighlight">
\[
\int_{t_0}^t dt'\int_{t_0}^{t'} dt'' \hat{H}_I(t')\hat{H}_I(t'')=
\frac{1}{2}\int_{t_0}^t dt'\int_{t_0}^{t'} dt''\hat{T}\left[\hat{H}_I(t')\hat{H}_I(t'')\right],
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Hat{T}\)</span> is the so-called time-ordering operator.</p>
<p>With this definition, we can rewrite the expression for <span class="math notranslate nohighlight">\(\hat{U}\)</span> as</p>
<div class="math notranslate nohighlight">
\[
\hat{U}(t,t_0)=\sum_{n=0}^{\infty}\left(\frac{-\imath}{\hbar}\right)^n\frac{1}{n1}
\int_{t_0}^t dt_1\dots \int_{t_0}^t dt_N \hat{T}\left[\hat{H}_I(t_1)\dots\hat{H}_I(t_n)\right]=\hat{T}\exp{\left[\frac{-\imath}{\hbar}
\int_{t_0}^t dt' \hat{H}_I(t')\right]}.
\]</div>
<p>The above time-evolution operator in the interaction picture will be used
to derive various contributions to many-body perturbation theory.</p>
</section>
<section id="heisenberg-picture">
<h2><span class="section-number">2.12. </span>Heisenberg picture<a class="headerlink" href="#heisenberg-picture" title="Link to this heading">#</a></h2>
<p>We wish now to define a unitary transformation in terms of <span class="math notranslate nohighlight">\(\hat{H}\)</span> by defining</p>
<div class="math notranslate nohighlight">
\[
|\Psi_H(t)\rangle = \exp{(\imath\hat{H}t/\hbar)}|\Psi_S(t)\rangle,
\]</div>
<p>which is again a unitary transformation carried out now at the time <span class="math notranslate nohighlight">\(t\)</span> on the
wave function in the Schr”odinger picture. If we combine this equation with
Schr”odinger’s equation we obtain the following equation of motion</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}|\Psi_H(t)\rangle = 0,
\]</div>
<p>meaning that <span class="math notranslate nohighlight">\(|\Psi_H(t)\rangle\)</span> is time independent. An operator in this picture is defined as</p>
<div class="math notranslate nohighlight">
\[
\hat{O}_H(t)=
\exp{(\imath\hat{H}t/\hbar)}\hat{O}_S\exp{(-\imath\hat{H}t/\hbar)}.
\]</div>
<p>The time dependence is then in the operator itself, and this yields in turn the
following equation of motion</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}\hat{O}_H(t) = \exp{(\imath\hat{H}t/\hbar)}\left[\hat{O}_H\hat{H}-\hat{H}\hat{O}_H\right]\exp{(-\imath\hat{H}t/\hbar)}=\left[\hat{O}_H(t),\hat{H}\right].
\]</div>
<p>We note that an operator in the Heisenberg picture can be related to the corresponding
operator in the interaction picture as</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}
\hat{O}_H(t)=
\exp{(\imath\hat{H}t/\hbar)}\hat{O}_S\exp{(-\imath\hat{H}t/\hbar)}=\\\exp{(\imath\hat{H}_It/\hbar)}\exp{(-\imath\hat{H}_0t/\hbar)}\hat{O}_I\exp{(\imath\hat{H}_0t/\hbar)}\exp{(-\imath\hat{H}_It/\hbar)}.
\end{aligned}\end{align} \]</div>
<p>With our definition of the time evolution operator we see that</p>
<div class="math notranslate nohighlight">
\[
\hat{O}_H(t)=\hat{U}(0,t)\hat{O}_I\hat{U}(t,0),
\]</div>
<p>which in turn implies that <span class="math notranslate nohighlight">\(\hat{O}_S=\hat{O}_I(0)=\hat{O}_H(0)\)</span>, all operators are equal at <span class="math notranslate nohighlight">\(t=0\)</span>. The wave function in the Heisenberg formalism is
related to the other pictures as</p>
<div class="math notranslate nohighlight">
\[
|\Psi_H\rangle=|\Psi_S(0)\rangle=|\Psi_I(0)\rangle,
\]</div>
<p>since the wave function in the Heisenberg picture is time independent.
We can relate this wave function to that a given time <span class="math notranslate nohighlight">\(t\)</span> via the time evolution operator as</p>
<div class="math notranslate nohighlight">
\[
|\Psi_H\rangle=\hat{U}(0,t)|\Psi_I(t)\rangle.
\]</div>
</section>
<section id="adiabatic-hypothesis">
<h2><span class="section-number">2.13. </span>Adiabatic hypothesis<a class="headerlink" href="#adiabatic-hypothesis" title="Link to this heading">#</a></h2>
<p>We assume that the interaction term is switched on gradually. Our wave function at time <span class="math notranslate nohighlight">\(t=-\infty\)</span> and <span class="math notranslate nohighlight">\(t=\infty\)</span> is supposed to represent a non-interacting system
given by the solution to the unperturbed part of our Hamiltonian <span class="math notranslate nohighlight">\(\hat{H}_0\)</span>.
We assume the ground state is given by <span class="math notranslate nohighlight">\(|\Phi_0\rangle\)</span>, which could be a Slater determinant.</p>
<p>We define our Hamiltonian as</p>
<div class="math notranslate nohighlight">
\[
\hat{H}=\hat{H}_0+\exp{(-\varepsilon t/\hbar)}\hat{H}_I,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\varepsilon\)</span> is a small number. The way we write the Hamiltonian
and its interaction term is meant to simulate the switching of the interaction.</p>
<p>The time evolution of the wave function in the interaction picture is then</p>
<div class="math notranslate nohighlight">
\[
|\Psi_I(t) \rangle = \hat{U}_{\varepsilon}(t,t_0)|\Psi_I(t_0)\rangle,
\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
\hat{U}_{\varepsilon}(t,t_0)=\sum_{n=0}^{\infty}\left(\frac{-\imath}{\hbar}\right)^n\frac{1}{n!}
\int_{t_0}^t dt_1\dots \int_{t_0}^t dt_N \exp{(-\varepsilon(t_1+\dots+t_n)/\hbar)}\hat{T}\left[\hat{H}_I(t_1)\dots\hat{H}_I(t_n)\right]
\]</div>
<p>In the limit <span class="math notranslate nohighlight">\(t_0\rightarrow -\infty\)</span>, the solution ot Schr”odinger’s equation is
<span class="math notranslate nohighlight">\(|\Phi_0\rangle\)</span>, and the eigenenergies are given by</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0|\Phi_0\rangle=W_0|\Phi_0\rangle,
\]</div>
<p>meaning that</p>
<div class="math notranslate nohighlight">
\[
|\Psi_S(t_0)\rangle = \exp{(-\imath W_0t_0/\hbar)}|\Phi_0\rangle,
\]</div>
<p>with the corresponding interaction picture wave function given by</p>
<div class="math notranslate nohighlight">
\[
|\Psi_I(t_0)\rangle = \exp{(\imath \hat{H}_0t_0/\hbar)}|\Psi_S(t_0)\rangle=|\Phi_0\rangle.
\]</div>
<p>The solution becomes time independent in the limit <span class="math notranslate nohighlight">\(t_0\rightarrow -\infty\)</span>.
The same conclusion can be reached by looking at</p>
<div class="math notranslate nohighlight">
\[
\imath \hbar\frac{\partial }{\partial t}|\Psi_I(t)\rangle =
\exp{(-\varepsilon |t|/\hbar)}\hat{H}_I|\Psi_I(t)\rangle
\]</div>
<p>and taking the limit <span class="math notranslate nohighlight">\(t\rightarrow \pm\infty\)</span>.
We can rewrite the equation for the wave function at a time <span class="math notranslate nohighlight">\(t=0\)</span> as</p>
<div class="math notranslate nohighlight">
\[
|\Psi_I(0) \rangle = \hat{U}_{\varepsilon}(0,-\infty)|\Phi_0\rangle.
\]</div>
</section>
<section id="wigner-jordan-transformation-and-second-quantization">
<h2><span class="section-number">2.14. </span>Wigner-Jordan transformation and second quantization<a class="headerlink" href="#wigner-jordan-transformation-and-second-quantization" title="Link to this heading">#</a></h2>
</section>
<section id="baker-campbell-hausdorf">
<h2><span class="section-number">2.15. </span>Baker-Campbell-Hausdorf<a class="headerlink" href="#baker-campbell-hausdorf" title="Link to this heading">#</a></h2>
<p>Discuss also Suzuki-Trotter as an approximation to BCH</p>
</section>
<section id="exercise-1-relation-between-basis-functions">
<h2><span class="section-number">2.16. </span>Exercise 1: Relation between basis functions<a class="headerlink" href="#exercise-1-relation-between-basis-functions" title="Link to this heading">#</a></h2>
<p>This exercise serves to convince you about the relation between
two different single-particle bases, where one could be our new Hartree-Fock basis and the other a harmonic oscillator basis.</p>
<p>Consider a Slater determinant built up of single-particle orbitals <span class="math notranslate nohighlight">\(\psi_{\lambda}\)</span>,
with <span class="math notranslate nohighlight">\(\lambda = 1,2,\dots,A\)</span>. The unitary transformation</p>
<div class="math notranslate nohighlight">
\[
\psi_a  = \sum_{\lambda} C_{a\lambda}\phi_{\lambda},
\]</div>
<p>brings us into the new basis.<br />
The new basis has quantum numbers <span class="math notranslate nohighlight">\(a=1,2,\dots,A\)</span>.
Show that the new basis is orthonormal.
Show that the new Slater determinant constructed from the new single-particle wave functions can be
written as the determinant based on the previous basis and the determinant of the matrix <span class="math notranslate nohighlight">\(C\)</span>.
Show that the old and the new Slater determinants are equal up to a complex constant with absolute value unity.
(Hint, <span class="math notranslate nohighlight">\(C\)</span> is a unitary matrix).</p>
<p>Starting with the second quantization representation of the Slater determinant</p>
<div class="math notranslate nohighlight">
\[
\Phi_{0}=\prod_{i=1}^{n}a_{\alpha_{i}}^{\dagger}|0\rangle,
\]</div>
<p>use Wick’s theorem to compute the normalization integral
<span class="math notranslate nohighlight">\(\langle\Phi_{0}|\Phi_{0}\rangle\)</span>.</p>
</section>
<section id="exercise-2-matrix-elements">
<h2><span class="section-number">2.17. </span>Exercise 2: Matrix elements<a class="headerlink" href="#exercise-2-matrix-elements" title="Link to this heading">#</a></h2>
<p>Calculate the matrix elements</p>
<div class="math notranslate nohighlight">
\[
\langle \alpha_{1}\alpha_{2}|\hat{F}|\alpha_{1}\alpha_{2}\rangle
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \alpha_{1}\alpha_{2}|\hat{G}|\alpha_{1}\alpha_{2}\rangle
\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
|\alpha_{1}\alpha_{2}\rangle=a_{\alpha_{1}}^{\dagger}a_{\alpha_{2}}^{\dagger}|0\rangle ,
\]</div>
<div class="math notranslate nohighlight">
\[
\hat{F}=\sum_{\alpha\beta}\langle \alpha|\hat{f}|\beta\rangle
a_{\alpha}^{\dagger}a_{\beta}  ,
\]</div>
<div class="math notranslate nohighlight">
\[
\langle \alpha|\hat{f}|\beta\rangle=\int \psi_{\alpha}^{*}(x)f(x)\psi_{\beta}(x)dx ,
\]</div>
<div class="math notranslate nohighlight">
\[
\hat{G} = \frac{1}{2}\sum_{\alpha\beta\gamma\delta}
\langle \alpha\beta |\hat{g}|\gamma\delta\rangle
a_{\alpha}^{\dagger}a_{\beta}^{\dagger}a_{\delta}a_{\gamma} ,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \alpha\beta |\hat{g}|\gamma\delta\rangle=
\int\int \psi_{\alpha}^{*}(x_{1})\psi_{\beta}^{*}(x_{2})g(x_{1},
x_{2})\psi_{\gamma}(x_{1})\psi_{\delta}(x_{2})dx_{1}dx_{2}
\]</div>
<p>Compare these results with those from exercise 3c).</p>
</section>
<section id="exercise-3-normal-ordered-one-body-operator">
<h2><span class="section-number">2.18. </span>Exercise 3: Normal-ordered one-body operator<a class="headerlink" href="#exercise-3-normal-ordered-one-body-operator" title="Link to this heading">#</a></h2>
<p>Show that the onebody part of the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0 = \sum_{pq} \langle p|\hat{h}_0|q\rangle a^{\dagger}_p a_q,
\]</div>
<p>can be written, using standard annihilation and creation operators, in normal-ordered form as</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0 = \sum_{pq} \langle p|\hat{h}_0|q\rangle \left\{a^\dagger_p a_q\right\} +
             \sum_i \langle i|\hat{h}_0|i\rangle.
\]</div>
<p>Explain the meaning of the various symbols. Which reference
vacuum has been used?</p>
</section>
<section id="exercise-4-normal-ordered-two-body-operator">
<h2><span class="section-number">2.19. </span>Exercise 4: Normal-ordered two-body operator<a class="headerlink" href="#exercise-4-normal-ordered-two-body-operator" title="Link to this heading">#</a></h2>
<p>Show that the twobody part of the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I = \frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle a^\dagger_p a^\dagger_q a_s  a_r,
\]</div>
<p>can be written, using standard annihilation and creation operators, in normal-ordered form as</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I =\frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle \left\{a^\dagger_p a^\dagger_q a_s  a_r\right\}
            + \sum_{pqi} \langle pi|\hat{v}|qi\rangle \left\{a^\dagger_p a_q\right\} 
            + \frac{1}{2} \sum_{ij}\langle ij|\hat{v}|ij\rangle.
\]</div>
<p>Explain again the meaning of the various symbols.</p>
<p>This exercise is optional: Derive the normal-ordered form of the threebody part of the Hamiltonian.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{H}_3 = \frac{1}{36} \sum_{\substack{pqr \\ stu}}
                 \langle pqr|\hat{v}_3|stu\rangle a^\dagger_p a^\dagger_q a^\dagger_r a_u a_t a_s,
\end{split}\]</div>
<p>and specify the contributions to the twobody, onebody and the scalar part.</p>
</section>
<section id="exercise-5-matrix-elements-using-the-slater-condon-rule">
<h2><span class="section-number">2.20. </span>Exercise 5: Matrix elements using the Slater-Condon rule<a class="headerlink" href="#exercise-5-matrix-elements-using-the-slater-condon-rule" title="Link to this heading">#</a></h2>
<p>The aim of this exercise is to set up specific matrix elements that will turn useful when we start our discussions of the nuclear shell model. In particular you will notice, depending on the character of the operator, that many matrix elements will actually be zero.</p>
<p>Consider three <span class="math notranslate nohighlight">\(N\)</span>-particle  Slater determinants  <span class="math notranslate nohighlight">\(|\Phi_0\)</span>, <span class="math notranslate nohighlight">\(|\Phi_i^a\rangle\)</span> and <span class="math notranslate nohighlight">\(|\Phi_{ij}^{ab}\rangle\)</span>, where the notation means that
Slater determinant <span class="math notranslate nohighlight">\(|\Phi_i^a\rangle\)</span> differs from <span class="math notranslate nohighlight">\(|\Phi_0\rangle\)</span> by one single-particle state, that is a single-particle
state <span class="math notranslate nohighlight">\(\psi_i\)</span> is replaced by a single-particle state <span class="math notranslate nohighlight">\(\psi_a\)</span>.
It is often interpreted as a so-called one-particle-one-hole excitation.
Similarly, the Slater determinant <span class="math notranslate nohighlight">\(|\Phi_{ij}^{ab}\rangle\)</span>
differs by two single-particle states from <span class="math notranslate nohighlight">\(|\Phi_0\rangle\)</span> and is normally thought of as a two-particle-two-hole excitation.
We assume also that <span class="math notranslate nohighlight">\(|\Phi_0\rangle\)</span> represents our new vacuum reference state
and the labels <span class="math notranslate nohighlight">\(ijk\dots\)</span> represent single-particle states below the Fermi level and <span class="math notranslate nohighlight">\(abc\dots\)</span> represent states above the Fermi level, so-called particle states.
We define thereafter a general onebody normal-ordered (with respect to the new vacuum state) operator
as</p>
<div class="math notranslate nohighlight">
\[
\hat{F}_N=\sum_{pq}\langle p |f |\beta\rangle \left\{a_{p}^{\dagger}a_{q}\right\}  ,
\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
\langle p |f| q\rangle=\int \psi_{p}^{*}(x)f(x)\psi_{q}(x)dx ,
\]</div>
<p>and a general normal-ordered two-body operator</p>
<div class="math notranslate nohighlight">
\[
\hat{G}_N = \frac{1}{4}\sum_{pqrs}
\langle pq |g| rs\rangle_{AS} \left\{a_{p}^{\dagger}a_{q}^{\dagger}a_{s}a_{r}\right\} ,
\]</div>
<p>with for example the direct matrix element given as</p>
<div class="math notranslate nohighlight">
\[
\langle pq |g| rs\rangle=
\int\int \psi_{p}^{*}(x_{1})\psi_{q}^{*}(x_{2})g(x_{1}, x_{2})\psi_{r}(x_{1})\psi_{s}(x_{2})dx_{1}dx_{2}
\]</div>
<p>with <span class="math notranslate nohighlight">\(g\)</span> being invariant under the interchange of the coordinates of two particles.
The single-particle states <span class="math notranslate nohighlight">\(\psi_i\)</span> are not necessarily eigenstates of <span class="math notranslate nohighlight">\(\hat{f}\)</span>.  The curly brackets mean that the operators are normal-ordered with respect to the new vacuum reference state.</p>
<p>How would you write the above Slater determinants in a second quantization formalism, utilizing the fact that we have defined a new reference state?</p>
<p>Use thereafter Wick’s theorem to find the expectation values of</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0 \vert\hat{F}_N\vert\Phi_0\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0\hat{G}_N|\Phi_0\rangle.
\]</div>
<p>Find thereafter</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0 |\hat{F}_N|\Phi_i^a\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0|\hat{G}_N|\Phi_i^a\rangle,
\]</div>
<p>Finally, find</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0 |\hat{F}_N|\Phi_{ij}^{ab}\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0|\hat{G}_N|\Phi_{ij}^{ab}\rangle.
\]</div>
<p>What happens with the two-body operator if we have a transition probability  of the type</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0|\hat{G}_N|\Phi_{ijk}^{abc}\rangle,
\]</div>
<p>where the Slater determinant to the right of the operator differs by more than two single-particle states?</p>
</section>
<section id="exercise-6-program-to-set-up-slater-determinants">
<h2><span class="section-number">2.21. </span>Exercise 6: Program to set up Slater determinants<a class="headerlink" href="#exercise-6-program-to-set-up-slater-determinants" title="Link to this heading">#</a></h2>
<p>Write a program which sets up all possible Slater determinants given <span class="math notranslate nohighlight">\(N=4\)</span> eletrons which can occupy
the atomic single-particle states defined by the <span class="math notranslate nohighlight">\(1s\)</span>, <span class="math notranslate nohighlight">\(2s2p\)</span> and <span class="math notranslate nohighlight">\(3s3p3d\)</span> shells. How many single-particle
states <span class="math notranslate nohighlight">\(n\)</span> are there in total?  Include the spin degrees of freedom as well.</p>
</section>
<section id="exercise-7-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">2.22. </span>Exercise 7: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-7-using-sympy-to-compute-matrix-elements" title="Link to this heading">#</a></h2>
<p>Compute the matrix element</p>
<div class="math notranslate nohighlight">
\[
\langle\alpha_{1}\alpha_{2}\alpha_{3}|\hat{G}|\alpha_{1}'\alpha_{2}'\alpha_{3}'\rangle,
\]</div>
<p>using Wick’s theorem and express the two-body operator
<span class="math notranslate nohighlight">\(G\)</span> in the occupation number (second quantization)
representation.</p>
</section>
<section id="exercise-8-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">2.23. </span>Exercise 8: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-8-using-sympy-to-compute-matrix-elements" title="Link to this heading">#</a></h2>
<p>The last exercise can be solved using the symbolic Python package called <em>SymPy</em>. SymPy is a Python
package for general purpose symbolic algebra. There is a physics module with several interesting submodules.
Among these, the submodule called <em>secondquant</em>, contains several  functionalities that allow us to test
our algebraic manipulations using Wick’s theorem and operators for second quantization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;i,j&#39;</span><span class="p">,</span> <span class="n">below_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a,b&#39;</span><span class="p">,</span> <span class="n">above_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p,q&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">simplify</span><span class="p">(</span><span class="n">wicks</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
    <span class="nb">print</span> <span class="n">simplify</span><span class="p">(</span><span class="n">wicks</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
          <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
<p>The code defines single-particle states above and below the Fermi level, in addition to the genereal symbols
<span class="math notranslate nohighlight">\(pq\)</span> which can refer to any type of state below or above the Fermi level. Wick’s theorem is implemented between
the creation and annihilation operators <em>Fd</em> and <em>F</em>, respectively. Using the simplify option, one can lump together several Kronecker-<span class="math notranslate nohighlight">\(\delta\)</span> functions.</p>
</section>
<section id="exercise-9-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">2.24. </span>Exercise 9: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-9-using-sympy-to-compute-matrix-elements" title="Link to this heading">#</a></h2>
<p>We can expand the above Python code by defining one-body and two-body operators using  the following SymPy code</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This code sets up a two-body Hamiltonian for fermions</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span>

<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,),(</span><span class="n">q</span><span class="p">,))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">((</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
<span class="n">Hamiltonian</span><span class="o">=</span><span class="n">f</span><span class="o">*</span><span class="n">pr</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="nb">print</span> <span class="s2">&quot;Hamiltonian defined as:&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">Hamiltonian</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here we have used the <em>AntiSymmetricTensor</em> functionality, together with normal-ordering defined by the <em>NO</em> function.
Using the <em>latex</em> option, this program produces the following output</p>
<div class="math notranslate nohighlight">
\[
f^{p}_{q} \left\{a^\dagger_{p} a_{q}\right\} - \frac{1}{4} v^{qp}_{sr} \left\{a^\dagger_{p} a^\dagger_{q} a_{r} a_{s}\right\}
\]</div>
</section>
<section id="exercise-10-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">2.25. </span>Exercise 10: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-10-using-sympy-to-compute-matrix-elements" title="Link to this heading">#</a></h2>
<p>We can now use this code to compute the matrix elements between two two-body Slater determinants using Wick’s theorem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">simplify</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">evaluate_deltas</span>
<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,),(</span><span class="n">q</span><span class="p">,))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">((</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
<span class="n">Hamiltonian</span><span class="o">=</span><span class="n">f</span><span class="o">*</span><span class="n">pr</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c, d&#39;</span><span class="p">,</span><span class="n">above_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a, b&#39;</span><span class="p">,</span><span class="n">above_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">expression</span> <span class="o">=</span> <span class="n">wicks</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">Hamiltonian</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">simplify_kronecker_deltas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">evaluate_deltas</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Hamiltonian defined as:&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The result is as expected,</p>
<div class="math notranslate nohighlight">
\[
\delta_{a c} f^{b}_{d} - \delta_{a d} f^{b}_{c} - \delta_{b c} f^{a}_{d} + \delta_{b d} f^{a}_{c} + v^{ab}_{cd}.
\]</div>
</section>
<section id="exercise-11-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">2.26. </span>Exercise 11: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-11-using-sympy-to-compute-matrix-elements" title="Link to this heading">#</a></h2>
<p>We can continue along these lines and define a normal-ordered Hamiltonian with respect to a given reference state.
In our first step we just define the Hamiltonian</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">simplify</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">evaluate_deltas</span>
<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,),(</span><span class="n">q</span><span class="p">,))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="c1">#define the Hamiltonian</span>
<span class="n">Hamiltonian</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">pr</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="c1">#define indices for states above and below the Fermi level</span>
<span class="n">index_rule</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;below&#39;</span><span class="p">:</span>  <span class="s1">&#39;kl&#39;</span><span class="p">,</span>
     <span class="s1">&#39;above&#39;</span><span class="p">:</span>  <span class="s1">&#39;cd&#39;</span><span class="p">,</span>
     <span class="s1">&#39;general&#39;</span><span class="p">:</span> <span class="s1">&#39;pqrs&#39;</span>
     <span class="p">}</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">substitute_dummies</span><span class="p">(</span><span class="n">Hamiltonian</span><span class="p">,</span><span class="n">new_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pretty_indices</span><span class="o">=</span><span class="n">index_rule</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Hamiltonian defined as:&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>which results in</p>
<div class="math notranslate nohighlight">
\[
f^{q}_{p} a^\dagger_{q} a_{p} + \frac{1}{4} v^{sr}_{qp} a^\dagger_{s} a^\dagger_{r} a_{p} a_{q}
\]</div>
</section>
<section id="exercise-12-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">2.27. </span>Exercise 12: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-12-using-sympy-to-compute-matrix-elements" title="Link to this heading">#</a></h2>
<p>In our next step we define the reference energy <span class="math notranslate nohighlight">\(E_0\)</span> and redefine the Hamiltonian by subtracting the reference energy and collecting the coefficients for all normal-ordered products (given by the <em>NO</em> function).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">simplify</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">evaluate_deltas</span>
<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,),(</span><span class="n">q</span><span class="p">,))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="c1">#define the Hamiltonian</span>
<span class="n">Hamiltonian</span><span class="o">=</span><span class="n">f</span><span class="o">*</span><span class="n">pr</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="c1">#define indices for states above and below the Fermi level</span>
<span class="n">index_rule</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;below&#39;</span><span class="p">:</span>  <span class="s1">&#39;kl&#39;</span><span class="p">,</span>
     <span class="s1">&#39;above&#39;</span><span class="p">:</span>  <span class="s1">&#39;cd&#39;</span><span class="p">,</span>
     <span class="s1">&#39;general&#39;</span><span class="p">:</span> <span class="s1">&#39;pqrs&#39;</span>
     <span class="p">}</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">substitute_dummies</span><span class="p">(</span><span class="n">Hamiltonian</span><span class="p">,</span><span class="n">new_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pretty_indices</span><span class="o">=</span><span class="n">index_rule</span><span class="p">)</span>
<span class="n">E0</span> <span class="o">=</span> <span class="n">wicks</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">,</span><span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">Hnormal</span><span class="o">-</span><span class="n">E0</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">WildFunction</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">,</span> <span class="n">NO</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">evaluate_deltas</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">latex</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>which gives us</p>
<div class="math notranslate nohighlight">
\[
- f^{i}_{i} + f^{q}_{p} a^\dagger_{q} a_{p} - \frac{1}{4} v^{ii}_{ii} - \frac{1}{4} v^{ii}_{ii} + \frac{1}{4} v^{sr}_{qp} a^\dagger_{r} a^\dagger_{s} a_{q} a_{p},
\]</div>
<p>again as expected, with the reference energy to be subtracted.</p>
</section>
<section id="exercise-13-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">2.28. </span>Exercise 13: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-13-using-sympy-to-compute-matrix-elements" title="Link to this heading">#</a></h2>
<p>We can now go back to exercise 7 and define the Hamiltonian and the second-quantized representation of a  three-body Slater determinant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">simplify</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">evaluate_deltas</span>
<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
<span class="n">Hamiltonian</span><span class="o">=</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a,b, c, d, e, f&#39;</span><span class="p">,</span><span class="n">above_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">expression</span> <span class="o">=</span> <span class="n">wicks</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">Hamiltonian</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">simplify_kronecker_deltas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">evaluate_deltas</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">latex</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>resulting in nine terms (as expected),</p>
<div class="math notranslate nohighlight">
\[
- \delta_{a d} v^{cb}_{ef} - \delta_{a e} v^{cb}_{fd} + \delta_{a f} v^{cb}_{ed} - \delta_{b d} v^{ac}_{ef} - \delta_{b e} v^{ac}_{fd} + \delta_{b f} v^{ac}_{ed} + \delta_{c d} v^{ab}_{ef} + \delta_{c e} v^{ab}_{fd} - \delta_{c f} v^{ab}_{ed}
\]</div>
</section>
<section id="exercise-14-diagrammatic-representation-of-hartree-fock-equations">
<h2><span class="section-number">2.29. </span>Exercise 14: Diagrammatic representation of Hartree-Fock equations<a class="headerlink" href="#exercise-14-diagrammatic-representation-of-hartree-fock-equations" title="Link to this heading">#</a></h2>
<p>What is the diagrammatic representation of the HF equation?</p>
<div class="math notranslate nohighlight">
\[
-\langle\alpha_{k}|u^{HF}|\alpha_{i}\rangle+\sum_{j=1}^{n}
\left[\langle\alpha_{k}\alpha_{j}|\hat{v}|\alpha_{i}\alpha_{j}\rangle-
\langle\alpha_{k}\alpha_{j}|v|\alpha_{j}\alpha_{i}\rangle\right]=0
\]</div>
<p>(Represent <span class="math notranslate nohighlight">\((-u^{HF})\)</span> by the symbol <span class="math notranslate nohighlight">\(---\)</span>X .)</p>
</section>
<section id="exercise-15-derivation-of-hartree-fock-equations">
<h2><span class="section-number">2.30. </span>Exercise 15: Derivation of Hartree-Fock equations<a class="headerlink" href="#exercise-15-derivation-of-hartree-fock-equations" title="Link to this heading">#</a></h2>
<p>Consider the ground state <span class="math notranslate nohighlight">\(|\Phi\rangle\)</span>
of a bound many-particle system of fermions. Assume that we remove one particle
from the single-particle state <span class="math notranslate nohighlight">\(\lambda\)</span> and that our system ends in a new state
<span class="math notranslate nohighlight">\(|\Phi_{n}\rangle\)</span>.
Define the energy needed to remove this particle as</p>
<div class="math notranslate nohighlight">
\[
E_{\lambda}=\sum_{n}\vert\langle\Phi_{n}|a_{\lambda}|\Phi\rangle\vert^{2}(E_{0}-E_{n}),
\]</div>
<p>where <span class="math notranslate nohighlight">\(E_{0}\)</span> and <span class="math notranslate nohighlight">\(E_{n}\)</span>  are the ground state energies of the states
<span class="math notranslate nohighlight">\(|\Phi\rangle\)</span>  and  <span class="math notranslate nohighlight">\(|\Phi_{n}\rangle\)</span>, respectively.</p>
<ul class="simple">
<li><p>Show that</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
E_{\lambda}=\langle\Phi|a_{\lambda}^{\dagger}\left[
a_{\lambda},H \right]|\Phi\rangle,
\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the Hamiltonian of this system.</p>
<ul class="simple">
<li><p>If we assume that <span class="math notranslate nohighlight">\(\Phi\)</span> is the  Hartree-Fock result, find the</p></li>
</ul>
<p>relation between <span class="math notranslate nohighlight">\(E_{\lambda}\)</span> and the single-particle energy
<span class="math notranslate nohighlight">\(\varepsilon_{\lambda}\)</span>
for states <span class="math notranslate nohighlight">\(\lambda \leq F\)</span> and <span class="math notranslate nohighlight">\(\lambda &gt;F\)</span>, with</p>
<div class="math notranslate nohighlight">
\[
\varepsilon_{\lambda}=\langle\lambda|\hat{t}+\hat{u}|\lambda\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle\lambda|\hat{u}|\lambda\rangle=\sum_{\beta \leq F}
\langle\lambda\beta|\hat{v}|\lambda\beta\rangle.
\]</div>
<p>We have assumed an antisymmetrized matrix element here.
Discuss the result.</p>
<p>The Hamiltonian operator is defined as</p>
<div class="math notranslate nohighlight">
\[
H=\sum_{\alpha\beta}\langle\alpha|\hat{t}|\beta\rangle a_{\alpha}^{\dagger}a_{\beta}+
\frac{1}{2}\sum_{\alpha\beta\gamma\delta}\langle\alpha\beta|\hat{v}|\gamma\delta\rangle a_{\alpha}^{\dagger}a_{\beta}^{\dagger}a_{\delta}a_{\gamma}.
\]</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="notation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Introduction to many-body physics</p>
      </div>
    </a>
    <a class="right-next"
       href="fci.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Full configuration interaction theory</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-body-operators-in-second-quantization">2.1. One-body operators in second quantization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-body-operators-in-second-quantization">2.2. Two-body operators in second quantization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-wick-s-theorem">2.3. Proof of Wick’s theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaction-schroedinger-and-heisenberg-pictures">2.4. Interaction, Schroedinger and Heisenberg pictures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-wick-s-theorem">2.5. Time dependent wick’s theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gell-man-and-low-s-theorem-and-adiabatic-switching">2.6. Gell-Man and Low’s theorem and Adiabatic switching</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#particle-hole-formalism">2.7. Particle-hole formalism</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summarizing-and-defining-a-normal-ordered-hamiltonian">2.8. Summarizing and defining a normal-ordered Hamiltonian</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators-in-second-quantization">2.9. Operators in second quantization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schr-odinger-picture">2.10. Schr”odinger picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaction-picture">2.11. Interaction picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heisenberg-picture">2.12. Heisenberg picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adiabatic-hypothesis">2.13. Adiabatic hypothesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wigner-jordan-transformation-and-second-quantization">2.14. Wigner-Jordan transformation and second quantization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#baker-campbell-hausdorf">2.15. Baker-Campbell-Hausdorf</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-relation-between-basis-functions">2.16. Exercise 1: Relation between basis functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-matrix-elements">2.17. Exercise 2: Matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-normal-ordered-one-body-operator">2.18. Exercise 3: Normal-ordered one-body operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-normal-ordered-two-body-operator">2.19. Exercise 4: Normal-ordered two-body operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5-matrix-elements-using-the-slater-condon-rule">2.20. Exercise 5: Matrix elements using the Slater-Condon rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6-program-to-set-up-slater-determinants">2.21. Exercise 6: Program to set up Slater determinants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-using-sympy-to-compute-matrix-elements">2.22. Exercise 7: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-using-sympy-to-compute-matrix-elements">2.23. Exercise 8: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9-using-sympy-to-compute-matrix-elements">2.24. Exercise 9: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-using-sympy-to-compute-matrix-elements">2.25. Exercise 10: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-using-sympy-to-compute-matrix-elements">2.26. Exercise 11: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12-using-sympy-to-compute-matrix-elements">2.27. Exercise 12: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-13-using-sympy-to-compute-matrix-elements">2.28. Exercise 13: Using sympy to compute matrix elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-14-diagrammatic-representation-of-hartree-fock-equations">2.29. Exercise 14: Diagrammatic representation of Hartree-Fock equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-15-derivation-of-hartree-fock-equations">2.30. Exercise 15: Derivation of Hartree-Fock equations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Morten Hjorth-Jensen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>