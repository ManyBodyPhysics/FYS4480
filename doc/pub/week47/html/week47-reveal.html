<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week47-reveal.html week47-reveal reveal --html_slide_theme=beige
-->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Week 47: Coupled Cluster  and Summary of Course with Future Perspective">
<title>Week 47: Coupled Cluster  and Summary of Course with Future Perspective</title>

<!-- reveal.js: https://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/league.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- Printing and PDF exports -->
<script>
var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
document.getElementsByTagName( 'head' )[0].appendChild( link );
</script>

<style type="text/css">
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.reveal .alert-text-small   { font-size: 80%;  }
.reveal .alert-text-large   { font-size: 130%; }
.reveal .alert-text-normal  { font-size: 90%;  }
.reveal .alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:5px solid #bababa;
  -webkit-border-radius: 14px; -moz-border-radius: 14px;
  border-radius:14px;
  background-position: 10px 10px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 30px; /* 55px; if icon */
}
.reveal .alert-block {padding-top:14px; padding-bottom:14px}
.reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
/*.reveal .alert li {margin-top: 1em}*/
.reveal .alert-block p+p {margin-top:5px}
/*.reveal .alert-notice { background-image: url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
.reveal .alert-summary  { background-image:url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
.reveal .alert-warning { background-image: url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
.reveal .alert-question {background-image:url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */
/* Override reveal.js table border */
.reveal table td {
  border: 0;
}

<style type="text/css">
/* Override h1, h2, ... styles */
h1 { font-size: 2.8em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.4em; }
h4 { font-size: 1.3em; }
h1, h2, h3, h4 { font-weight: bold; line-height: 1.2; }
body { overflow: auto; } /* vertical scrolling */
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.slide .alert-text-small   { font-size: 80%;  }
.slide .alert-text-large   { font-size: 130%; }
.slide .alert-text-normal  { font-size: 90%;  }
.slide .alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:5px solid #bababa;
    -webkit-border-radius:14px; -moz-border-radius:14px;
  border-radius:14px
  background-position: 10px 10px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 30px; /* 55px; if icon */
}
.slide .alert-block {padding-top:14px; padding-bottom:14px}
.slide .alert-block > p, .alert-block > ul {margin-bottom:0}
/*.slide .alert li {margin-top: 1em}*/
.deck .alert-block p+p {margin-top:5px}
/*.slide .alert-notice { background-image: url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_notice.png); }
.slide .alert-summary  { background-image:url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_summary.png); }
.slide .alert-warning { background-image: url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_warning.png); }
.slide .alert-question {background-image:url(https://hplgit.github.io/doconce/
bundled/html_images/small_gray_question.png); } */
.dotable table, .dotable th, .dotable tr, .dotable tr td {
  border: 2px solid black;
  border-collapse: collapse;
  padding: 2px;
}
</style>


<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>


<body>
<div class="reveal">
<div class="slides">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




<section>
<!-- ------------------- main content ---------------------- -->
<center>
<h1 style="text-align: center;">Week 47: Coupled Cluster  and Summary of Course with Future Perspective</h1>
</center>  <!-- document title -->

<!-- author(s): Morten Hjorth-Jensen -->
<center>
<b>Morten Hjorth-Jensen</b> [1, 2]
</center>
<!-- institution(s) -->
<center>
[1] <b>Department of Physics and Center for Computing in Science Education, University of Oslo, Norway</b>
</center>
<center>
[2] <b>Department of Physics and Astronomy and Facility for Rare Isotope Beams, Michigan State University, USA</b>
</center>
<br>
<center>
<h4>Week 47, November 21-25</h4>
</center> <!-- date -->
<br>


<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2022, Morten Hjorth-Jensen. Released under CC Attribution-NonCommercial 4.0 license
</center>
</section>

<section>
<h2 id="week-47-november-21-25-2022">Week 47, November 21-25, 2022 </h2>
<ul>
<p><li> Topics to be covered</li>
<ul>

<p><li> Thursday:</li>
<ul>

<p><li> Coupled Cluster theory, singles and doubles excitations, diagrammatic expansion</li>

<p><li> <a href="https://youtu.be/MCuq8FIfHNk" target="_blank">Video of lecture</a></li>
</ul>
<p>

<p><li> Friday:</li>
<ul>

<p><li> Coupled Cluster theory, diagrammatic approach  and summary of course</li>

<p><li> <a href="https://youtu.be/jZxYjVL-Z94" target="_blank">Video of lecture</a></li>
</ul>
<p>
</ul>
<p>
<p><li> Lecture Material: <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/pub/week47/pdf/slidesweek46.pdf" target="_blank">Repetition slides for week 46</a>, handwritten notes and Shavitt and Bartlett chapter 9</li>
<p><li> Lecture Material: <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/pub/week47/pdf/week47.pdf" target="_blank">Coupled Cluster theory slides for week 47</a>, handwritten notes and Shavitt and Bartlett chapter 9</li>
</ul>
<p>
<p>Work on second midterm set at <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/Exercises/2022/SecondMidterm2022.pdf" target="_blank"><tt>https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/Exercises/2022/SecondMidterm2022.pdf</tt></a></p>
</section>

<section>
<h2 id="introduction">Introduction </h2>

<p>The coupled-cluster method is an efficient tool to compute atomic
nuclei with an effort that grows polynomial with system size. While
this might still be expensive, it is now possible to compute nuclei
with mass numbers about \( A\approx 100 \) with this method. Recall that
full configuration interaction (FCI) such as the no-core shell model
exhibits an exponential cost and is therefore limited to light nuclei.
</p>
</section>

<section>
<h2 id="the-normal-ordered-hamiltonian">The normal-ordered Hamiltonian </h2>

<p>We start from the reference state</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{1}
\vert\Phi_0\rangle = \prod_{i=1}^A a^\dagger_i \vert 0\rangle 
\end{equation}
$$
<p>&nbsp;<br>

<p>for the description of for example a nucleus with mass number \( A \).  Usually, this
reference is the Hartree-Fock state, but that is not necessary. In the
shell-model picture, it could also be a product state where the lowest
\( A \) harmonic oscillator states are occupied.  Here and in what
follows, the indices \( i,j,k,\ldots \) run over hole states,
i.e. orbitals occupied in the reference state <a href="#mjx-eqn-1">(1)</a>, while
\( a,b,c,\ldots \) run over particle states, i.e. unoccupied
orbitals. Indices \( p,q,r,s \) can identify any orbital.  Let \( n_u \) be
the number of unoccupied states, and \( A \) is of course the number of
occupied states.
</p>

<p>We consider the Hamiltonian</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{2} H =
\sum_{pq} \varepsilon^p_q a^\dagger_p a_q +
\frac{1}{4}\sum_{pqrs}\langle pq\vert V\vert rs\rangle
a^\dagger_pa^\dagger_q a_sa_r
\end{equation}
$$
<p>&nbsp;<br>

<p>The reference state <a href="#mjx-eqn-1">(1)</a> is a non-trivial vacuum of our theory. 
We normal order this Hamiltonian with respect to the nontrivial vacuum
state given by the Hartree-Fock reference and obtain the
normal-ordered Hamiltonian
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{3}
H_N = \sum_{pq} f_{pq} \left\{a^\dagger_p a_q\right\} + \frac{1}{4}\sum_{pqrs}\langle pq\vert V\vert rs\rangle \left\{a^\dagger_pa^\dagger_q a_sa_r\right\}.
\end{equation}
$$
<p>&nbsp;<br>

<p>Here,</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{4}
f^p_q = \varepsilon^p_q + \sum_i \langle pi\vert V\vert qi\rangle
\end{equation}
$$
<p>&nbsp;<br>

<p>is the Fock matrix. We note that the Fock matrix is diagonal in the
Hartree-Fock basis. The brackets \( \{\cdots\} \) in Eq. <a href="#mjx-eqn-3">(3)</a> denote
normal ordering, i.e. all operators that annihilate the nontrivial
vaccum <a href="#mjx-eqn-1">(1)</a> are to the right of those operators that create
with respect to that vaccum. Normal ordering implies that \( \langle
\Phi_0\vert H_N\vert \Phi_0\rangle = 0 \).
</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin exercise --- -->
<h2 id="ex-1">Exercise 1: Practice in normal ordering</h2>

<p>Normal order the expression \( \sum\limits_{pq}\varepsilon_q^p a^\dagger_p a_q \).</p>
</div>

<p>We note that \( H = E_{HF} + H_N \), where</p>

<p>&nbsp;<br>
$$
\begin{align}
E_{HF} &\equiv \langle\Phi_0\vert H\vert \Phi_0\rangle = \sum_{i} \varepsilon^i_i +\frac{1}{2}\sum_{ij}\langle ij\vert V\vert ij\rangle
\tag{5}
\end{align}
$$
<p>&nbsp;<br>

<p>is the Hartree-Fock energy.
The coupled-cluster method is a very efficient tool to compute nuclei
when a &quot;good&quot; reference state is available. Let us assume that the
reference state results from a Hartree-Fock calculation.
</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
</p>
<p>&nbsp;<br>
$$
\begin{align}
\sum_{pq}\varepsilon_q^p a^\dagger_p a_q
=\sum_{ab}\varepsilon_b^a a^\dagger_a a_b
+\sum_{ai}\varepsilon_i^a a^\dagger_a a_i
+\sum_{ai}\varepsilon_a^i a^\dagger_i a_a   
+\sum_{ij}\varepsilon_j^i a^\dagger_i a_j
\tag{6}
\end{align}
$$
<p>&nbsp;<br>


<!-- --- end hint in exercise --- -->

<!-- --- begin answer of exercise --- -->
<p>
<b>Answer.</b>
We have to move all operators that annihilate the reference state to the right of those that create on the reference state. Thus,
</p>
<p>&nbsp;<br>
$$
\begin{align}
\sum_{pq}\varepsilon_q^p a^\dagger_p a_q
&=\sum_{ab}\varepsilon_b^a a^\dagger_a a_b
+\sum_{ai}\varepsilon_i^a a^\dagger_a a_i
+\sum_{ai}\varepsilon_a^i a^\dagger_i a_a
+\sum_{ij}\varepsilon_j^i a^\dagger_i a_j
\tag{7}\\
&=\sum_{ab}\varepsilon_b^a a^\dagger_a a_b
+\sum_{ai}\varepsilon_i^a a^\dagger_a a_i
+\sum_{ai}\varepsilon_a^i a^\dagger_i a_a
+\sum_{ij}\varepsilon_j^i \left(-a_ja^\dagger_i +\delta_i^j\right)
\tag{8}\\
&=\sum_{ab}\varepsilon_b^a a^\dagger_a a_b
+\sum_{ai}\varepsilon_i^a a^\dagger_a a_i
+\sum_{ai}\varepsilon_a^i a^\dagger_i a_a
-\sum_{ij}\varepsilon_j^i a_ja^\dagger_i +\sum_i \varepsilon_i^i
\tag{9}\\
&=\sum_{pq}\varepsilon_q^p \left\{a^\dagger_p a_q\right\} +\sum_i \varepsilon_i^i
\tag{10}
\end{align}
$$
<p>&nbsp;<br>


<!-- --- end answer of exercise --- -->

<!-- --- end exercise --- -->

<!-- --- begin exercise --- -->
<h2 id="ex-2">Exercise 2: What does &quot;good&quot; mean?</h2>

<p>How do you know whether a Hartree-Fock state is a &quot;good&quot; reference?
Which results of the Hartree-Fock computation will inform you?
</p>
</div>

<p>If symmetry-restricted Hartree-Fock is used, one is limited to compute
nuclei with closed subshells for neutrons and for protons. On a first
view, this might seem as a severe limitation. But is it?
</p>

<!-- --- begin answer of exercise --- -->
<p>
<b>Answer.</b>
Once the Hartree-Fock equations are solved, the Fock matrix
<a href="#mjx-eqn-4">(4)</a> becomes diagonal, and its diagonal elements can be viewed
as single-particle energies. Hopefully, there is a clear gap in the
single-particle spectrum at the Fermi surface, i.e. after \( A \) orbitals
are filled.
</p>

<!-- --- end answer of exercise --- -->

<!-- --- end exercise --- -->
</section>

<section>
<h2 id="the-similarity-transformed-hamiltonian">The similarity transformed Hamiltonian </h2>

<p>There are several ways to view and understand the coupled-cluster
method. A first simple view of coupled-cluster theory is that the
method induces correlations into the reference state by expressing a
correlated state as
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{11}
\vert\Psi\rangle = e^T \vert\Phi_0\rangle ,
\end{equation}
$$
<p>&nbsp;<br>

<p>Here, \( T \) is an operator that induces correlations. We can now demand
that the correlate state <a href="#mjx-eqn-11">(11)</a> becomes and eigenstate of the
Hamiltonian \( H_N \), i.e.  \( H_N\vert \Psi\rangle = E\vert \Psi\rangle \). This view,
while correct, is not the most productive one.  Instead, we
left-multiply the Schroedinger equation with \( e^{-T} \) and find
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{12}
\overline{H_N}\vert \Phi_0\rangle = E_c \vert \Phi_0\rangle . 
\end{equation}
$$
<p>&nbsp;<br>

<p>Here, \( E_c \) is the correlation energy, and the total energy is
\( E=E_c+E_{HF} \).  The similarity-transformed Hamiltonian is defined as
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{13}
\overline{H_N} \equiv e^{-T} H_N e^T .
\end{equation}
$$
<p>&nbsp;<br>

<p>A more productive view on coupled-cluster theory thus emerges: This
method seeks a similarity transformation such that the uncorrelated
reference state <a href="#mjx-eqn-1">(1)</a> becomes an exact eigenstate of the
similarity-transformed Hamiltonian <a href="#mjx-eqn-13">(13)</a>.
</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin exercise --- -->
<h2 id="ex-4">Exercise 3: What \( T \) leads to Hermitian \( \overline{H_N} \) ?</h2>

<p>What are the conditions on \( T \) such that \( \overline{H_N} \) is Hermitian?</p>
</div>

<p>As we will see below, coupled-cluster theory employs a non-Hermitian Hamiltonian.</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin answer of exercise --- -->
<p>
<b>Answer.</b>
For a Hermitian \( \overline{H_N} \), we need a unitary \( e^T \), i.e. an
anti-Hermitian \( T \) with \( T = -T^\dagger \)
</p>

<!-- --- end answer of exercise --- -->

<!-- --- end exercise --- -->

<!-- --- begin exercise --- -->
<h2 id="ex-5">Exercise 4: Understanding (non-unitary) similarity transformations</h2>

<p>Show that \( \overline{H_N} \) has the same eigenvalues as \( H_N \) for
arbitrary \( T \). What is the spectral decomposition of a non-Hermitian
\( \overline{H_N} \) ?
</p>
</div>

<p>To make progress, we have to specify the cluster operator \( T \). In
coupled cluster theory, this operator is
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{14}
T \equiv \sum_{ia} t_i^a a^\dagger_a a_i + \frac{1}{4}\sum_{ijab}t_{ij}^{ab}
a^\dagger_aa^\dagger_ba_ja_i + \cdots
+ \frac{1}{(A!)^2}\sum_{i_1\ldots i_A a_1 \ldots a_A}
t_{i_1\ldots i_A}^{a_1\ldots a_A} a^\dagger_{a_1}\cdots a^\dagger_{a_A} a_{i_A}\cdots a_{i_1} .
\end{equation}
$$
<p>&nbsp;<br>

<p>Thus, the operator <a href="#mjx-eqn-14">(14)</a> induces particle-hole (p-h)
excitations with respect to the reference. In general, \( T \) generates
up to \( Ap-Ah \) excitations, and the unknown parameters are the cluster amplitides
\( t_i^a \), \( t_{ij}^{ab} \), ..., \( t_{i_1,\ldots,i_A}^{a_1,\ldots,a_A} \).
</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin answer of exercise --- -->
<p>
<b>Answer.</b>
Let \( H_N\vert E\rangle = E\vert E\rangle \). Thus
</p>

<p>&nbsp;<br>
$$
\begin{align*}
H_N e^{T} e^{-T} \vert E\rangle &= E\vert E\rangle , \\
\left(e^{-T} H_N e^T\right) e^{-T} \vert E\rangle &= Ee^{-T} \vert E\rangle , \\
\overline{H_N} e^{-T} \vert E\rangle &= E e^{-T}\vert E\rangle .
\end{align*}
$$
<p>&nbsp;<br>

<p>Thus, if \( \vert E\rangle \) is an eigenstate of \( H_N \) with eigenvalue \( E \),
then \( e^{-T}\vert E\rangle \) is eigenstate of \( \overline{H_N} \) with the same
eigenvalue.
</p>

<p>A non-Hermitian \( \overline{H_N} \) has eigenvalues \( E_\alpha \)
corresponding to left \( \langle L_\alpha\vert  \) and right \( \vert R_\alpha
\rangle \) eigenstates. Thus
</p>

<p>&nbsp;<br>
$$
\begin{align}
\overline{H_N} = \sum_\alpha \vert R_\alpha\rangle E_\alpha \langle L_\alpha \vert 
\tag{15}
\end{align}
$$
<p>&nbsp;<br>

<p>with bi-orthonormal \( \langle L_\alpha\vert R_\beta\rangle = \delta_\alpha^\beta \).</p>

<!-- --- end answer of exercise --- -->

<!-- --- end exercise --- -->

<!-- --- begin exercise --- -->
<h2 id="ex-6">Exercise 5: How many unknowns?</h2>

<p>Show that the number of unknowns is as large as the FCI dimension of
the problem, using the numbers \( A \) and \( n_u \).
</p>
</div>

<p>Thus, the coupled-cluster method with the full cluster operator
<a href="#mjx-eqn-14">(14)</a> is exponentially expensive, just as FCI. To make progress,
we need to make an approximation by truncating the operator. Here, we
will use the CCSD (coupled clusters singles doubles) approximation,
where
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\tag{16}
T \equiv \sum_{ia} t_i^a a^\dagger_a a_i + \frac{1}{4}\sum_{ijab}t_{ij}^{ab}
a^\dagger_aa^\dagger_ba_ja_i .
\end{equation}
$$
<p>&nbsp;<br>

<p>We need to determine the unknown cluster amplitudes that enter in CCSD. Let</p>

<p>&nbsp;<br>
$$
\begin{align}
\vert\Phi_i^a\rangle &= a^\dagger_a a_i \vert \Phi_0\rangle , 
\tag{17}\\
\vert\Phi_{ij}^{ab}\rangle &= a^\dagger_a a^\dagger_b a_j a_i \vert \Phi_0\rangle
\tag{18}
\end{align}
$$
<p>&nbsp;<br>

<p>be 1p-1h and 2p-2h excitations of the reference. Computing matrix
elements of the Schroedinger Equation <a href="#mjx-eqn-12">(12)</a> yields
</p>

<p>&nbsp;<br>
$$
\begin{align}
\tag{19}
\langle \Phi_0\vert \overline{H_N}\vert \Phi_0\rangle &= E_c , \\
\langle \Phi_i^a\vert \overline{H_N}\vert \Phi_0\rangle &= 0 , 
\tag{20}\\
\langle \Phi_{ij}^{ab}\vert \overline{H_N}\vert \Phi_0\rangle &= 0 .
\tag{21}
\end{align}
$$
<p>&nbsp;<br>

<p>The first equation states that the coupled-cluster correlation energy
is an expectation value of the similarity-transformed Hamiltonian. The
second and third equations state that the similarity-transformed
Hamiltonian exhibits no 1p-1h and no 2p-2h excitations. These
equations have to be solved to find the unknown amplitudes \( t_i^a \) and
\( t_{ij}^{ab} \). Then one can use these amplitudes and compute the
correlation energy from the first line of Eq. <a href="#mjx-eqn-19">(19)</a>.
</p>

<p>We note that in the CCSD approximation the reference state is not an
exact eigenstates. Rather, it is decoupled from simple states but
\( \overline{H} \) still connects this state to 3p-3h, and 4p-4h states
etc.
</p>

<p>At this point, it is important to recall that we assumed starting from
a &quot;good&quot; reference state. In such a case, we might reasonably expect
that the inclusion of 1p-1h and 2p-2h excitations could result in an
accurate approximation. Indeed, empirically one finds that CCSD
accounts for about 90% of the corelation energy, i.e. of the
difference between the exact energy and the Hartree-Fock energy. The
inclusion of triples (3p-3h excitations) typically yields 99% of the
correlation energy.
</p>

<p>We see that the coupled-cluster method in its CCSD approximation
yields a similarity-transformed Hamiltonian that is of a two-body
structure with respect to a non-trivial vacuum. When viewed in this
light, the coupled-cluster method &quot;transforms&quot; an \( A \)-body problem
(in CCSD) into a two-body problem, albeit with respect to a nontrivial
vacuum.
</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin answer of exercise --- -->
<p>
<b>Answer.</b>
We have to sum up all \( np-nh \) excitations, and there are
\( \binom{n_u}{n} \) particle states and \( \binom{A}{A-n} \) hole states for
each \( n \). Thus, we have for the total number
</p>

<p>&nbsp;<br>
$$
\begin{align}
\sum_{n=0}^A \binom{n_u}{n} \binom{A}{A-n}= \binom{A+n_u}{A} .
\tag{22}
\end{align}
$$
<p>&nbsp;<br>

<p>The right hand side are obviously all ways to distribute \( A \) fermions over \( n_0+A \) orbitals.</p>

<!-- --- end answer of exercise --- -->

<!-- --- end exercise --- -->

<!-- --- begin exercise --- -->
<h2 id="ex-6b">Exercise 6: Why is CCD not exact?</h2>

<p>Above we argued that a similarity transformation preserves all eigenvalues. Nevertheless, the CCD correlation energy is not the exact correlation energy. Explain!</p>
</div>


<!-- --- begin answer of exercise --- -->
<p>
<b>Answer.</b>
The CCD approximation does not make \( \vert\Phi_0\rangle \) an exact
eigenstate of \( \overline{H_N} \); it is only an eigenstate when the
similarity-transformed Hamiltonian is truncated to at most 2p-2h
states. The full \( \overline{H_N} \), with \( T=T_2 \), would involve
six-body terms (do you understand this?), and this full Hamiltonian
would reproduce the exact correlation energy. Thus CCD is a similarity
transformation plus a truncation, which decouples the ground state only
from 2p-2h states.
</p>

<!-- --- end answer of exercise --- -->

<!-- --- end exercise --- -->
<h2 id="computing-the-similarity-transformed-hamiltonian">Computing the similarity-transformed Hamiltonian </h2>

<p>The solution of the CCSD equations, i.e. the second and third line of
Eq. <a href="#mjx-eqn-19">(19)</a>, and the computation of the correlation energy
requires us to compute matrix elements of the similarity-transformed
Hamiltonian <a href="#mjx-eqn-13">(13)</a>. This can be done with the
Baker-Campbell-Hausdorff expansion
</p>

<p>&nbsp;<br>
$$
\begin{align}
\tag{23}
\overline{H_N} &= e^{-T} H_N e^T \\
&=H_N + \left[ H_N, T\right]+ \frac{1}{2!}\left[ \left[ H_N, T\right], T\right]
+ \frac{1}{3!}\left[\left[ \left[ H_N, T\right], T\right], T\right] +\ldots .
\tag{24}
\end{align}
$$
<p>&nbsp;<br>

<p>We now come to a key element of coupled-cluster theory: the cluster
operator <a href="#mjx-eqn-14">(14)</a> consists of sums of terms that consist of particle
creation and hole annihilation operators (but no particle annihilation
or hole creation operators). Thus, all terms that enter \( T \) commute
with each other. This means that the commutators in the
Baker-Campbell-Hausdorff expansion <a href="#mjx-eqn-23">(23)</a> can only be non-zero
because each \( T \) must connect to \( H_N \) (but no \( T \) with another
\( T \)). Thus, the expansion is finite.
</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin exercise --- -->
<h2 id="ex-7">Exercise 7: When does CCSD truncate?</h2>

<p>In CCSD and for two-body Hamiltonians, how many nested
commutators yield nonzero results? Where does the
Baker-Campbell-Hausdorff expansion terminate? What is the (many-body) rank of the resulting \( \overline{H_N} \)? 
</p>
</div>

<p>We see that the (disadvantage of having a) non-Hermitian Hamiltonian
\( \overline{H_N} \) leads to the advantage that the
Baker-Campbell-Hausdorff expansion is finite, thus leading to the
possibility to compute \( \overline{H_N} \) exactly. In contrast, the
IMSRG deals with a Hermitian Hamiltonian throughout, and the infinite
Baker-Campbell-Hausdorff expansion is truncated at a high order when
terms become very small.
</p>

<p>We write the similarity-transformed Hamiltonian as</p>

<p>&nbsp;<br>
$$
\begin{align}
\overline{H_N}=\sum_{pq} \overline{H}^p_q a^\dagger_q a_p + {1\over 4} \sum_{pqrs} \overline{H}^{pq}_{rs} a^\dagger_p a^\dagger_q a_s a_r + \ldots
\tag{25}
\end{align}
$$
<p>&nbsp;<br>

<p>with</p>
<p>&nbsp;<br>
$$
\begin{align}
\overline{H}^p_q &\equiv \langle p\vert \overline{H_N}\vert q\rangle , 
\tag{26}\\
\overline{H}^{pq}_{rs} &\equiv \langle pq\vert \overline{H_N}\vert rs\rangle .
\tag{27}
\end{align}
$$
<p>&nbsp;<br>

<p>Thus, the CCSD Eqs.&nbsp;<a href="#mjx-eqn-19">(19)</a> for the amplitudes can be written as
\( \overline{H}_i^a = 0 \) and \( \overline{H}_{ij}^{ab}=0 \).
</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin answer of exercise --- -->
<p>
<b>Answer.</b>
CCSD truncates for two-body operators at four-fold nested commutators,
because each of the four annihilation and creation operators in
\( \overline{H_N} \) can be knocked out with one term of \( T \).
</p>

<!-- --- end answer of exercise --- -->

<!-- --- end exercise --- -->

<!-- --- begin exercise --- -->
<h2 id="ex-8">Exercise 8: Compute the matrix element \( \overline{H}_{ab}^{ij}\equiv \langle ij\vert \overline{H_N}\vert ab\rangle \)</h2>
</div>

<p>We need to work out the similarity-transformed Hamiltonian of
Eq. <a href="#mjx-eqn-23">(23)</a>. To do this, we write \( T=T_1 +T_2 \) and \( H_N= F +V \),
where \( T_1 \) and \( F \) are one-body operators, and \( T_2 \) and \( V \) are
two-body operators.
</p>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- --- begin answer of exercise --- -->
<p>
<b>Answer.</b>
This is a simple task. This matrix element is part of the operator
\( \overline{H}_{ab}^{ij}a^\dagger_ia^\dagger_ja_ba_a \), i.e. particles
are annihilated and holes are created. Thus, no contraction of the
Hamiltonian \( H \) with any cluster operator \( T \) (remember that \( T \)
annihilates holes and creates particles) can happen, and we simply
have \( \overline{H}_{ab}^{ij} = \langle ij\vert V\vert ab\rangle \).
</p>

<!-- --- end answer of exercise --- -->

<!-- --- end exercise --- -->
<h2 id="ex-9">Example: The contribution of \( [F, T_2] \) to \( \overline{H_N} \)</h2>

<p>The commutator \( [F, T_2] \) consists of two-body and one-body terms. Let
us compute first the two-body term, as it results from a single
contraction (i.e. a single application of \( [a_p, a^\dagger_q] =
\delta_p^q \)). We denote this as \( [F, T_2]_{2b} \) and find
</p>

<p>&nbsp;<br>
$$
\begin{align*}
[F, T_2]_{2b} &= \frac{1}{4}\sum_{pq}\sum_{rsuv} f_p^q t_{ij}^{ab}\left[a^\dagger_q a_p, a^\dagger_a a^\dagger_b a_j a_i \right]_{2b} \\
&= \frac{1}{4}\sum_{pq}\sum_{abij} f_p^q t_{ij}^{ab}\delta_p^a a^\dagger_q a^\dagger_b a_j a_i  \\
&- \frac{1}{4}\sum_{pq}\sum_{abij} f_p^q t_{ij}^{ab}\delta_p^b a^\dagger_q a^\dagger_a a_j a_i  \\
&- \frac{1}{4}\sum_{pq}\sum_{abij} f_p^q t_{ij}^{ab}\delta_q^j a^\dagger_a a^\dagger_b a_p a_i  \\
&+ \frac{1}{4}\sum_{pq}\sum_{abij} f_p^q t_{ij}^{ab}\delta_q^i a^\dagger_a a^\dagger_b a_p a_j  \\
&= \frac{1}{4}\sum_{qbij}\left(\sum_{a} f_a^q t_{ij}^{ab}\right)a^\dagger_q a^\dagger_b a_j a_i  \\
&- \frac{1}{4}\sum_{qaij}\left(\sum_{b} f_b^q t_{ij}^{ab}\right)a^\dagger_q a^\dagger_a a_j a_i  \\
&- \frac{1}{4}\sum_{pabi}\left(\sum_{j} f_p^j t_{ij}^{ab}\right)a^\dagger_a a^\dagger_b a_p a_i  \\
&+ \frac{1}{4}\sum_{pabj}\left(\sum_{i} f_p^i t_{ij}^{ab}\right)a^\dagger_a a^\dagger_b a_p a_j  \\
&= \frac{1}{2}\sum_{qbij}\left(\sum_{a} f_a^q t_{ij}^{ab}\right)a^\dagger_q a^\dagger_b a_j a_i  \\
&- \frac{1}{2}\sum_{pabi}\left(\sum_{j} f_p^j t_{ij}^{ab}\right)a^\dagger_a a^\dagger_b a_p a_i  .
\end{align*}
$$
<p>&nbsp;<br>

<p>Here we exploited the antisymmetry \( t_{ij}^{ab} = -t_{ji}^{ab} =
-t_{ij}^{ba} = t_{ji}^{ba} \) in the last step. Using \( a^\dagger_q a^\dagger_b a_j a_i = -a^\dagger_b a^\dagger_q a_j a_i  \) and \( a^\dagger_a a^\dagger_b a_p a_i = a^\dagger_a a^\dagger_b a_i a_p \), we can make the expression 
manifest antisymmetric, i.e.
</p>

<p>&nbsp;<br>
$$
\begin{align*}
[F, T_2]_{2b}
&= \frac{1}{4}\sum_{qbij}\left[\sum_{a} \left(f_a^q t_{ij}^{ab}-f_a^b t_{ij}^{qa}\right)\right]a^\dagger_q a^\dagger_b a_j a_i  \\
&- \frac{1}{4}\sum_{pabi}\left[\sum_{j} \left(f_p^j t_{ij}^{ab}-f_i^j t_{pj}^{ab}\right)\right]a^\dagger_a a^\dagger_b a_p a_i  .
\end{align*}
$$
<p>&nbsp;<br>

<p>Thus, the contribution of \( [F, T_2]_{2b} \) to the matrix element \( \overline{H}_{ij}^{ab} \) is  </p>
<p>&nbsp;<br>
$$
\begin{align*}
\overline{H}_{ij}^{ab} \leftarrow  \sum_{c} \left(f_c^a t_{ij}^{cb}-f_c^b t_{ij}^{ac}\right) - \sum_{k} \left(f_j^k t_{ik}^{ab}-f_i^k t_{jk}^{ab}\right)
\end{align*}
$$
<p>&nbsp;<br>

<p>Here we used an arrow to indicate that this is just one contribution
to this matrix element.  We see that the derivation straight forward,
but somewhat tedious. As no one likes to commute too much (neither in
this example nor when going to and from work), and so we need a better
approach. This is where diagramms come in handy.
</p>
</div>
</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

  // Display navigation controls in the bottom right corner
  controls: true,

  // Display progress bar (below the horiz. slider)
  progress: true,

  // Display the page number of the current slide
  slideNumber: true,

  // Push each slide change to the browser history
  history: false,

  // Enable keyboard shortcuts for navigation
  keyboard: true,

  // Enable the slide overview mode
  overview: true,

  // Vertical centering of slides
  //center: true,
  center: false,

  // Enables touch navigation on devices with touch input
  touch: true,

  // Loop the presentation
  loop: false,

  // Change the presentation direction to be RTL
  rtl: false,

  // Turns fragments on and off globally
  fragments: true,

  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,

  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,

  // Stop auto-sliding after user input
  autoSlideStoppable: true,

  // Enable slide navigation via mouse wheel
  mouseWheel: false,

  // Hides the address bar on mobile devices
  hideAddressBar: true,

  // Opens links in an iframe preview overlay
  previewLinks: false,

  // Transition style
  transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

  // Transition speed
  transitionSpeed: 'default', // default/fast/slow

  // Transition style for full page slide backgrounds
  backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

  // Number of slides away from the current that are visible
  viewDistance: 3,

  // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

  // Parallax background size
  //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

  theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
  dependencies: [
      // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

      // Interpret Markdown in <section> elements
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

      // Syntax highlight for <code> elements
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

      // Zoom in and out with Alt+click
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

      // Speaker notes
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

      // Remote control your reveal.js presentation using a touch device
      //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

      // MathJax
      //{ src: 'reveal.js/plugin/math/math.js', async: true }
  ]
});

Reveal.initialize({

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1170,  // original: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
   end footer logo -->




</body>
</html>
