<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week42-reveal.html week42-reveal reveal --html_slide_theme=beige
-->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Week 42: Hartree-Fock theory and density functional theory">
<title>Week 42: Hartree-Fock theory and density functional theory</title>

<!-- reveal.js: https://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/league.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- Printing and PDF exports -->
<script>
var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
document.getElementsByTagName( 'head' )[0].appendChild( link );
</script>

<style type="text/css">
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.reveal .alert-text-small   { font-size: 80%;  }
.reveal .alert-text-large   { font-size: 130%; }
.reveal .alert-text-normal  { font-size: 90%;  }
.reveal .alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:5px solid #bababa;
  -webkit-border-radius: 14px; -moz-border-radius: 14px;
  border-radius:14px;
  background-position: 10px 10px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 30px; /* 55px; if icon */
}
.reveal .alert-block {padding-top:14px; padding-bottom:14px}
.reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
/*.reveal .alert li {margin-top: 1em}*/
.reveal .alert-block p+p {margin-top:5px}
/*.reveal .alert-notice { background-image: url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
.reveal .alert-summary  { background-image:url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
.reveal .alert-warning { background-image: url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
.reveal .alert-question {background-image:url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */
/* Override reveal.js table border */
.reveal table td {
  border: 0;
}

<style type="text/css">
/* Override h1, h2, ... styles */
h1 { font-size: 2.8em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.4em; }
h4 { font-size: 1.3em; }
h1, h2, h3, h4 { font-weight: bold; line-height: 1.2; }
body { overflow: auto; } /* vertical scrolling */
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.slide .alert-text-small   { font-size: 80%;  }
.slide .alert-text-large   { font-size: 130%; }
.slide .alert-text-normal  { font-size: 90%;  }
.slide .alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:5px solid #bababa;
    -webkit-border-radius:14px; -moz-border-radius:14px;
  border-radius:14px
  background-position: 10px 10px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 30px; /* 55px; if icon */
}
.slide .alert-block {padding-top:14px; padding-bottom:14px}
.slide .alert-block > p, .alert-block > ul {margin-bottom:0}
/*.slide .alert li {margin-top: 1em}*/
.deck .alert-block p+p {margin-top:5px}
/*.slide .alert-notice { background-image: url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_notice.png); }
.slide .alert-summary  { background-image:url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_summary.png); }
.slide .alert-warning { background-image: url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_warning.png); }
.slide .alert-question {background-image:url(https://hplgit.github.io/doconce/
bundled/html_images/small_gray_question.png); } */
.dotable table, .dotable th, .dotable tr, .dotable tr td {
  border: 2px solid black;
  border-collapse: collapse;
  padding: 2px;
}
</style>


<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>


<body>
<div class="reveal">
<div class="slides">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




<section>
<!-- ------------------- main content ---------------------- -->
<center>
<h1 style="text-align: center;">Week 42: Hartree-Fock theory and density functional theory</h1>
</center>  <!-- document title -->

<!-- author(s): Morten Hjorth-Jensen -->
<center>
<b>Morten Hjorth-Jensen</b> 
</center>
<!-- institution -->
<center>
<b>Department of Physics and Center for Computing in Science Education, University of Oslo, Norway</b>
</center>
<br>
<center>
<h4>October 14-18</h4>
</center> <!-- date -->
<br>

<!-- todo: add material about the calculation of the HEG -->


<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2024, Morten Hjorth-Jensen. Released under CC Attribution-NonCommercial 4.0 license
</center>
</section>

<section>
<h2 id="week-42-october-14-18-2024">Week 42, October 14-18, 2024 </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Topics to be covered</b>
<p>
<ol>
<p><li> Thursday:</li>
<ul>

<p><li> The first lecture is about the finalization of the calculation of the ground state energy of the homogeneous electron gas in three dimensions</li>

<p><li> Start discussion of density functional theory</li>

<p><li> Discussions of first midterm</li>

<p><li> Video of lecture at <a href="https://youtu.be/VbLlyZYRnYg" target="_blank"><tt>https://youtu.be/VbLlyZYRnYg</tt></a></li>

<p><li> Whiteboard notes at <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/HandwrittenNotes/2024/NotesOctober17.pdf" target="_blank"><tt>https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/HandwrittenNotes/2024/NotesOctober17.pdf</tt></a></li>  
</ul>
<p>
<p><li> Friday:</li>
<ul>

<p><li> Density functional theory</li>

<p><li> Discussions of  first midterm</li>
</ul>
<p>
<p><li> Lecture Material: These slides and handwritten notes</li>
<p><li> First midterm set at <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/Exercises/2024/FirstMidterm2024.pdf" target="_blank"><tt>https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/Exercises/2024/FirstMidterm2024.pdf</tt></a></li>
</ol>
</div>
</section>

<section>
<h2 id="hartree-fock-ground-state-energy-for-the-electron-gas-in-three-dimensions">Hartree-Fock ground state energy for the  electron gas in three dimensions </h2>

<p>We consider a system of electrons in infinite matter, the so-called electron gas. This is a homogeneous system and the one-particle states are given by plane wave function normalized to a volume \( V \) 
for a box with length \( L \) (the limit \( L\rightarrow \infty \) is to be taken after we have computed various expectation values)
</p>
<p>&nbsp;<br>
$$
\psi_{\mathbf{k}\sigma}(\mathbf{r})= \frac{1}{\sqrt{V}}\exp{(i\mathbf{kr})}\xi_{\sigma}
$$
<p>&nbsp;<br>

<p>where \( \mathbf{k} \) is the wave number and  \( \xi_{\sigma} \) is a spin function for either spin up or down</p>
<p>&nbsp;<br>
$$ 
\xi_{\sigma=+1/2}=\left(\begin{array}{c} 1 \\ 0 \end{array}\right) \hspace{0.5cm}
\xi_{\sigma=-1/2}=\left(\begin{array}{c} 0 \\ 1 \end{array}\right).
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="periodic-boundary-conditions">Periodic boundary conditions   </h2>

<p>We assume that we have periodic boundary conditions which limit the allowed wave numbers to</p>
<p>&nbsp;<br>
$$
k_i=\frac{2\pi n_i}{L}\hspace{0.5cm} i=x,y,z \hspace{0.5cm} n_i=0,\pm 1,\pm 2, \dots
$$
<p>&nbsp;<br>

<p>We assume first that the particles interact via a central, symmetric and translationally invariant
interaction  \( V(r_{12}) \) with
\( r_{12}=|\mathbf{r}_1-\mathbf{r}_2| \).  The interaction is spin independent.
</p>
</section>

<section>
<h2 id="total-hamiltonian">Total Hamiltonian  </h2>

<p>The total Hamiltonian consists then of kinetic and potential energy</p>
<p>&nbsp;<br>
$$
\hat{H} = \hat{T}+\hat{V}.
$$
<p>&nbsp;<br>

<p>The operator for the kinetic energy is given by</p>
<p>&nbsp;<br>
$$
\hat{T}=\sum_{\mathbf{k}\sigma}\frac{\hbar^2k^2}{2m}a_{\mathbf{k}\sigma}^{\dagger}a_{\mathbf{k}\sigma}.
$$
<p>&nbsp;<br>
</section>

<section>

<!-- --- begin exercise --- -->
<h2 id="exercise-1-express-interaction-using-creation-and-annihilation-operators">Exercise 1: Express interaction using creation and annihilation operators </h2>

<p>Find the expression for the interaction
\( \hat{V} \) expressed with creation and annihilation operators.
</p>

<p>The expression for the interaction
has to be written in  \( k \) space, even though \( V \) depends only on the relative distance. It means that you need to set up the Fourier transform \( \langle \mathbf{k}_i\mathbf{k}_j| V | \mathbf{k}_m\mathbf{k}_n\rangle \).
</p>

<p>A general two-body interaction element is given by (not using anti-symmetrized matrix elements)</p>
<p>&nbsp;<br>
$$ 
\hat{V} = \frac{1}{2} \sum_{pqrs} \langle pq \hat{v} \vert rs\rangle a_p^\dagger a_q^\dagger a_s a_r ,  
$$
<p>&nbsp;<br>

<p>where \( \hat{v} \) is assumed to depend only on the relative distance between two interacting particles, that is
\( \hat{v} = v(\vec r_1, \vec r_2) = v(|\vec r_1 - \vec r_2|) = v(r) \), with \( r = |\vec r_1 - \vec r_2| \)).
</p>

<!-- --- end exercise --- -->
</section>

<section>
<h2 id="with-spin-degrees-of-freedom">With spin degrees of freedom  </h2>

<p>In our case we have, writing out explicitely the spin degrees of freedom as well</p>
<p>&nbsp;<br>
$$
\begin{equation}
\hat{V} = \frac{1}{2} \sum_{\substack{\sigma_p \sigma_q \\ \sigma_r \sigma_s}}
\sum_{\substack{\mathbf{k}_p \mathbf{k}_q \\ \mathbf{k}_r \mathbf{k}_s}}
\langle \mathbf{k}_p \sigma_p, \mathbf{k}_q \sigma_2\vert v \vert \mathbf{k}_r \sigma_3, \mathbf{k}_s \sigma_s\rangle
a_{\mathbf{k}_p \sigma_p}^\dagger a_{\mathbf{k}_q \sigma_q}^\dagger a_{\mathbf{k}_s \sigma_s} a_{\mathbf{k}_r \sigma_r} .
\tag{1}
\end{equation}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="plane-waves">Plane waves  </h2>

<p>Inserting plane waves as eigenstates we can rewrite the matrix element as</p>
<p>&nbsp;<br>
$$ 
\langle \mathbf{k}_p \sigma_p, \mathbf{k}_q \sigma_q\vert \hat{v} \vert \mathbf{k}_r \sigma_r, \mathbf{k}_s \sigma_s\rangle =
\frac{1}{V^2} \delta_{\sigma_p \sigma_r} \delta_{\sigma_q \sigma_s}
\int\int \exp{-i(\mathbf{k}_p \cdot \mathbf{r}_p)} \exp{-i( \mathbf{k}_q \cdot \mathbf{r}_q)} \hat{v}(r) \exp{i(\mathbf{k}_r \cdot \mathbf{r}_p)} \exp{i( \mathbf{k}_s \cdot \mathbf{r}_q)} d\mathbf{r}_p d\mathbf{r}_q , $$
<p>&nbsp;<br>

<p>where we have used the orthogonality properties of the spin functions. We change now the variables of integration
by defining \( \mathbf{r} = \mathbf{r}_p - \mathbf{r}_q \), which gives \( \mathbf{r}_p = \mathbf{r} + \mathbf{r}_q \) and \( d^3 \mathbf{r} = d^3 \mathbf{r}_p \).
</p>
</section>

<section>
<h2 id="integration-limits">Integration limits  </h2>

<p>The limits are not changed since they are from \( -\infty \) to  \( \infty \) for all integrals. This results in</p>
<p>&nbsp;<br>
$$
\begin{align*}
\langle \mathbf{k}_p \sigma_p, \mathbf{k}_q \sigma_q\vert \hat{v} \vert \mathbf{k}_r \sigma_r, \mathbf{k}_s \sigma_s\rangle
&= \frac{1}{V^2} \delta_{\sigma_p \sigma_r} \delta_{\sigma_q \sigma_s} \int\exp{i (\mathbf{k}_s - \mathbf{k}_q) \cdot \mathbf{r}_q} \int v(r) \exp{i(\mathbf{k}_r - \mathbf{k}_p) \cdot ( \mathbf{r} + \mathbf{r}_q)} d\mathbf{r} d\mathbf{r}_q \\
&= \frac{1}{V^2} \delta_{\sigma_p \sigma_r} \delta_{\sigma_q \sigma_s} \int v(r) \exp{i\left[(\mathbf{k}_r - \mathbf{k}_p) \cdot \mathbf{r}\right]}
\int \exp{i\left[(\mathbf{k}_s - \mathbf{k}_q + \mathbf{k}_r - \mathbf{k}_p) \cdot \mathbf{r}_q\right]} d\mathbf{r}_q d\mathbf{r} .
\end{align*}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="recognizing-integral">Recognizing integral  </h2>

<p>We recognize the integral over \( \mathbf{r}_q \) as a \( \delta \)-function, resulting in</p>
<p>&nbsp;<br>
$$ \langle \mathbf{k}_p \sigma_p, \mathbf{k}_q \sigma_q\vert \hat{v} \vert \mathbf{k}_r \sigma_r, \mathbf{k}_s \sigma_s\rangle =
\frac{1}{V} \delta_{\sigma_p \sigma_r} \delta_{\sigma_q \sigma_s} \delta_{(\mathbf{k}_p + \mathbf{k}_q),(\mathbf{k}_r + \mathbf{k}_s)} \int v(r) \exp{i\left[(\mathbf{k}_r - \mathbf{k}_p) \cdot \mathbf{r}\right]} d^3r . $$
<p>&nbsp;<br>

<p>For this equation to be different from zero, we must have conservation of momenta, we need to satisfy
\( \mathbf{k}_p + \mathbf{k}_q = \mathbf{k}_r + \mathbf{k}_s \).
</p>
</section>

<section>
<h2 id="conservation-of-momentum">Conservation of momentum  </h2>

<p>We can use the conservation of momenta to remove one of the summation variables resulting in</p>
<p>&nbsp;<br>
$$ \hat{V} =
\frac{1}{2V} \sum_{\sigma \sigma'} \sum_{\mathbf{k}_p \mathbf{k}_q \mathbf{k}_r} \left[ \int v(r) \exp{i\left[(\mathbf{k}_r - \mathbf{k}_p) \cdot \mathbf{r}\right]} d^3r \right]
a_{\mathbf{k}_p \sigma}^\dagger a_{\mathbf{k}_q \sigma'}^\dagger a_{\mathbf{k}_p + \mathbf{k}_q - \mathbf{k}_r, \sigma'} a_{\mathbf{k}_r \sigma}, $$
<p>&nbsp;<br>

<p>which can be rewritten as </p>
<p>&nbsp;<br>
$$
\begin{equation}
\hat{V} =
\frac{1}{2V} \sum_{\sigma \sigma'} \sum_{\mathbf{k} \mathbf{p} \mathbf{q}} \left[ \int v(r) \exp{-i( \mathbf{q} \cdot \mathbf{r})} d\mathbf{r} \right]
a_{\mathbf{k} + \mathbf{q}, \sigma}^\dagger a_{\mathbf{p} - \mathbf{q}, \sigma'}^\dagger a_{\mathbf{p} \sigma'} a_{\mathbf{k} \sigma},
\tag{2}
\end{equation}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="some-definitions">Some definitions  </h2>

<p>In the last equation we defined
the quantities
\( \mathbf{p} = \mathbf{k}_p + \mathbf{k}_q - \mathbf{k}_r \), \( \mathbf{k} = \mathbf{k}_r \) og \( \mathbf{q} = \mathbf{k}_p - \mathbf{k}_r \).
</p>
</section>

<section>
<h2 id="reference-energy">Reference energy  </h2>

<p>Let us now compute the expectation value of the reference energy using the expressions for the kinetic energy operator and the interaction.
We need to compute \( \langle \Phi_0\vert \hat{H} \vert \Phi_0\rangle = \langle \Phi_0\vert \hat{T} \vert \Phi_0\rangle + \langle \Phi_0\vert \hat{V} \vert \Phi_0\rangle \), where \( \vert \Phi_0\rangle \) is our reference Slater determinant, constructed from filling all single-particle states up to the Fermi level.
Let us start with the kinetic energy first
</p>
<p>&nbsp;<br>
$$ \langle \Phi_0\vert \hat{T} \vert \Phi_0\rangle 
= \langle \Phi_0\vert \left( \sum_{\mathbf{p} \sigma} \frac{\hbar^2 p^2}{2m} a_{\mathbf{p} \sigma}^\dagger a_{\mathbf{p} \sigma} \right) \vert \Phi_0\rangle
= \sum_{\mathbf{p} \sigma} \frac{\hbar^2 p^2}{2m} \langle \Phi_0\vert a_{\mathbf{p} \sigma}^\dagger a_{\mathbf{p} \sigma} \vert \Phi_0\rangle . $$
<p>&nbsp;<br>
</section>

<section>
<h2 id="kinetic-energy">Kinetic  energy  </h2>

<p>From the possible contractions using Wick's theorem, it is straightforward to convince oneself that the expression for the kinetic energy becomes</p>
<p>&nbsp;<br>
$$ \langle \Phi_0\vert \hat{T} \vert \Phi_0\rangle = \sum_{\mathbf{i} \leq F} \frac{\hbar^2 k_i^2}{m} = \frac{V}{(2\pi)^3} \frac{\hbar^2}{m} \int_0^{k_F} k^2 d\mathbf{k}.
$$
<p>&nbsp;<br>

<p>The sum of the spin degrees of freedom results in  a factor of two only if we deal with identical spin \( 1/2 \) fermions. 
Changing to spherical coordinates, the integral over the momenta \( k \) results in the final expression
</p>
<p>&nbsp;<br>
$$ \langle \Phi_0\vert \hat{T} \vert \Phi_0\rangle = \frac{V}{(2\pi)^3} \left( 4\pi \int_0^{k_F} k^4 d\mathbf{k} \right) = \frac{4\pi V}{(2\pi)^3} \frac{1}{5} k_F^5 = \frac{4\pi V}{5(2\pi)^3} k_F^5 = \frac{\hbar^2 V}{10\pi^2 m} k_F^5 . $$
<p>&nbsp;<br>
</section>

<section>
<h2 id="density-of-states">Density of states  </h2>

<p>The density of states in momentum space is given by \( 2V/(2\pi)^3 \), where we have included the degeneracy due to the spin degrees of freedom.
The volume is given by  \( 4\pi k_F^3/3 \), and the number of particles becomes
</p>
<p>&nbsp;<br>
$$ N = \frac{2V}{(2\pi)^3} \frac{4}{3} \pi k_F^3 = \frac{V}{3\pi^2} k_F^3 \quad \Rightarrow \quad
k_F = \left( \frac{3\pi^2 N}{V} \right)^{1/3}. $$
<p>&nbsp;<br>

<p>This gives us</p>
<p>&nbsp;<br>
$$
\begin{equation}
\langle \Phi_0\vert \hat{T} \vert \Phi_0\rangle =
\frac{\hbar^2 V}{10\pi^2 m} \left( \frac{3\pi^2 N}{V} \right)^{5/3} =
\frac{\hbar^2 (3\pi^2)^{5/3} N}{10\pi^2 m} \rho^{2/3} ,
\tag{3}
\end{equation}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="potential-energy">Potential energy  </h2>

<p>We are now ready to calculate the expectation value of the potential energy</p>
<p>&nbsp;<br>
$$
\begin{align*}
\langle \Phi_0\vert \hat{V} \vert \Phi_0\rangle 
&= \langle \Phi_0\vert \left( \frac{1}{2V} \sum_{\sigma \sigma'} \sum_{\mathbf{k} \mathbf{p} \mathbf{q} } \left[ \int v(r) \exp{-i (\mathbf{q} \cdot \mathbf{r})} d\mathbf{r} \right] a_{\mathbf{k} + \mathbf{q}, \sigma}^\dagger a_{\mathbf{p} - \mathbf{q}, \sigma'}^\dagger a_{\mathbf{p} \sigma'} a_{\mathbf{k} \sigma} \right) \vert \Phi_0\rangle \\
&= \frac{1}{2V} \sum_{\sigma \sigma'} \sum_{\mathbf{k} \mathbf{p} \mathbf{q}} \left[ \int v(r) \exp{-i (\mathbf{q} \cdot \mathbf{r})} d\mathbf{r} \right]\langle \Phi_0\vert a_{\mathbf{k} + \mathbf{q}, \sigma}^\dagger a_{\mathbf{p} - \mathbf{q}, \sigma'}^\dagger a_{\mathbf{p} \sigma'} a_{\mathbf{k} \sigma} \vert \Phi_0\rangle .
\end{align*}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="non-zero-term">Non-zero term  </h2>

<p>The only contractions which result in non-zero results are those that involve states below the Fermi level, that is 
\( k \leq k_F \), \( p \leq k_F \), \( |\mathbf{p} - \mathbf{q}| < \mathbf{k}_F \) and \( |\mathbf{k} + \mathbf{q}| \leq k_F \). Due to momentum conservation we must also have \( \mathbf{k} + \mathbf{q} = \mathbf{p} \), \( \mathbf{p} - \mathbf{q} = \mathbf{k} \) and  \( \sigma = \sigma' \) or  \( \mathbf{k} + \mathbf{q} = \mathbf{k} \) and \( \mathbf{p} - \mathbf{q} = \mathbf{p} \). 
Summarizing, we must have
</p>
<p>&nbsp;<br>
$$ \mathbf{k} + \mathbf{q} = \mathbf{p} \quad \text{and} \quad \sigma = \sigma', \qquad
\text{or} \qquad
\mathbf{q} = \mathbf{0} . $$
<p>&nbsp;<br>
</section>

<section>
<h2 id="direct-and-exchange-terms">Direct and exchange terms  </h2>

<p>We obtain then</p>
<p>&nbsp;<br>
$$ \langle \Phi_0\vert \hat{V} \vert \Phi_0\rangle =
\frac{1}{2V} \left( \sum_{\sigma \sigma'} \sum_{\mathbf{q} \mathbf{p} \leq F} \left[ \int v(r) d\mathbf{r} \right] - \sum_{\sigma}
\sum_{\mathbf{q} \mathbf{p} \leq F} \left[ \int v(r) \exp{-i (\mathbf{q} \cdot \mathbf{r})} d\mathbf{r} \right] \right). $$
<p>&nbsp;<br>

<p>The first term is the so-called direct term while the second term is the exchange term. </p>
</section>

<section>
<h2 id="potential-energy">Potential energy  </h2>

<p>We can rewrite this equation as (and this applies to any potential which depends only on the relative distance between particles)</p>
<p>&nbsp;<br>
$$
\begin{equation}
\langle \Phi_0\vert \hat{V} \vert \Phi_0\rangle =
\frac{1}{2V} \left( N^2 \left[ \int v(r) d\mathbf{r} \right] - N \sum_{\mathbf{q}} \left[ \int v(r) \exp{-i (\mathbf{q}\cdot \mathbf{r})} d\mathbf{r} \right] \right),
\tag{4}
\end{equation}
$$
<p>&nbsp;<br>

<p>where we have used the fact that a sum like \( \sum_{\sigma}\sum_{\mathbf{k}} \) equals the number of particles. Using the fact that the density is given by
\( \rho = N/V \), with \( V \) being our volume, we can rewrite the last equation as
</p>
<p>&nbsp;<br>
$$
\langle \Phi_0\vert \hat{V} \vert \Phi_0\rangle =
\frac{1}{2} \left( \rho N \left[ \int v(r) d\mathbf{r} \right] - \rho\sum_{\mathbf{q}} \left[ \int v(r) \exp{-i (\mathbf{q}\cdot \mathbf{r})} d\mathbf{r} \right] \right).
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="interaction-part">Interaction part  </h2>

<p>For the electron gas
the interaction part of the Hamiltonian operator is given by
</p>
<p>&nbsp;<br>
$$
\hat{H}_I=\hat{H}_{el}+\hat{H}_{b}+\hat{H}_{el-b},
$$
<p>&nbsp;<br>

<p>with the electronic part</p>
<p>&nbsp;<br>
$$
\hat{H}_{el}=\sum_{i=1}^N\frac{p_i^2}{2m}+\frac{e^2}{2}\sum_{i\ne j}\frac{e^{-\mu |\mathbf{r}_i-\mathbf{r}_j|}}{|\mathbf{r}_i-\mathbf{r}_j|},
$$
<p>&nbsp;<br>

<p>where we have introduced an explicit convergence factor
(the limit \( \mu\rightarrow 0 \) is performed after having calculated the various integrals).
</p>
</section>

<section>
<h2 id="positive-background">Positive background  </h2>

<p>Correspondingly, we have</p>
<p>&nbsp;<br>
$$
\hat{H}_{b}=\frac{e^2}{2}\int\int d\mathbf{r}d\mathbf{r}'\frac{n(\mathbf{r})n(\mathbf{r}')e^{-\mu |\mathbf{r}-\mathbf{r}'|}}{|\mathbf{r}-\mathbf{r}'|},
$$
<p>&nbsp;<br>

<p>which is the energy contribution from the positive background charge with density
\( n(\mathbf{r})=N/V \). Finally,
</p>
<p>&nbsp;<br>
$$
\hat{H}_{el-b}=-\frac{e^2}{2}\sum_{i=1}^N\int d\mathbf{r}\frac{n(\mathbf{r})e^{-\mu |\mathbf{r}-\mathbf{x}_i|}}{|\mathbf{r}-\mathbf{x}_i|},
$$
<p>&nbsp;<br>

<p>is the interaction between the electrons and the positive background.</p>
</section>

<section>
<h2 id="positive-charge-contribution">Positive charge contribution  </h2>

<p>We can show that</p>
<p>&nbsp;<br>
$$
\hat{H}_{b}=\frac{e^2}{2}\frac{N^2}{V}\frac{4\pi}{\mu^2},
$$
<p>&nbsp;<br>

<p>and</p>
<p>&nbsp;<br>
$$
\hat{H}_{el-b}=-e^2\frac{N^2}{V}\frac{4\pi}{\mu^2}.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="thermodynamic-limit">Thermodynamic limit  </h2>

<p>For the electron gas and a Coulomb interaction, these two terms are cancelled (in the thermodynamic limit) by the contribution from the direct term arising
from the repulsive electron-electron interaction. What remains then  when computing the reference energy is only the kinetic energy contribution and the contribution from the exchange term.  For other interactions, like nuclear forces with a short range part and no infinite range, we need to compute both the direct term and the exchange term. 
</p>

<p>We can show that the final Hamiltonian can be written as </p>
<p>&nbsp;<br>
$$
H=H_{0}+H_{I},
$$
<p>&nbsp;<br>

<p>with</p>
<p>&nbsp;<br>
$$
H_{0}={\displaystyle\sum_{\mathbf{k}\sigma}}
\frac{\hbar^{2}k^{2}}{2m}a_{\mathbf{k}\sigma}^{\dagger}
a_{\mathbf{k}\sigma},
$$
<p>&nbsp;<br>

<p>and</p>
<p>&nbsp;<br>
$$
H_{I}=\frac{e^{2}}{2V}{\displaystyle\sum_{\sigma_{1}\sigma_{2}}}{\displaystyle\sum_{\mathbf{q}\neq 0,\mathbf{k},\mathbf{p}}}\frac{4\pi}{q^{2}}
a_{\mathbf{k}+\mathbf{q},\sigma_{1}}^{\dagger}
a_{\mathbf{p}-\mathbf{q},\sigma_{2}}^{\dagger}
a_{\mathbf{p}\sigma_{2}}a_{\mathbf{k}\sigma_{1}}.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="ground-state-energy">Ground state energy </h2>
<p>Calculate \( E_0/N=\langle \Phi_{0}\vert H\vert \Phi_{0}\rangle/N \) for for this system to first order in the interaction. Show that, by using</p>
<p>&nbsp;<br>
$$
\rho= \frac{k_F^3}{3\pi^2}=\frac{3}{4\pi r_0^3},
$$
<p>&nbsp;<br>

<p>with \( \rho=N/V \), \( r_0 \)
being the radius of a sphere representing the volume an electron occupies 
and the Bohr radius \( a_0=\hbar^2/e^2m \), 
that the energy per electron can be written as 
</p>
<p>&nbsp;<br>
$$
E_0/N=\frac{e^2}{2a_0}\left[\frac{2.21}{r_s^2}-\frac{0.916}{r_s}\right].
$$
<p>&nbsp;<br>

<p>Here we have defined
\( r_s=r_0/a_0 \) to be a dimensionless quantity.
</p>
</section>

<section>

<!-- --- begin exercise --- -->
<h2 id="exercise-2-plot-of-energy">Exercise 2: plot of energy </h2>

<p>Plot the energy as function of \( r_s \). Why is this system stable?
Calculate thermodynamical quantities like the pressure, given by
</p>
<p>&nbsp;<br>
$$
P=-\left(\frac{\partial E}{\partial V}\right)_N,
$$
<p>&nbsp;<br>

<p>and the bulk modulus</p>
<p>&nbsp;<br>
$$
B=-V\left(\frac{\partial P}{\partial V}\right)_N,
$$
<p>&nbsp;<br>

<p>and comment your results.</p>

<!-- --- end exercise --- -->
</section>

<section>
<h2 id="density-functional-theory">Density functional theory </h2>

<p>Hohenberg and Kohn proved that the total energy of a system including
that of the many-body effects of electrons (exchange and correlation)
in the presence of static external potential (for example, the atomic
nuclei) is a unique functional of the charge density. The minimum
value of the total energy functional is the ground state energy of the
system. The electronic charge density which yields this minimum is
then the exact single particle ground state energy.
</p>
</section>

<section>
<h2 id="functional-of-density">Functional of density  </h2>

<p>The electronic energy \( E \) is said to be a functional of the
electronic density, \( E[\rho] \), in the sense that for a given function
\( \rho(r) \), there is a single corresponding energy. The
Hohenberg-Kohn theorems (two) confirms that such a functional exists,
but does not tell us the form of the functional.
</p>
</section>

<section>
<h2 id="the-many-particle-equation">The many-particle equation </h2>

<p>Any material on earth, whether in crystals, amorphous solids,
molecules or yourself, consists of nothing else than a bunch of atoms,
ions and electrons bound together by electric forces. All these
possible forms of matter can be explained by virtue of one simple
equation: the many-particle Schr\"{o}dinger equation,
</p>

<p>&nbsp;<br>
$$
\begin{equation}
	i \hbar \frac{\partial}{\partial t} \Phi( \boldsymbol{r} ; t) = 
	\left( - \sum_{i}^N \frac{\hbar^2}{2m_i} \frac{\partial^2}{\partial \boldsymbol{r}_i^2}
	+ \sum_{i < j}^N \frac{e^2 Z_i Z_j }{ | \boldsymbol{r}_i - \boldsymbol{r}_j| } \right)  \Phi( \boldsymbol{r} ; t).
\tag{5}
\end{equation}
$$
<p>&nbsp;<br>

<p>Here \( \Phi(\boldsymbol{r} ; t) \) is the many-body wavefunction for \( N \) particles, where each particle has its own mass \( m_i \), charge \( Z_i \) and position \( \boldsymbol{r}_i \). The only interaction is the Coulomb interaction \( e^2/r \). </p>

<p>Despite its apparent simplicity, the above equation  is
notoriously difficult to solve. This is where density functional
theory (DFT) comes in. Using a set of reasonable physical
approximations we can simplify the many-particle Schr\"{o}dinger
equation to something that we can actually solve numerically.
</p>
</section>

<section>
<h2 id="born-oppenheimer-approximation">Born-Oppenheimer approximation </h2>

<p>The first approximation arises from the physical problem we want to
study: the ground state of a collection of interacting ions and
electrons. Because even the lightest ion is more than a thousand times
heavier than an electron, we will forget about the dynamics of the
ions all-together. This is known as the <b>Born-Oppenheimer</b>
approximation.
</p>
</section>

<section>
<h2 id="time-independent-equation">Time-independent equation </h2>

<p>We then write the time-independent Schr\"{o}dinger
equation for a collection of \( N \) electrons subject to the
electric potential created by the fixed ions,
</p>

<p>&nbsp;<br>
$$
	\left( \sum_{i}^N \left( - \frac{\hbar^2}{2m} \frac{\partial^2}{\partial \boldsymbol{r}_i^2}
	+ V(\boldsymbol{r}_i) \right)
	 + \sum_{i < j}^N \frac{e^2}{|\boldsymbol{r}_i - \boldsymbol{r}_j|} \right) \Psi(\boldsymbol{r}) = E_0  \Psi( \boldsymbol{r} )
$$
<p>&nbsp;<br>

<p>where \( \boldsymbol{r}_i \) are the positions of the electrons.</p>
</section>

<section>
<h2 id="potential-term">Potential term </h2>
<p>The potential
\( V(\boldsymbol{r}_i) \) is created by the charged ions,
</p>
<p>&nbsp;<br>
$$
	V(\boldsymbol{r}_i) = - \sum_j \frac{e^2 Z_j}{| \boldsymbol{r}_i - \boldsymbol{R}_j|}
$$
<p>&nbsp;<br>

<p>where \( \boldsymbol{R} \) is the (static) positions of the ions and \( Z_j \) their
charge.  Note that the above Hamiltonian, the left hand side of
the last equation, contains three terms: the kinetic
energy (\( T \)), the potential energy (\( V \)) and the interaction energy
(\( U \)).
</p>
</section>

<section>
<h2 id="electronic-density">Electronic density </h2>

<p>The electronic density is obtained by integrating out all electron
degrees of freedom except one,
</p>
<p>&nbsp;<br>
$$
	n(\boldsymbol{r}) = \int d^3 \boldsymbol{r}_2 \cdots d^3 \boldsymbol{r}_N
		\left| \Psi (\boldsymbol{r}_1 \cdots \boldsymbol{r}_n) \right|^2.
$$
<p>&nbsp;<br>

<p>The total potential energy \( V \) is just given by the integral over the
potential \( V(\boldsymbol{r}) \) times the density,
</p>
<p>&nbsp;<br>
$$
	V = \int d^3 \boldsymbol{r} V(\boldsymbol{r}) n(\boldsymbol{r}).
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="hohenberg-kohn-theory">Hohenberg-Kohn theory </h2>

<p>Assume we found a solution for the Hamiltonian from the Born-Oppenheimer approximation, with
ground state energy \( E_0 \) and a certain electronic density
\( n(\boldsymbol{r}) \). The strength of the Coulomb interaction and the mass of an
electron are constants of nature, so the only input that can possibly
influence the electronic density \( n(\boldsymbol{r}) \) and the energy \( E_0 \) of our
ground state is our choice of potential \( V(\boldsymbol{r}) \). In other words, the
ground state energy is a {\em functional} of the input potential,
</p>

<p>&nbsp;<br>
$$
	E_0 [V(\boldsymbol{r})] = \mathcal{F}_E[ V(\boldsymbol{r}) ]
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="energy-functional">Energy functional </h2>
<p>A functional is nothing else than a function whose input is another
function; in this case the functional \( \mathcal{F} \) takes as input the
electric potential generated by the ions and outputs the ground state
energy based on thr Born-Oppenheimer approximation.
</p>

<p>At first this results seems counterintuitive. After all, the ground
state energy clearly contains the kinetic energy \( T \), the interaction
energy \( U \) and the potential energy. Only the latter term {\em
explicitly} depends on the potential. We can thus write the ground
state energy in terms of a separate functional for the kinetic and
interaction energy, and the potential energy
</p>

<p>&nbsp;<br>
$$
	E  [n(\boldsymbol{r})]= \mathcal{F}_E' [ V(\boldsymbol{r}) ] + \int d^3\boldsymbol{r} V(\boldsymbol{r})  n(\boldsymbol{r})
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="conjugate-varibales">Conjugate varibales </h2>

<p>Hohenberg and Kohn
came to the elegant insight that
the {\em potential \( V(\boldsymbol{r}) \) and electronic density \( n(\boldsymbol{r}) \) are
conjugate variables}. Other conjugate variables you may know are for
example pressure and volume in thermodynamics or momentum and position
in classical physics. The fact that the potential \( V(\boldsymbol{r}) \) and the
density \( n(\boldsymbol{r}) \) are conjugate means you can equally well describe any
solution of the Hamiltonian problem  using the potential or the density.
</p>
</section>

<section>
<h2 id="legendre-transform">Legendre transform </h2>

<p>Formally known as a Legendre transform (in the same way you go from
the Hamiltonian to the Lagrangian formulation of classical mechanics),
we can change the functional of the last equation  to depend on the
density \( n(\boldsymbol{r}) \) rather than the potential \( V(\boldsymbol{r}) \). This is the {\em
Hohenberg-Kohn theorem}: there exists a <b>universal</b> functional of
electronic density, \( \mathcal{F}[n(\boldsymbol{r})] \), such that for the correct
density \( n(\boldsymbol{r}) \) it provides the ground state energy of the Hamiltonian under study
</p>
<p>&nbsp;<br>
$$
	E [n(\boldsymbol{r})] = \mathcal{F}[n(\boldsymbol{r})] +  \int d^3\boldsymbol{r} V(\boldsymbol{r})  n(\boldsymbol{r}).
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="how-to-find-the-functional">How to find the functional </h2>
<p>Knowing this functional, for any given potential \( V(\boldsymbol{r}) \) we minimize
the right hand side by checking all possible electronic density
distributions.
</p>

<p>There are only two minor problems. We don't know what this functional
looks like. And even if we did, we don't know how to find the right
electronic density.
</p>
</section>

<section>
<h2 id="approximating-the-functional">Approximating the functional </h2>

<p>The unknown functional \( \mathcal{F}[n(\boldsymbol{r})] \) should describe the
kinetic and interaction energy of a system described by
for example the Born-Oppenheimer approximation. Even though we cannot find its exact
shape, we can look at its shape in some limiting cases that we can
solve.
</p>

<p>We know that a free homogeneous electron gas (HEG) with density \( n \) has a
ground state energy of
</p>

<p>&nbsp;<br>
$$
	E_0 = \frac{3 \hbar^2 \left( 3 \pi^2 \right)^{2/3}}{10 m} n_0^{5/3}.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="using-the-results-from-the-heg">Using the results from the HEG </h2>

<p>For a slowly varying electronic density, we can approximate the
kinetic energy contribution to the full functional
\( \mathcal{F}[n(\boldsymbol{r})] \) as the energy evaluated
at each point separately,
</p>

<p>&nbsp;<br>
$$
	\mathcal{T}_0 [n(\boldsymbol{r})] =
	 \frac{3 \hbar^2 \left( 3 \pi^2 \right)^{2/3}}{10 m} \int  d^3\boldsymbol{r} ( n(\boldsymbol{r}) )^{5/3}.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="hartree-term-to-the-energy">Hartree term to the energy </h2>

<p>We have also earlier derived that the simplest 
energy contribution from Coulomb interactions is given by the Hartree
term
</p>

<p>&nbsp;<br>
$$
	\mathcal{U}_{\mathrm{H}} [n(\boldsymbol{r})] = 
		\frac{e^2}{2} \int d^3\boldsymbol{r} d^3\boldsymbol{r}' \, \frac{n(\boldsymbol{r}) n(\boldsymbol{r}')}{|\boldsymbol{r} - \boldsymbol{r}'|}.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="final-functional">Final functional </h2>

<p>It is natural to write out the full functional as containing the
homogeneous electron gas term and the Hartree term. The remaining
terms, though still unknown, should be small. This unknown part is
conventionally called the {\em exchange-correlation potential}
\( E_{xc}[n(\boldsymbol{r})] \). The full Hohenberg-Kohn functional, including the
potential energy, is thus
</p>

<p>&nbsp;<br>
$$
	\mathcal{E}_{\mathrm{HK}}[n(\boldsymbol{r})] = 
		\mathcal{T}_0 [n(\boldsymbol{r})]
		 + \int d^3 \boldsymbol{r} V(r) n(\boldsymbol{r})
		 + \mathcal{U}_{\mathrm{H}} [n(\boldsymbol{r})]
		 + E_{xc} [ n(\boldsymbol{r})].
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="kohn-sham-equation">Kohn-Sham equation </h2>

<p>We replaced an intractable problem with the task of minimizing an unknown
functional \( \mathcal{F}[n(\boldsymbol{r})] \) over infinitely many possible
electronic densities \( n(\boldsymbol{r}) \). In the previous section we already gave
some first suggestions for the functional. But once we found it, how
to find the right electronic density \( n(\boldsymbol{r}) \)?
</p>

<p>Because the correct density minimizes the functional, we can find the
functional by setting it's derivative to zero,
</p>

<p>&nbsp;<br>
$$
	\frac{\delta \mathcal{F}[n(\boldsymbol{r})] }{\delta n(\boldsymbol{r})} = 0.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="kohn-sham-equations">Kohn-Sham equations </h2>
<p>Using the functional Eq(insert), we write
out
</p>

<!-- \footnote{There is a small subtlety included in this equation: the -->
<!-- kinetic component of the functional \( \mathcal{T} [n(\boldsymbol{r})] \) should not -->
<!-- be the one obtained for the free homogeneous noninteracting electron -->
<!-- gas, but the one for a noninteracting gas subject -->
<!-- to the Kohn-Sham potential.} -->

<p>&nbsp;<br>
$$
	\frac{\delta \mathcal{T}[n(\boldsymbol{r})] }{\delta n(\boldsymbol{r})}
	+ V(\boldsymbol{r})
	+ \int \frac{n(\boldsymbol{r}')}{|\boldsymbol{r}-\boldsymbol{r}'|}d^3 \boldsymbol{r}'
	+ \frac{\delta E_{xc} [n(\boldsymbol{r})] }{\delta n(\boldsymbol{r})}
	=0.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="the-equations">The equations </h2>
<p>The idea of Kohn and Sham was to treat this as if it
is a single-particle problem. The first term represents the
kinetic energy, and the remaining terms form the Kohn-Sham potential
</p>

<p>&nbsp;<br>
$$
	V_{\mathrm{KS}}(\boldsymbol{r}) = V(\boldsymbol{r})
	+ \int \frac{n(\boldsymbol{r}')}{|\boldsymbol{r}-\boldsymbol{r}'|}d^3 \boldsymbol{r}'
	+ \frac{\delta E_{xc} [n(\boldsymbol{r})] }{\delta n(\boldsymbol{r})}.
$$
<p>&nbsp;<br>

<p>The Kohn-Sham equation is the single-particle Schr\"{o}dinger
equation with the potential given by the last equation,
</p>

<p>&nbsp;<br>
$$
	\left( - \frac{\hbar^2}{2m} \frac{\partial^2}{\partial \boldsymbol{r}^2} + V_{\mathrm{KS}}(\boldsymbol{r}) \right) \psi_i(\boldsymbol{r}) = \epsilon_i \psi_i (\boldsymbol{r}).
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="numerical-solution">Numerical solution </h2>

<p>We solve these equations numerically, which is tractable because it is
just a linear differential equation. The electronic density is
obtained by occupying the \( N \) solutions \( \psi_i(\boldsymbol{r}) \) with the
lowest energy,
</p>

<p>&nbsp;<br>
$$
	n(\boldsymbol{r}) = \sum_{i=1}^N |\psi_i (\boldsymbol{r}) |^2.
$$
<p>&nbsp;<br>

<p>Now the electronic density obtained this way can be used to calculate
a new Kohn-Sham potential. We
continue this iterative procedure until we reach convergence.
</p>

<p>A final comment is in order: in the above derivation we completely
ignored the spin of electrons. Of course, real electrons have spin so
that you need that degree of freedom as well. This does not change
anything fundamental about how to use the Kohn-Sham equation.
</p>

<p>We have reached the end-goal: using the Born-Oppenheimer
approximation, with an appropriate choice of functional, we use the
Kohn-Sham equations to find the ground state energy and electronic
density of a system of interacting electrons and ions. This
combination of approximations and techniques is called {\em density
functional theory} (DFT).
</p>

<p>Despite is sometimes shaky assumptions, DFT turned out to be a
resounding success. A large majority of crystalline materials, many
molecules and molecular structures have been explained using
DFT. Walter Kohn &ndash; the man who was involved in both the
Hohenberg-Kohn theory and the Kohn-Sham equations &ndash; received the
Nobel Prize for DFT in 1998. Mainly because of this success, I assume,
you want to learn DFT in this ToolBoX.
</p>

<p>However, let me briefly shed some clouds over DFT's success.</p>

<ol>
<p><li> A major limitation of DFT is that it is impossible to tell you the size of the errors that exist due to the assumptions. If you get a self-consistent solution, that is nice, but only a comparison with the experimental system will tell you whether it is a good solution.</li>
<p><li> The electronic properties of many materials can be described using band theory, meaning for every quasimomentum \( {\bf k} \) we have a set of energies \( \epsilon_n ({\bf k}) \). The solutions of the Kohn-Sham equation are commonly interpreted as these electronic bands. However, it is important to bear in mind that in principle there is no connection to the {\em actual} electronic energy levels in a material. It just turns out that, in many materials, the Kohn-Sham energies happens to be a good approximation.</li>
<p><li> As a corollary to the previous limitation: when using DFT for an insulator or semiconductor, you can also compute the Kohn-Sham energy gap between the highest occupied and lowest unoccupied state. This is {\em not} the actual gap of the semiconductor or insulator. In practice, it turns out that DFT typically underestimates the real gap.</li>
<p><li> Note that even if we had the exact functional, solving the corresponding Kohn-Sham equations would not give you the exact solution for the ground state energy.</li>
<p><li> Because the Kohn-Sham equations describe non-interacting electrons, many materials with strong correlations cannot be described using DFT. In general, this is true for materials with partially filled \( d \) or \( f \)-orbitals; or materials with localized electrons. In particular, applying DFT to the class of high-temperature superconductors such as cuprates, pnictides, and heavy fermions is relatively unsuccessful.</li>
<p><li> Materials with ground state degeneracy &ndash; for example in the case of spontaneous symmetry breaking &ndash; are known to be difficult to compute using DFT.</li>
<p><li> There is some subtlety involved in choosing the right functional. Commonly, functionals become widely accepted because of a good overlap with experiments.</li>
</ol>
<p>
<p>DFT as introduced in the last section is a numerical technique &ndash;
there are no analytical expansions or solutions. And like many modern
numerical techniques, it is better to use an existing developed code
than to write your own. There are numerous DFT software packages, both
open source and payed. In this section we will outline the most
important choices we need to make in order to start running some code.
</p>

<p>The core of any code consists of computing the solutions to the
Kohn-Sham equation. Because this is a linear differential equation, we
need to choose a {\em basis} over which we can expand the Kohn-Sham
equation. In this way, we transformed the continuum differential
equation into a matrix equation, for which there are many known
techniques for diagonalizing it.
</p>

<p>The two most popular choices of basis are {\em plane waves} (PW) and
{\em Gaussian type orbitals} (GTO). If you are interested in the
structure of molecules, the most logical basis set is GTO where you
take a certain set of polynomials multiplied by a Gaussian envelope,
to make sure the electronic density remains close to the ions.
</p>

<p>For crystals, on the other hand, the most logical basis set is plane
waves \( \psi({\bf k}) = e^{i {\bf k} \cdot {\bf r}} \) in a box with
periodic boundary conditions. Because this course is aimed at
condensed matter physicists, we will use a plane-wave code.
</p>
</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

  // Display navigation controls in the bottom right corner
  controls: true,

  // Display progress bar (below the horiz. slider)
  progress: true,

  // Display the page number of the current slide
  slideNumber: true,

  // Push each slide change to the browser history
  history: false,

  // Enable keyboard shortcuts for navigation
  keyboard: true,

  // Enable the slide overview mode
  overview: true,

  // Vertical centering of slides
  //center: true,
  center: false,

  // Enables touch navigation on devices with touch input
  touch: true,

  // Loop the presentation
  loop: false,

  // Change the presentation direction to be RTL
  rtl: false,

  // Turns fragments on and off globally
  fragments: true,

  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,

  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,

  // Stop auto-sliding after user input
  autoSlideStoppable: true,

  // Enable slide navigation via mouse wheel
  mouseWheel: false,

  // Hides the address bar on mobile devices
  hideAddressBar: true,

  // Opens links in an iframe preview overlay
  previewLinks: false,

  // Transition style
  transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

  // Transition speed
  transitionSpeed: 'default', // default/fast/slow

  // Transition style for full page slide backgrounds
  backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

  // Number of slides away from the current that are visible
  viewDistance: 3,

  // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

  // Parallax background size
  //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

  theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
  dependencies: [
      // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

      // Interpret Markdown in <section> elements
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

      // Syntax highlight for <code> elements
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

      // Zoom in and out with Alt+click
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

      // Speaker notes
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

      // Remote control your reveal.js presentation using a touch device
      //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

      // MathJax
      //{ src: 'reveal.js/plugin/math/math.js', async: true }
  ]
});

Reveal.initialize({

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1170,  // original: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
   end footer logo -->




</body>
</html>
