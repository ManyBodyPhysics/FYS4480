<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week48.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week48-bs --no_mako
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Week 48: Coupled cluster theory and summary of course">
<title>Week 48: Coupled cluster theory and summary of course</title>
<!-- Bootstrap style: bootstrap -->
<!-- doconce format html week48.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week48-bs --no_mako -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Week 48, November 25-29, 2024',
               2,
               None,
               'week-48-november-25-29-2024'),
              ('CCSD with twobody Hamiltonian',
               2,
               None,
               'ccsd-with-twobody-hamiltonian'),
              ('Two-body normal-ordered Hamiltonian',
               2,
               None,
               'two-body-normal-ordered-hamiltonian'),
              ('Diagram equations - Derivation',
               2,
               None,
               'diagram-equations-derivation'),
              ('Diagram rules', 2, None, 'diagram-rules'),
              ('CCSD $\\hat{T}_1$ amplitude equation',
               2,
               None,
               'ccsd-hat-t-1-amplitude-equation'),
              ('CCSD $\\hat{T}_2$ amplitude equation',
               2,
               None,
               'ccsd-hat-t-2-amplitude-equation')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="week48-bs.html">Week 48: Coupled cluster theory and summary of course</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#week-48-november-25-29-2024" style="font-size: 80%;">Week 48, November 25-29, 2024</a></li>
     <!-- navigation toc: --> <li><a href="#ccsd-with-twobody-hamiltonian" style="font-size: 80%;">CCSD with twobody Hamiltonian</a></li>
     <!-- navigation toc: --> <li><a href="#two-body-normal-ordered-hamiltonian" style="font-size: 80%;">Two-body normal-ordered Hamiltonian</a></li>
     <!-- navigation toc: --> <li><a href="#diagram-equations-derivation" style="font-size: 80%;">Diagram equations - Derivation</a></li>
     <!-- navigation toc: --> <li><a href="#diagram-rules" style="font-size: 80%;">Diagram rules</a></li>
     <!-- navigation toc: --> <li><a href="#ccsd-hat-t-1-amplitude-equation" style="font-size: 80%;">CCSD \( \hat{T}_1 \) amplitude equation</a></li>
     <!-- navigation toc: --> <li><a href="#ccsd-hat-t-2-amplitude-equation" style="font-size: 80%;">CCSD \( \hat{T}_2 \) amplitude equation</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<!-- ------------------- main content ---------------------- -->
<div class="jumbotron">
<center>
<h1>Week 48: Coupled cluster theory and summary of course </h1>
</center>  <!-- document title -->

<!-- author(s): Morten Hjorth-Jensen -->
<center>
<b>Morten Hjorth-Jensen</b> 
</center>
<!-- institution -->
<center>
<b>Department of Physics and Center for Computing in Science Education, University of Oslo, Norway</b>
</center>
<br>
<center>
<h4>November 25-29, 2024</h4>
</center> <!-- date -->
<br>

<!-- potential-jumbotron-button -->
</div> <!-- end jumbotron -->

<!-- !split -->
<h2 id="week-48-november-25-29-2024" class="anchor">Week 48, November 25-29, 2024 </h2>
<ol>
<li> Thursday:
<ol type="a"></li>
 <li> Short repetition from last week</li>
 <li> How to write your own coupled-cluster theory code, pairing model example</li>
 <li> Coupled cluster theory, singles and doubles excitations, diagrammatic expansion</li>
</ol>
<li> Friday:
<ol type="a"></li>
 <li> Coupled cluster theory  for singles and doubles excitations using a diagrammatic derivation</li>
 <li> Summary of course and discussion of final oral exam</li>
</ol>
<li> Lecture material: Lecture notes and Shavitt and Bartlett chapters 9 and 10. See also slides at <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/pub/week48/pdf/cc.pdf" target="_self"><tt>https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/pub/week48/pdf/cc.pdf</tt></a></li>
</ol>
<!-- !split -->
<h2 id="ccsd-with-twobody-hamiltonian" class="anchor">CCSD with twobody Hamiltonian </h2>

<p>Truncating the cluster operator \( \hat{T} \) at the \( n=2 \) level, defines
CCSD approximation to the Coupled Cluster wavefunction.  The
coupled cluster wavefunction is now given by
</p>

$$
\begin{equation*}
            \vert \Psi_{CC}\rangle = e^{\hat{T}_1 + \hat{T}_2} \vert \Phi_0\rangle,
\end{equation*}
$$

<p>where </p>
$$
\begin{align*}
            \hat{T}_1 &= 
            \sum_{ia}
                t_{i}^{a} a_{a}^\dagger a_i \\
            \hat{T}_2 &= \frac{1}{4} 
            \sum_{ijab}
                t_{ij}^{ab} a_{a}^\dagger a_{b}^\dagger a_{j} a_{i}.
\end{align*}
$$


<!-- !split -->
<h2 id="two-body-normal-ordered-hamiltonian" class="anchor">Two-body normal-ordered Hamiltonian </h2>

$$
\begin{align*}
            \hat{H} &= \sum_{pq} \langle p\vert \hat{f} \vert q \rangle\left\{ a_p^\dagger a_q \right\} + 
                \frac{1}{4} \sum_{pqrs} \langle pq \vert \hat{v} \vert rs \rangle  \left\{ a_p^\dagger a_q^\dagger a_s a_r \right\} \\
                & \quad + \mathrm{E}_0 \\
                &= \hat{F}_N + \hat{V}_N  + \mathrm{E}_0 
                = \hat{H}_N  + \mathrm{E}_0,
\end{align*}
$$

<p>where</p>
$$
\begin{align*}
            \langle p\vert \hat{f} \vert q \rangle &= \langle p\vert \hat{h}_0 \vert q\rangle + \sum_i \langle pi\vert \hat{v} \vert qi\rangle \\
            \mathrm{E}_0 &= \sum_i \langle i\vert \hat{h}_0 \vert i\rangle + \frac{1}{2} \sum_{ij} \langle ij\vert  \hat{v} \vert ij\rangle.
\end{align*}
$$


<!-- !split -->
<h2 id="diagram-equations-derivation" class="anchor">Diagram equations - Derivation </h2>

<ol>
<li> Contract \( \hat{H}_N \) with \( \hat{T} \) in all possible unique combinations that satisfy a given form. The diagram equation is the sum of all these diagrams.</li>
<li> Contract one \( \hat{H}_N \) element with \( 0,1 \) or multiple \( \hat{T} \) elements.</li> 
<li> All \( \hat{T} \) elements must have \alert{atleast} one contraction with \( \hat{H}_N \).</li>
<li> No contractions between \( \hat{T} \) elements are allowed.</li> 
<li> A single \( \hat{T} \) element can contract with a single element of \( \hat{H}_N \) in different ways.</li>
</ol>
<!-- !split -->
<h2 id="diagram-rules" class="anchor">Diagram rules </h2>
<ol>
<li> Label all lines.</li>
<li> Sum over all internal indices.</li> 
<li> Extract matrix elements.</li> 
<li> Extract cluster amplitudes with indices in the order left to right. Incoming lines are subscripts, while outgoing lines are superscripts. (\( t_{\mathrm{in}}^{\mathrm{out}} \), \( t^{\mathrm{lout, rout}}_{\mathrm{lin, rin}} \))</li>
<li> Calculate the phase: \( (-1)^{\mathrm{holelines} + \mathrm{loops}} \)</li> 
<li> Multiply by a factor of \( \frac{1}{2} \) for each equivalent line and each ecuivalent vertex.</li>
<li> Antisymmetrize a pair of external particle/hole line that does not connect to the same operator.</li>	
</ol>
<!-- !split -->
<h2 id="ccsd-hat-t-1-amplitude-equation" class="anchor">CCSD \( \hat{T}_1 \) amplitude equation </h2>

$$
\begin{align*}
    0 &= f_{i}^a + f_{e}^a t_i^e - f_{i}^mt_m^a + \langle ma\vert\hat{v}\vert ei\rangle  t_m^e 
        + f_{e}^m t_{im}^{ae} + \frac{1}{2} \langle am\vert\hat{v}\vert ef\rangle  t_{im}^{ef} 
        &- \frac{1}{2} \langle mn\vert\hat{v}\vert ei\rangle  t_{mn}^{ea} - f_{e}^m t_i^e t_m^a
        + \langle am\vert \hat{v}\vert ef\rangle t_i^e t_m^f - \langle mn\vert\hat{v}\vert ei\rangle  t_m^e t_n^a 
        & \quad + \langle mn\vert\hat{v}\vert ef\rangle t_m^e t_{ni}^{fa}
        - \frac{1}{2} \langle mn\vert\hat{v}\vert ef\rangle  t_i^e t_{mn}^{af}
        - \frac{1}{2} \langle mn\vert\hat{v}\vert ef\rangle  t_n^a t_{mi}^{ef}
        & \quad  - \langle mn\vert\hat{v}\vert ef\rangle  t_i^e t_m^a t_n^f
\end{align*}
$$


<!-- !split -->
<h2 id="ccsd-hat-t-2-amplitude-equation" class="anchor">CCSD \( \hat{T}_2 \) amplitude equation </h2>

$$
\begin{align*}
    0 &= 
        \langle ab\vert \hat{v} \vert ij\rangle
        + P(ij) \langle ab\vert\hat{v}\vert ej\rangle  t_i^e
        - P(ab) \langle am\vert\hat{v} \vert ij\rangle  t_m^b
        + P(ab) f_{e}^b t_{ij}^{ae}
        - P(ij) f_{i}^m t_{mj}^{ab}
        & +\frac{1}{2} \langle ab\vert\hat{v}\vert ef\rangle  t_{ij}^{ef}
        + \frac{1}{2} \langle mn\vert\hat{v}\vert ij\rangle  t_{mn}^{ab}
        + P(ij) P(ab) \langle mb\vert\hat{v}\vert ej\rangle  t_{im}^{ae}
        & +\frac{1}{2} P(ij) \langle ab\vert\hat{v}\vert ef\rangle  t_i^e t_j^f
        + \frac{1}{2} P(ab) \langle mn\vert\hat{v}\vert ij\rangle  t_m^a t_n^b
        - P(ij) P(ab) \langle mb\vert\hat{v}\vert ej\rangle  t_i^e t_m^a
        & +\frac{1}{4} \langle mn\vert\hat{v}\vert ef\rangle  t_{ij}^{ef} t_{mn}^{ab}
        + \frac{1}{2} P(ij) P(ab) \langle mn\vert\hat{v}\vert ef\rangle t_{im}^{ae} t_{nj}^{fb}
        - \frac{1}{2} P(ab) \langle mn\vert\hat{v}\vert ef\rangle  t_{ij}^{ae} t_{mn}^{bf}
        & -\frac{1}{2} P(ij) \langle mn\vert\hat{v}\vert ef\rangle  t_{mi}^{ef} t_{nj}^{ab}
        - P(ij) f_{e}^m t_i^e t_{mj}^{ab}
        - P(ab) f_{e}^m t_{ij}^{ae} t_m^b
        & +P(ij) P(ab) \langle am\vert\hat{v}\vert ef\rangle  t_i^e t_{mj}^{fb}
        - \frac{1}{2} P(ab) \langle am\vert\hat{v}\vert ef\rangle  t_{ij}^{ef} t_m^b
        + P(ab) \langle bm\vert\hat{v}\vert ef\rangle  t_{ij}^{ae} t_m^f
        & -P(ij) P(ab) \langle mn\vert\hat{v} \vert ej\rangle  t_{im}^{ae} t_n^b
        + \frac{1}{2} P(ij) \langle mn\vert\hat{v}\vert ej\rangle  t_i^e t_{mn}^{ab}
        -P(ij) \langle mn\vert\hat{v}\vert ei\rangle  t_m^e t_{nj}^{ab}
        & -\frac{1}{2} P(ij) P(ab) \langle am\vert\hat{v}\vert ef\rangle  t_i^e t_j^f t_m^b
        + \frac{1}{2} P(ij) P(ab) \langle mn\vert\hat{v}\vert ej\rangle t_i^e t_m^a t_n^b
        & + \frac{1}{4} P(ij) \langle mn\vert\hat{v}\vert ef\rangle  t_i^e t_{mn}^{ab} t_j^f
        - P(ij) P(ab) \langle mn\vert\hat{v}\vert ef\rangle t_i^e t_m^a t_{nj}^{fb}
        & + \frac{1}{4} P(ab) \langle mn\vert\hat{v}\vert ef\rangle t_m^a t_{ij}^{ef} t_n^b
        - P(ij) \langle mn\vert\hat{v}\vert ef\rangle t_m^e t_i^f t_{nj}^{ab}
        - P(ab) \langle mn\vert\hat{v}\vert ef\rangle t_{ij}^{ae} t_m^b t_n^f
        & + \frac{1}{4} P(ij) P(ab) \langle mn\vert\hat{v}\vert ef\rangle t_i^e t_m^a t_j^f t_n^b
\end{align*}
$$


<!-- \include{src/ccsd_barh_expansion} -->
<!-- \include{src/ccsd_factoring} -->
<!-- \include{src/ccsd_algorithm} -->

<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2024, Morten Hjorth-Jensen. Released under CC Attribution-NonCommercial 4.0 license
</center>
</body>
</html>

