<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week40.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week40-bs --no_mako
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Week 40: Mean-field theories and Hartree-Fock equations">
<title>Week 40: Mean-field theories and Hartree-Fock equations</title>
<!-- Bootstrap style: bootstrap -->
<!-- doconce format html week40.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week40-bs --no_mako -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Week 40, September 29-October 3, 2025',
               2,
               None,
               'week-40-september-29-october-3-2025'),
              ('Why Hartree-Fock?', 2, None, 'why-hartree-fock'),
              ('Why Hartree-Fock?', 2, None, 'why-hartree-fock'),
              ('Why Hartree-Fock theory', 2, None, 'why-hartree-fock-theory'),
              ('Why Hartree-Fock theory', 2, None, 'why-hartree-fock-theory'),
              ('Variational Calculus and Lagrangian Multipliers',
               2,
               None,
               'variational-calculus-and-lagrangian-multipliers'),
              ('Variational Calculus and Lagrangian Multipliers',
               2,
               None,
               'variational-calculus-and-lagrangian-multipliers'),
              ('Variational Calculus and Lagrangian Multipliers',
               2,
               None,
               'variational-calculus-and-lagrangian-multipliers'),
              ('Variational Calculus and Lagrangian Multipliers',
               2,
               None,
               'variational-calculus-and-lagrangian-multipliers'),
              ('Variational Calculus and Lagrangian Multipliers',
               2,
               None,
               'variational-calculus-and-lagrangian-multipliers'),
              ('Variational Calculus and Lagrangian Multipliers',
               2,
               None,
               'variational-calculus-and-lagrangian-multipliers'),
              ('Variational Calculus and Lagrangian Multipliers',
               2,
               None,
               'variational-calculus-and-lagrangian-multipliers'),
              ('Derivation of Hartree-Fock equations in coordinate space',
               2,
               None,
               'derivation-of-hartree-fock-equations-in-coordinate-space'),
              ('Derivation of Hartree-Fock equations in coordinate space',
               2,
               None,
               'derivation-of-hartree-fock-equations-in-coordinate-space'),
              ('Derving the Hartree-Fock equations',
               2,
               None,
               'derving-the-hartree-fock-equations'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock algorithm', 2, None, 'hartree-fock-algorithm'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Hartree-Fock by varying the coefficients of a wave function '
               'expansion',
               2,
               None,
               'hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion'),
              ('Using the density matrix', 2, None, 'using-the-density-matrix'),
              ('Code example', 2, None, 'code-example'),
              ('Hartree-Fock in second quantization and stability of HF '
               'solution',
               2,
               None,
               'hartree-fock-in-second-quantization-and-stability-of-hf-solution'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ('New operators', 2, None, 'new-operators'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ("Showing that $|\\tilde{c}\\rangle= |c'\\rangle$",
               2,
               None,
               'showing-that-tilde-c-rangle-c-rangle'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ("Thouless' theorem", 2, None, 'thouless-theorem'),
              ('Hartree-Fock in second quantization and stability of HF '
               'solution',
               2,
               None,
               'hartree-fock-in-second-quantization-and-stability-of-hf-solution')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="week40-bs.html">Week 40: Mean-field theories and Hartree-Fock equations</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#week-40-september-29-october-3-2025" style="font-size: 80%;">Week 40, September 29-October 3, 2025</a></li>
     <!-- navigation toc: --> <li><a href="#why-hartree-fock" style="font-size: 80%;">Why Hartree-Fock?</a></li>
     <!-- navigation toc: --> <li><a href="#why-hartree-fock" style="font-size: 80%;">Why Hartree-Fock?</a></li>
     <!-- navigation toc: --> <li><a href="#why-hartree-fock-theory" style="font-size: 80%;">Why Hartree-Fock theory</a></li>
     <!-- navigation toc: --> <li><a href="#why-hartree-fock-theory" style="font-size: 80%;">Why Hartree-Fock theory</a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-and-lagrangian-multipliers" style="font-size: 80%;">Variational Calculus and Lagrangian Multipliers</a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-and-lagrangian-multipliers" style="font-size: 80%;">Variational Calculus and Lagrangian Multipliers</a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-and-lagrangian-multipliers" style="font-size: 80%;">Variational Calculus and Lagrangian Multipliers</a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-and-lagrangian-multipliers" style="font-size: 80%;">Variational Calculus and Lagrangian Multipliers</a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-and-lagrangian-multipliers" style="font-size: 80%;">Variational Calculus and Lagrangian Multipliers</a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-and-lagrangian-multipliers" style="font-size: 80%;">Variational Calculus and Lagrangian Multipliers</a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-and-lagrangian-multipliers" style="font-size: 80%;">Variational Calculus and Lagrangian Multipliers</a></li>
     <!-- navigation toc: --> <li><a href="#derivation-of-hartree-fock-equations-in-coordinate-space" style="font-size: 80%;">Derivation of Hartree-Fock equations in coordinate space</a></li>
     <!-- navigation toc: --> <li><a href="#derivation-of-hartree-fock-equations-in-coordinate-space" style="font-size: 80%;">Derivation of Hartree-Fock equations in coordinate space</a></li>
     <!-- navigation toc: --> <li><a href="#derving-the-hartree-fock-equations" style="font-size: 80%;">Derving the Hartree-Fock equations</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-algorithm" style="font-size: 80%;">Hartree-Fock algorithm</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" style="font-size: 80%;">Hartree-Fock by varying the coefficients of a wave function expansion</a></li>
     <!-- navigation toc: --> <li><a href="#using-the-density-matrix" style="font-size: 80%;">Using the density matrix</a></li>
     <!-- navigation toc: --> <li><a href="#code-example" style="font-size: 80%;">Code example</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-in-second-quantization-and-stability-of-hf-solution" style="font-size: 80%;">Hartree-Fock in second quantization and stability of HF solution</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#new-operators" style="font-size: 80%;">New operators</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#showing-that-tilde-c-rangle-c-rangle" style="font-size: 80%;">Showing that \( |\tilde{c}\rangle= |c'\rangle \)</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#thouless-theorem" style="font-size: 80%;">Thouless' theorem</a></li>
     <!-- navigation toc: --> <li><a href="#hartree-fock-in-second-quantization-and-stability-of-hf-solution" style="font-size: 80%;">Hartree-Fock in second quantization and stability of HF solution</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<!-- ------------------- main content ---------------------- -->
<div class="jumbotron">
<center>
<h1>Week 40: Mean-field theories and Hartree-Fock equations</h1>
</center>  <!-- document title -->

<!-- author(s): Morten Hjorth-Jensen -->
<center>
<b>Morten Hjorth-Jensen</b> 
</center>
<!-- institution -->
<center>
<b>Department of Physics and Center for Computing in Science Education, University of Oslo, Norway</b>
</center>
<br>
<center>
<h4>Week 40, September 29-October 3</h4>
</center> <!-- date -->
<br>

<!-- potential-jumbotron-button -->
</div> <!-- end jumbotron -->

<!-- !split -->
<h2 id="week-40-september-29-october-3-2025" class="anchor">Week 40, September 29-October 3, 2025 </h2>
<div class="panel panel-default">
<div class="panel-body">
<!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
<p>Topics to be covered</p>
<ol>
<li> Thursday:
<ol type="a"></li>
 <li> Deriving the Hartree-Fock equations</li>  
 <li> Efficient ways of implementing the Hartree-Fock algorithm
<!-- o <a href="https://youtu.be/kOsi_A1OIPk" target="_self">Video of lecture</a> -->
<!-- o <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/HandwrittenNotes/2024/NotesOctober3.pdf" target="_self">Whiteboard notes</a> --></li>
</ol>
<li> Friday:
<ol type="a"></li>
 <li> Stability of Hartree-Fock equations and Thouless' theorem
<!-- o <a href="https://youtu.be/cOeg451_0DA" target="_self">Video of lecture TBA</a> -->
<!-- o <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/HandwrittenNotes/2024/NotesOctober4.pdf" target="_self">Whiteboard notes</a> --></li>
</ol>
<li> Lecture Material: These slides and Szabo and Ostlund, sections 3.1-3.4</li>
<li> Seventh exercise set at <a href="https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/Exercises/2025/ExercisesWeek40.pdf" target="_self"><tt>https://github.com/ManyBodyPhysics/FYS4480/blob/master/doc/Exercises/2025/ExercisesWeek40.pdf</tt></a></li>
</ol>
</div>
</div>


<!-- !split -->
<h2 id="why-hartree-fock" class="anchor">Why Hartree-Fock? </h2>

<p>Hartree-Fock (HF) theory is an algorithm for finding an approximative expression for the ground state of a given Hamiltonian. The basic ingredients are</p>
<ul>
  <li> Define a single-particle basis \( \{\psi_{\alpha}\} \) so that</li>
</ul>
$$ 
\hat{h}^{\mathrm{HF}}\psi_{\alpha} = \varepsilon_{\alpha}\psi_{\alpha}
$$

<p>with the Hartree-Fock Hamiltonian defined as</p>
$$
\hat{h}^{\mathrm{HF}}=\hat{t}+\hat{u}_{\mathrm{ext}}+\hat{u}^{\mathrm{HF}}
$$


<!-- !split -->
<h2 id="why-hartree-fock" class="anchor">Why Hartree-Fock? </h2>

<ol>
<li> The term  \( \hat{u}^{\mathrm{HF}} \) is a single-particle potential to be determined by the HF algorithm.</li>
<li> The HF algorithm means to choose \( \hat{u}^{\mathrm{HF}} \) in order to have</li> 
</ol>
$$ \langle \hat{H} \rangle = E^{\mathrm{HF}}= \langle \Phi_0 | \hat{H}|\Phi_0 \rangle
$$

<p>that is to find a local minimum with a Slater determinant \( \Phi_0 \) being the ansatz for the ground state. </p>
<ol>
<li> The variational principle ensures that \( E^{\mathrm{HF}} \ge E_0 \), with \( E_0 \) the exact ground state energy.</li>
</ol>
<!-- !split -->
<h2 id="why-hartree-fock-theory" class="anchor">Why Hartree-Fock theory  </h2>

<p>We will show that the Hartree-Fock Hamiltonian \( \hat{h}^{\mathrm{HF}} \) equals our definition of the operator \( \hat{f} \) discussed in connection with the new definition of the normal-ordered Hamiltonian (see later lectures), that is we have, for a specific matrix element</p>
$$
\langle p |\hat{h}^{\mathrm{HF}}| q \rangle =\langle p |\hat{f}| q \rangle=\langle p|\hat{t}+\hat{u}_{\mathrm{ext}}|q \rangle +\sum_{i\le F} \langle pi | \hat{V} | qi\rangle_{AS},
$$

<p>meaning that</p>
$$
\langle p|\hat{u}^{\mathrm{HF}}|q\rangle = \sum_{i\le F} \langle pi | \hat{V} | qi\rangle_{AS}.
$$


<!-- !split -->
<h2 id="why-hartree-fock-theory" class="anchor">Why Hartree-Fock theory  </h2>

<p>The so-called Hartree-Fock potential \( \hat{u}^{\mathrm{HF}} \) brings an
explicit medium dependence due to the summation over all
single-particle states below the Fermi level \( F \). It brings also in an
explicit dependence on the two-body interaction (in nuclear physics we
can also have complicated three- or higher-body forces). The two-body
interaction, with its contribution from the other bystanding fermions,
creates an effective mean field in which a given fermion moves, in
addition to the external potential \( \hat{u}_{\mathrm{ext}} \) which
confines the motion of the fermion. For systems like nuclei, there is
no external confining potential. Nuclei are examples of self-bound
systems, where the binding arises due to the intrinsic nature of the
strong force. For nuclear systems thus, there would be no external
one-body potential in the Hartree-Fock Hamiltonian.
</p>

<!-- !split -->
<h2 id="variational-calculus-and-lagrangian-multipliers" class="anchor">Variational Calculus and Lagrangian Multipliers  </h2>

<p>The calculus of variations involves 
problems where the quantity to be minimized or maximized is an integral. 
</p>

<p>In the general case we have an integral of the type</p>
$$ 
E[\Phi]= \int_a^b f(\Phi(x),\frac{\partial \Phi}{\partial x},x)dx,
$$

<p>where \( E \) is the quantity which is sought minimized or maximized.</p>

<!-- !split -->
<h2 id="variational-calculus-and-lagrangian-multipliers" class="anchor">Variational Calculus and Lagrangian Multipliers  </h2>

<p>The problem is that although \( f \) is a function of the variables
\( \Phi \), \( \partial \Phi/\partial x \) and \( x \), the exact dependence of
\( \Phi \) on \( x \) is not known.  This means again that even though the
integral has fixed limits \( a \) and \( b \), the path of integration is not
known. In our case the unknown quantities are the single-particle wave
functions and we wish to choose an integration path which makes the
functional \( E[\Phi] \) stationary. This means that we want to find
minima, or maxima or saddle points. In physics we search normally for
minima.  Our task is therefore to find the minimum of \( E[\Phi] \) so
that its variation \( \delta E \) is zero subject to specific
constraints. In our case the constraints appear as the integral which
expresses the orthogonality of the single-particle wave functions.
The constraints can be treated via the technique of Lagrangian
multipliers
</p>

<!-- !split -->
<h2 id="variational-calculus-and-lagrangian-multipliers" class="anchor">Variational Calculus and Lagrangian Multipliers  </h2>

<p>Let us specialize to the expectation value of the energy for one particle in three-dimensions.
This expectation value reads
</p>
$$
  E=\int dxdydz \psi^*(x,y,z) \hat{H} \psi(x,y,z),
$$

<p>with the constraint</p>
$$
 \int dxdydz \psi^*(x,y,z) \psi(x,y,z)=1,
$$

<p>and a Hamiltonian</p>
$$
\hat{H}=-\frac{1}{2}\nabla^2+V(x,y,z).
$$


<!-- !split -->
<h2 id="variational-calculus-and-lagrangian-multipliers" class="anchor">Variational Calculus and Lagrangian Multipliers  </h2>

<p>We will, for the sake of notational convenience,  skip the variables \( x,y,z \) below, and write for example \( V(x,y,z)=V \).</p>

<p>The integral involving the kinetic energy can be written as, with the function \( \psi \) vanishing
strongly for large values of \( x,y,z \) (given here by the limits \( a \) and \( b \)), 
</p>
$$
  \int_a^b dxdydz \psi^* \left(-\frac{1}{2}\nabla^2\right) \psi dxdydz = \psi^*\nabla\psi|_a^b+\int_a^b dxdydz\frac{1}{2}\nabla\psi^*\nabla\psi.
$$

<p>We will drop the limits \( a \) and \( b \) in the remaining discussion. 
Inserting this expression into the expectation value for the energy and taking the variational minimum  we obtain
</p>
$$
\delta E = \delta \left\{\int dxdydz\left( \frac{1}{2}\nabla\psi^*\nabla\psi+V\psi^*\psi\right)\right\} = 0.
$$


<!-- !split -->
<h2 id="variational-calculus-and-lagrangian-multipliers" class="anchor">Variational Calculus and Lagrangian Multipliers  </h2>

<p>The constraint appears in integral form as </p>
$$
 \int dxdydz \psi^* \psi=\mathrm{constant},
$$

<p>and multiplying with a Lagrangian multiplier \( \lambda \) and taking the variational minimum we obtain the final variational equation</p>
$$
\delta \left\{\int dxdydz\left( \frac{1}{2}\nabla\psi^*\nabla\psi+V\psi^*\psi-\lambda\psi^*\psi\right)\right\} = 0.
$$


<!-- !split -->
<h2 id="variational-calculus-and-lagrangian-multipliers" class="anchor">Variational Calculus and Lagrangian Multipliers  </h2>

<p>We introduce the function  \( f \)</p>
$$
  f =  \frac{1}{2}\nabla\psi^*\nabla\psi+V\psi^*\psi-\lambda\psi^*\psi=
\frac{1}{2}(\psi^*_x\psi_x+\psi^*_y\psi_y+\psi^*_z\psi_z)+V\psi^*\psi-\lambda\psi^*\psi,
$$

<p>where we have skipped the dependence on \( x,y,z \) and introduced the shorthand \( \psi_x \), \( \psi_y \) and \( \psi_z \)  for the various derivatives.</p>

<p>For \( \psi^* \) the Euler-Lagrange  equations yield</p>
$$
\frac{\partial f}{\partial \psi^*}- \frac{\partial }{\partial x}\frac{\partial f}{\partial \psi^*_x}-\frac{\partial }{\partial y}\frac{\partial f}{\partial \psi^*_y}-\frac{\partial }{\partial z}\frac{\partial f}{\partial \psi^*_z}=0,
$$

<p>which results in </p>
$$
    -\frac{1}{2}(\psi_{xx}+\psi_{yy}+\psi_{zz})+V\psi=\lambda \psi.
$$


<!-- !split -->
<h2 id="variational-calculus-and-lagrangian-multipliers" class="anchor">Variational Calculus and Lagrangian Multipliers  </h2>

<p>We can then identify the  Lagrangian multiplier as the energy of the system. The last equation is 
nothing but the standard 
Schroedinger equation and the variational  approach discussed here provides 
a powerful method for obtaining approximate solutions of the wave function.
</p>

<!-- !split -->
<h2 id="derivation-of-hartree-fock-equations-in-coordinate-space" class="anchor">Derivation of Hartree-Fock equations in coordinate space </h2>

<p>Let us denote the ground state energy by \( E_0 \). According to the
variational principle we have
</p>
$$
  E_0 \le E[\Phi] = \int \Phi^*\hat{H}\Phi d\mathbf{\tau}
$$

<p>where \( \Phi \) is a trial function which we assume to be normalized</p>
$$
  \int \Phi^*\Phi d\mathbf{\tau} = 1,
$$

<p>where we have used the shorthand \( d\mathbf{\tau}=dx_1dx_2\dots dx_N \).</p>

<!-- !split -->
<h2 id="derivation-of-hartree-fock-equations-in-coordinate-space" class="anchor">Derivation of Hartree-Fock equations in coordinate space </h2>

<p>In the Hartree-Fock method the trial function is a Slater
determinant which can be rewritten as 
</p>
$$
  \Psi(x_1,x_2,\dots,x_N,\alpha,\beta,\dots,\nu) = \frac{1}{\sqrt{N!}}\sum_{P} (-)^PP\psi_{\alpha}(x_1)
    \psi_{\beta}(x_2)\dots\psi_{\nu}(x_N)=\sqrt{N!}\hat{A}\Phi_H,
$$

<p>where we have introduced the anti-symmetrization operator \( \hat{A} \) defined by the 
summation over all possible permutations <em>p</em> of two fermions.
</p>

<!-- !split -->
<h2 id="derving-the-hartree-fock-equations" class="anchor">Derving the Hartree-Fock equations </h2>

<p>We will derive the Hartree-Fock equations by expanding the single-particle functions in a
known basis and vary the coefficients, that is, the new
single-particle wave function is written as a linear expansion in
terms of a fixed chosen orthogonal basis (for example the well-known
harmonic oscillator functions or the hydrogen-like functions etc).  We
define our new Hartree-Fock single-particle basis by performing a
unitary transformation on our previous basis (labelled with greek
indices) as
</p>

$$
\begin{equation}
\psi_p^{HF}  = \sum_{\lambda} C_{p\lambda}\phi_{\lambda}. \label{eq:newbasis}
\end{equation}
$$

<p>In this case we vary the coefficients \( C_{p\lambda} \). If the basis has infinitely many solutions, we need
to truncate the above sum.  We assume that the basis \( \phi_{\lambda} \) is orthogonal.
</p>

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>It is normal to choose a single-particle basis defined as the eigenfunctions
of parts of the full Hamiltonian. The typical situation consists of the solutions of the one-body part of the Hamiltonian, that is we have
</p>
$$
\hat{h}_0\phi_{\lambda}=\epsilon_{\lambda}\phi_{\lambda}.
$$

<p>The single-particle wave functions \( \phi_{\lambda}(\mathbf{r}) \), defined by the quantum numbers \( \lambda \) and \( \mathbf{r} \)
are defined as the overlap 
</p>
$$
   \phi_{\lambda}(\mathbf{r})  = \langle \mathbf{r} | \lambda \rangle .
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>In deriving the Hartree-Fock equations, we will expand the
single-particle functions in a known basis and vary the coefficients,
that is, the new single-particle wave function is written as a linear
expansion in terms of a fixed chosen orthogonal basis (for example the
well-known harmonic oscillator functions or the hydrogen-like
functions etc).
</p>

<p>We stated that a unitary transformation keeps the orthogonality. To see this consider first a basis of vectors \( \mathbf{v}_i \),</p>
$$
\mathbf{v}_i = \begin{bmatrix} v_{i1} \\ \dots \\ \dots \\v_{in} \end{bmatrix}
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>We assume that the basis is orthogonal, that is </p>
$$
\mathbf{v}_j^T\mathbf{v}_i = \delta_{ij}.
$$

<p>An orthogonal or unitary transformation</p>
$$
\mathbf{w}_i=\mathbf{U}\mathbf{v}_i,
$$

<p>preserves the dot product and orthogonality since</p>
$$
\mathbf{w}_j^T\mathbf{w}_i=(\mathbf{U}\mathbf{v}_j)^T\mathbf{U}\mathbf{v}_i=\mathbf{v}_j^T\mathbf{U}^T\mathbf{U}\mathbf{v}_i= \mathbf{v}_j^T\mathbf{v}_i = \delta_{ij}.
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>This means that if the coefficients \( C_{p\lambda} \) belong to a unitary or orthogonal trasformation (using the Dirac bra-ket notation)</p>
$$
\vert p\rangle  = \sum_{\lambda} C_{p\lambda}\vert\lambda\rangle,
$$

<p>orthogonality is preserved, that is \( \langle \alpha \vert \beta\rangle = \delta_{\alpha\beta} \)
and \( \langle p \vert q\rangle = \delta_{pq} \). 
</p>

<p>This propertry is extremely useful when we build up a basis of many-body Stater determinant based states. </p>

<b>Note also that although a basis \( \vert \alpha\rangle \) contains an infinity of states, for practical calculations we have always to make some truncations.</b> 

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>Before we develop the Hartree-Fock equations, there is another very
useful property of determinants that we will use both in connection
with Hartree-Fock calculations. This applies also to our previous
discussion on full configuration interaction theory.
</p>

<p>Consider the following determinant</p>
$$
\left| \begin{array}{cc} \alpha_1b_{11}+\alpha_2sb_{12}& a_{12}\\
                         \alpha_1b_{21}+\alpha_2b_{22}&a_{22}\end{array} \right|=\alpha_1\left|\begin{array}{cc} b_{11}& a_{12}\\
                         b_{21}&a_{22}\end{array} \right|+\alpha_2\left| \begin{array}{cc} b_{12}& a_{12}\\b_{22}&a_{22}\end{array} \right|
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>We can generalize this to  an \( n\times n \) matrix and have </p>
$$
\left| \begin{array}{cccccc} a_{11}& a_{12} & \dots & \sum_{k=1}^n c_k b_{1k} &\dots & a_{1n}\\
a_{21}& a_{22} & \dots & \sum_{k=1}^n c_k b_{2k} &\dots & a_{2n}\\
\dots & \dots & \dots & \dots & \dots & \dots \\
\dots & \dots & \dots & \dots & \dots & \dots \\
a_{n1}& a_{n2} & \dots & \sum_{k=1}^n c_k b_{nk} &\dots & a_{nn}\end{array} \right|=
\sum_{k=1}^n c_k\left| \begin{array}{cccccc} a_{11}& a_{12} & \dots &  b_{1k} &\dots & a_{1n}\\
a_{21}& a_{22} & \dots &  b_{2k} &\dots & a_{2n}\\
\dots & \dots & \dots & \dots & \dots & \dots\\
\dots & \dots & \dots & \dots & \dots & \dots\\
a_{n1}& a_{n2} & \dots &  b_{nk} &\dots & a_{nn}\end{array} \right| .
$$

<p>This is a property we will use in our Hartree-Fock discussions. </p>

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>We can generalize the previous results, now 
with all elements \( a_{ij} \)  being given as functions of 
linear combinations  of various coefficients \( c \) and elements \( b_{ij} \),
</p>
$$
\left| \begin{array}{cccccc} \sum_{k=1}^n b_{1k}c_{k1}& \sum_{k=1}^n b_{1k}c_{k2} & \dots & \sum_{k=1}^n b_{1k}c_{kj}  &\dots & \sum_{k=1}^n b_{1k}c_{kn}\\
\sum_{k=1}^n b_{2k}c_{k1}& \sum_{k=1}^n b_{2k}c_{k2} & \dots & \sum_{k=1}^n b_{2k}c_{kj} &\dots & \sum_{k=1}^n b_{2k}c_{kn}\\
\dots & \dots & \dots & \dots & \dots & \dots \\
\dots & \dots & \dots & \dots & \dots &\dots \\
\sum_{k=1}^n b_{nk}c_{k1}& \sum_{k=1}^n b_{nk}c_{k2} & \dots & \sum_{k=1}^n b_{nk}c_{kj} &\dots & \sum_{k=1}^n b_{nk}c_{kn}\end{array} \right|=det(\mathbf{C})det(\mathbf{B}),
$$

<p>where \( det(\mathbf{C}) \) and \( det(\mathbf{B}) \) are the determinants of \( n\times n \) matrices
with elements \( c_{ij} \) and \( b_{ij} \) respectively.  
This is a property we will use in our Hartree-Fock discussions. Convince yourself about the correctness of the above expression by setting \( n=2 \). 
</p>

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>With our definition of the new basis in terms of an orthogonal basis we have</p>
$$
\psi_p(x)  = \sum_{\lambda} C_{p\lambda}\phi_{\lambda}(x).
$$

<p>If the coefficients \( C_{p\lambda} \) belong to an orthogonal or unitary matrix, the new basis
is also orthogonal. 
Our Slater determinant in the new basis \( \psi_p(x) \) is written as
</p>
$$
\frac{1}{\sqrt{N!}}
\left| \begin{array}{ccccc} \psi_{p}(x_1)& \psi_{p}(x_2)& \dots & \dots & \psi_{p}(x_N)\\
                            \psi_{q}(x_1)&\psi_{q}(x_2)& \dots & \dots & \psi_{q}(x_N)\\  
                            \dots & \dots & \dots & \dots & \dots \\
                            \dots & \dots & \dots & \dots & \dots \\
                     \psi_{t}(x_1)&\psi_{t}(x_2)& \dots & \dots & \psi_{t}(x_N)\end{array} \right|=\frac{1}{\sqrt{N!}}
\left| \begin{array}{ccccc} \sum_{\lambda} C_{p\lambda}\phi_{\lambda}(x_1)& \sum_{\lambda} C_{p\lambda}\phi_{\lambda}(x_2)& \dots & \dots & \sum_{\lambda} C_{p\lambda}\phi_{\lambda}(x_N)\\
                            \sum_{\lambda} C_{q\lambda}\phi_{\lambda}(x_1)&\sum_{\lambda} C_{q\lambda}\phi_{\lambda}(x_2)& \dots & \dots & \sum_{\lambda} C_{q\lambda}\phi_{\lambda}(x_N)\\  
                            \dots & \dots & \dots & \dots & \dots \\
                            \dots & \dots & \dots & \dots & \dots \\
                     \sum_{\lambda} C_{t\lambda}\phi_{\lambda}(x_1)&\sum_{\lambda} C_{t\lambda}\phi_{\lambda}(x_2)& \dots & \dots & \sum_{\lambda} C_{t\lambda}\phi_{\lambda}(x_N)\end{array} \right|,
$$

<p>which is nothing but \( det(\mathbf{C})det(\Phi) \), with \( det(\Phi) \) being the determinant given by the basis functions \( \phi_{\lambda}(x) \). </p>

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>In our discussions hereafter we will use our definitions of single-particle states above and below the Fermi (\( F \)) level given by the labels
\( ijkl\dots \le F \) for so-called single-hole states and \( abcd\dots > F \) for so-called particle states.
For general single-particle states we employ the labels \( pqrs\dots \). 
</p>

<p>We have</p>
$$
  E[\Phi] 
  = \sum_{\mu=1}^N \langle \mu | h | \mu \rangle +
  \frac{1}{2}\sum_{{\mu}=1}^N\sum_{{\nu}=1}^N \langle \mu\nu|\hat{v}|\mu\nu\rangle_{AS},
$$

<p>we found the expression for the energy functional in terms of the basis function \( \phi_{\lambda}(\mathbf{r}) \). We then  varied the above energy functional with respect to the basis functions \( |\mu \rangle \). </p>

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>Now we are interested in defining a new basis defined in terms of
a chosen basis as defined in Eq.&nbsp;\eqref{eq:newbasis}. We can then rewrite the energy functional as
</p>
$$
\begin{equation}
  E[\Phi^{HF}] 
  = \sum_{i=1}^N \langle i | h | i \rangle +
  \frac{1}{2}\sum_{ij=1}^N\langle ij|\hat{v}|ij\rangle_{AS}, \label{FunctionalEPhi2}
\end{equation}
$$

<p>where \( \Phi^{HF} \) is the new Slater determinant defined by the new basis of Eq.&nbsp;\eqref{eq:newbasis}. </p>

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>Using Eq.&nbsp;\eqref{eq:newbasis} we can rewrite Eq.&nbsp;\eqref{FunctionalEPhi2} as </p>
$$
\begin{equation}
  E[\Psi] 
  = \sum_{i=1}^N \sum_{\alpha\beta} C^*_{i\alpha}C_{i\beta}\langle \alpha | h | \beta \rangle +
  \frac{1}{2}\sum_{ij=1}^N\sum_{{\alpha\beta\gamma\delta}} C^*_{i\alpha}C^*_{j\beta}C_{i\gamma}C_{j\delta}\langle \alpha\beta|\hat{v}|\gamma\delta\rangle_{AS}. \label{FunctionalEPhi3}
\end{equation}
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>We wish now to minimize the above functional. We introduce again a set of Lagrange multipliers, noting that
since \( \langle i | j \rangle = \delta_{i,j} \) and \( \langle \alpha | \beta \rangle = \delta_{\alpha,\beta} \), 
the coefficients \( C_{i\gamma} \) obey the relation
</p>
$$
 \langle i | j \rangle=\delta_{i,j}=\sum_{\alpha\beta} C^*_{i\alpha}C_{i\beta}\langle \alpha | \beta \rangle=
\sum_{\alpha} C^*_{i\alpha}C_{i\alpha},
$$

<p>which allows us to define a functional to be minimized that reads</p>
$$
\begin{equation}
  F[\Phi^{HF}]=E[\Phi^{HF}] - \sum_{i=1}^N\epsilon_i\sum_{\alpha} C^*_{i\alpha}C_{i\alpha}.
\label{_auto1}
\end{equation}
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>Minimizing with respect to \( C^*_{i\alpha} \), remembering that the equations for \( C^*_{i\alpha} \) and \( C_{i\alpha} \)
can be written as two  independent equations, we obtain
</p>
$$
\frac{d}{dC^*_{i\alpha}}\left[  E[\Phi^{HF}] - \sum_{j}\epsilon_j\sum_{\alpha} C^*_{j\alpha}C_{j\alpha}\right]=0,
$$

<p>which yields for every single-particle state \( i \) and index \( \alpha \) (recalling that the coefficients \( C_{i\alpha} \) are matrix elements of a unitary (or orthogonal for a real symmetric matrix) matrix)
the following Hartree-Fock equations
</p>
$$
\sum_{\beta} C_{i\beta}\langle \alpha | h | \beta \rangle+
\sum_{j=1}^N\sum_{\beta\gamma\delta} C^*_{j\beta}C_{j\delta}C_{i\gamma}\langle \alpha\beta|\hat{v}|\gamma\delta\rangle_{AS}=\epsilon_i^{HF}C_{i\alpha}.
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>We can rewrite this equation as (changing dummy variables)</p>
$$
\sum_{\beta} \left\{\langle \alpha | h | \beta \rangle+
\sum_{j}^N\sum_{\gamma\delta} C^*_{j\gamma}C_{j\delta}\langle \alpha\gamma|\hat{v}|\beta\delta\rangle_{AS}\right\}C_{i\beta}=\epsilon_i^{HF}C_{i\alpha}.
$$

<p>Note that the sums over greek indices run over the number of basis set functions (in principle an infinite number).</p>

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>Defining </p>
$$
h_{\alpha\beta}^{HF}=\langle \alpha | h | \beta \rangle+
\sum_{j=1}^N\sum_{\gamma\delta} C^*_{j\gamma}C_{j\delta}\langle \alpha\gamma|\hat{v}|\beta\delta\rangle_{AS},
$$

<p>we can rewrite the new equations as </p>
$$
\begin{equation}
\sum_{\beta}h_{\alpha\beta}^{HF}C_{i\beta}=\epsilon_i^{HF}C_{i\alpha}. \label{eq:newhf}
\end{equation}
$$

<p>The latter is nothing but a standard eigenvalue problem. </p>

<p>We see that we do not need to compute any integrals in an iterative
procedure for solving the equations.  It suffices to tabulate the
matrix elements \( \langle \alpha | h | \beta \rangle \) and \( \langle
\alpha\gamma|\hat{v}|\beta\delta\rangle_{AS} \) once and for
all. Successive iterations require thus only a look-up in tables over
one-body and two-body matrix elements. These details will be discussed
below when we solve the Hartree-Fock equations numerical.
</p>

<!-- !split -->
<h2 id="hartree-fock-algorithm" class="anchor">Hartree-Fock algorithm </h2>

<p>Our Hartree-Fock matrix  is thus</p>
$$
\hat{h}_{\alpha\beta}^{HF}=\langle \alpha | \hat{h}_0 | \beta \rangle+
\sum_{j=1}^N\sum_{\gamma\delta} C^*_{j\gamma}C_{j\delta}\langle \alpha\gamma|\hat{v}|\beta\delta\rangle_{AS}.
$$

<p>The Hartree-Fock equations are solved in an iterative waym starting with a guess for the coefficients \( C_{j\gamma}=\delta_{j,\gamma} \) and solving the equations by diagonalization till the new single-particle energies
\( \epsilon_i^{\mathrm{HF}} \) do not change anymore by a prefixed quantity. 
</p>

<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>Normally we assume that the single-particle basis \( |\beta\rangle \) forms an eigenbasis for the operator
\( \hat{h}_0 \), meaning that the Hartree-Fock matrix becomes  
</p>
$$
\hat{h}_{\alpha\beta}^{HF}=\epsilon_{\alpha}\delta_{\alpha,\beta}+
\sum_{j=1}^N\sum_{\gamma\delta} C^*_{j\gamma}C_{j\delta}\langle \alpha\gamma|\hat{v}|\beta\delta\rangle_{AS}.
$$

<p>The Hartree-Fock eigenvalue problem</p>
$$
\sum_{\beta}\hat{h}_{\alpha\beta}^{HF}C_{i\beta}=\epsilon_i^{\mathrm{HF}}C_{i\alpha},
$$

<p>can be written out in a more compact form as</p>
$$
\hat{h}^{HF}\hat{C}=\epsilon^{\mathrm{HF}}\hat{C}. 
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>The Hartree-Fock equations are, in their simplest form, solved in an
iterative way, starting with a guess for the coefficients
\( C_{i\alpha} \). We label the coefficients as \( C_{i\alpha}^{(n)} \), where
the subscript \( n \) stands for iteration \( n \).  To set up the algorithm
we can proceed as follows:
</p>

<ul>
 <li> We start with a guess \( C_{i\alpha}^{(0)}=\delta_{i,\alpha} \). Alternatively, we could have used random starting values as long as the vectors are normalized. Another possibility is to give states below the Fermi level a larger weight.</li>
 <li> The Hartree-Fock matrix simplifies then to (assuming that the coefficients \( C_{i\alpha}  \)  are real)</li>
</ul>
$$
\hat{h}_{\alpha\beta}^{HF}=\epsilon_{\alpha}\delta_{\alpha,\beta}+
\sum_{j = 1}^N\sum_{\gamma\delta} C_{j\gamma}^{(0)}C_{j\delta}^{(0)}\langle \alpha\gamma|\hat{v}|\beta\delta\rangle_{AS}.
$$


<!-- !split -->
<h2 id="hartree-fock-by-varying-the-coefficients-of-a-wave-function-expansion" class="anchor">Hartree-Fock by varying the coefficients of a wave function expansion </h2>

<p>Solving the Hartree-Fock eigenvalue problem yields then new eigenvectors \( C_{i\alpha}^{(1)} \) and eigenvalues
\( \epsilon_i^{HF(1)} \). 
</p>
<ul>
 <li> With the new eigenvalues we can set up a new Hartree-Fock potential</li> 
</ul>
$$
\sum_{j = 1}^N\sum_{\gamma\delta} C_{j\gamma}^{(1)}C_{j\delta}^{(1)}\langle \alpha\gamma|\hat{v}|\beta\delta\rangle_{AS}.
$$

<p>The diagonalization with the new Hartree-Fock potential yields new eigenvectors and eigenvalues.
This process is continued till for example
</p>
$$
\frac{\sum_{p} |\epsilon_i^{(n)}-\epsilon_i^{(n-1)}|}{m} \le \lambda,  
$$

<p>where \( \lambda \) is a user prefixed quantity (\( \lambda \sim 10^{-8} \) or smaller) and \( p \) runs over all calculated single-particle
energies and \( m \) is the number of single-particle states.
</p>

<!-- !split -->
<h2 id="using-the-density-matrix" class="anchor">Using the density matrix </h2>

<p>The equations are often rewritten in terms of a so-called density matrix,
which is defined as 
</p>
$$
\begin{equation}
\rho_{\gamma\delta}=\sum_{i=1}^{N}\langle\gamma|i\rangle\langle i|\delta\rangle = \sum_{i=1}^{N}C_{i\gamma}C^*_{i\delta}.
\label{_auto2}
\end{equation}
$$

<p>It means that we can rewrite the Hartree-Fock Hamiltonian as</p>
$$
\hat{h}_{\alpha\beta}^{HF}=\epsilon_{\alpha}\delta_{\alpha,\beta}+
\sum_{\gamma\delta} \rho_{\gamma\delta}\langle \alpha\gamma|V|\beta\delta\rangle_{AS}.
$$

<p>It is convenient to use the density matrix since we can precalculate in every iteration the product of two eigenvector components \( C \). </p>

<!-- !split -->
<h2 id="code-example" class="anchor">Code example </h2>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">HartreeFock</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, num_electrons, num_orbitals):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>num_electrons <span style="color: #666666">=</span> num_electrons
        <span style="color: #008000">self</span><span style="color: #666666">.</span>num_orbitals <span style="color: #666666">=</span> num_orbitals
	<span style="color: #408080; font-style: italic"># You would need to replace these by proper integrals</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>h <span style="color: #666666">=</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>rand(num_orbitals, num_orbitals)  <span style="color: #408080; font-style: italic"># One-electron integrals</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>coulomb <span style="color: #666666">=</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>rand(num_orbitals, num_orbitals, num_orbitals, num_orbitals)  <span style="color: #408080; font-style: italic"># Two-electron integrals</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">build_fock_matrix</span>(<span style="color: #008000">self</span>, density_matrix):
        fock_matrix <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>h<span style="color: #666666">.</span>copy()
        <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>num_orbitals):
            <span style="color: #008000; font-weight: bold">for</span> j <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>num_orbitals):
                fock_matrix[i, j] <span style="color: #666666">+=</span> np<span style="color: #666666">.</span>sum(density_matrix <span style="color: #666666">*</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>coulomb[i, j])
        <span style="color: #008000; font-weight: bold">return</span> fock_matrix
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">build_density_matrix</span>(<span style="color: #008000">self</span>, coefficients):
        density_matrix <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((<span style="color: #008000">self</span><span style="color: #666666">.</span>num_orbitals, <span style="color: #008000">self</span><span style="color: #666666">.</span>num_orbitals))
        <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>num_electrons):
            density_matrix <span style="color: #666666">+=</span> np<span style="color: #666666">.</span>outer(coefficients[:, i], coefficients[:, i])
        <span style="color: #008000; font-weight: bold">return</span> density_matrix
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">diagonalize</span>(<span style="color: #008000">self</span>, fock_matrix):
        energy, coefficients <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linalg<span style="color: #666666">.</span>eigh(fock_matrix)
        <span style="color: #008000; font-weight: bold">return</span> energy, coefficients
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">run</span>(<span style="color: #008000">self</span>, max_iter<span style="color: #666666">=100</span>, tol<span style="color: #666666">=1e-6</span>):
        coeffs <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((<span style="color: #008000">self</span><span style="color: #666666">.</span>num_orbitals, <span style="color: #008000">self</span><span style="color: #666666">.</span>num_electrons))
        density_matrix <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((<span style="color: #008000">self</span><span style="color: #666666">.</span>num_orbitals, <span style="color: #008000">self</span><span style="color: #666666">.</span>num_orbitals))
        <span style="color: #008000; font-weight: bold">for</span> iteration <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(max_iter):
            fock_matrix <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>build_fock_matrix(density_matrix)
            energies, coeffs <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>diagonalize(fock_matrix)
            
            new_density_matrix <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>build_density_matrix(coeffs)
            <span style="color: #008000; font-weight: bold">if</span> np<span style="color: #666666">.</span>linalg<span style="color: #666666">.</span>norm(new_density_matrix <span style="color: #666666">-</span> density_matrix) <span style="color: #666666">&lt;</span> tol:
                <span style="color: #008000">print</span>(<span style="color: #BA2121">f&quot;Converged in </span><span style="color: #BB6688; font-weight: bold">{</span>iteration<span style="color: #BB6688; font-weight: bold">}</span><span style="color: #BA2121"> iterations&quot;</span>)
                <span style="color: #008000; font-weight: bold">break</span>
            density_matrix <span style="color: #666666">=</span> new_density_matrix
        <span style="color: #008000; font-weight: bold">return</span> energies, coeffs
<span style="color: #408080; font-style: italic"># Example usage</span>
<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">__name__</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;__main__&quot;</span>:
    num_electrons <span style="color: #666666">=</span> <span style="color: #666666">2</span>
    num_orbitals <span style="color: #666666">=</span> <span style="color: #666666">4</span>
    hf <span style="color: #666666">=</span> HartreeFock(num_electrons, num_orbitals)
    energies, coefficients <span style="color: #666666">=</span> hf<span style="color: #666666">.</span>run()
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Final energies:&quot;</span>, energies)
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Final coefficients:&quot;</span>, coefficients)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<!-- !split -->
<h2 id="hartree-fock-in-second-quantization-and-stability-of-hf-solution" class="anchor">Hartree-Fock in second quantization and stability of HF solution </h2>

<p>We wish now to derive the Hartree-Fock equations using our second-quantized formalism and study the stability of the equations. 
Our ansatz for the ground state of the system is approximated as (this is our representation of a Slater determinant in second quantization)
</p>
$$   
|\Phi_0\rangle = |c\rangle = a^{\dagger}_i a^{\dagger}_j \dots a^{\dagger}_l|0\rangle.
$$

<p>We wish to determine \( \hat{u}^{HF} \) so that 
\( E_0^{HF}= \langle c|\hat{H}| c\rangle \) becomes a local minimum. 
</p>

<p>In our analysis here we will need Thouless' theorem, which states that
an arbitrary Slater determinant \( |c'\rangle \) which is not orthogonal to a determinant
\( | c\rangle ={\displaystyle\prod_{i=1}^{n}}
a_{\alpha_{i}}^{\dagger}|0\rangle \), can be written as
</p>
$$
|c'\rangle=exp\left\{\sum_{a>F}\sum_{i\le F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| c\rangle 
$$


<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>Let us give a simple proof of Thouless' theorem. The theorem states that we can make a linear combination av particle-hole excitations  with respect to a given reference state \( \vert c\rangle \). With this linear combination, we can make a new Slater determinant \( \vert c'\rangle  \) which is not orthogonal to 
\( \vert c\rangle \), that is
</p>
$$
\langle c|c'\rangle \ne 0.
$$

<p>To show this we need some intermediate steps. The exponential product of two operators  \( \exp{\hat{A}}\times\exp{\hat{B}} \) is equal to \( \exp{(\hat{A}+\hat{B})} \) only if the two operators commute, that is</p>
$$
[\hat{A},\hat{B}] = 0.
$$


<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>If the operators do not commute, we need to resort to the <a href="http://www.encyclopediaofmath.org/index.php/Campbell%E2%80%93Hausdorff_formula" target="_self">Baker-Campbell-Hauersdorf</a>. This relation states that</p>
$$
\exp{\hat{C}}=\exp{\hat{A}}\exp{\hat{B}},
$$

<p>with </p>
$$
\hat{C}=\hat{A}+\hat{B}+\frac{1}{2}[\hat{A},\hat{B}]+\frac{1}{12}[[\hat{A},\hat{B}],\hat{B}]-\frac{1}{12}[[\hat{A},\hat{B}],\hat{A}]+\dots
$$


<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>From these relations, we note that 
in our expression  for \( |c'\rangle \) we have commutators of the type
</p>
$$
[a_{a}^{\dagger}a_{i},a_{b}^{\dagger}a_{j}],
$$

<p>and it is easy to convince oneself that these commutators, or higher powers thereof, are all zero. This means that we can write out our new representation of a Slater determinant as</p>
$$
|c'\rangle=exp\left\{\sum_{a>F}\sum_{i\le F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| c\rangle=\prod_{i}\left\{1+\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}+\left(\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\right)^2+\dots\right\}| c\rangle
$$


<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>We note that</p>
$$
\prod_{i}\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\sum_{b>F}C_{bi}a_{b}^{\dagger}a_{i}| c\rangle =0,
$$

<p>and all higher-order powers of these combinations of creation and annihilation operators disappear 
due to the fact that \( (a_i)^n| c\rangle =0 \) when \( n > 1 \). This allows us to rewrite the expression for \( |c'\rangle  \) as
</p>
$$
|c'\rangle=\prod_{i}\left\{1+\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| c\rangle,
$$

<p>which we can rewrite as </p>
$$
|c'\rangle=\prod_{i}\left\{1+\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| a^{\dagger}_{i_1} a^{\dagger}_{i_2} \dots a^{\dagger}_{i_n}|0\rangle.
$$


<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>The last equation can be written as</p>
$$
\begin{align}
|c'\rangle&=\prod_{i}\left\{1+\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| a^{\dagger}_{i_1} a^{\dagger}_{i_2} \dots a^{\dagger}_{i_n}|0\rangle=\left(1+\sum_{a>F}C_{ai_1}a_{a}^{\dagger}a_{i_1}\right)a^{\dagger}_{i_1} 
\label{_auto3}\\
& \times\left(1+\sum_{a>F}C_{ai_2}a_{a}^{\dagger}a_{i_2}\right)a^{\dagger}_{i_2} \dots |0\rangle=\prod_{i}\left(a^{\dagger}_{i}+\sum_{a>F}C_{ai}a_{a}^{\dagger}\right)|0\rangle.
\label{_auto4}
\end{align}
$$


<!-- !split -->
<h2 id="new-operators" class="anchor">New operators </h2>

<p>If we define a new creation operator </p>
$$
\begin{equation}
b^{\dagger}_{i}=a^{\dagger}_{i}+\sum_{a>F}C_{ai}a_{a}^{\dagger}, \label{eq:newb}
\end{equation}
$$

<p>we have </p>
$$
|c'\rangle=\prod_{i}b^{\dagger}_{i}|0\rangle=\prod_{i}\left(a^{\dagger}_{i}+\sum_{a>F}C_{ai}a_{a}^{\dagger}\right)|0\rangle,
$$

<p>meaning that the new representation of the Slater determinant in second quantization, \( |c'\rangle \), looks like our previous ones. However, this representation is not general enough since we have a restriction on the sum over single-particle states in Eq.&nbsp;\eqref{eq:newb}. The single-particle states have all to be above the Fermi level.</p>

<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>The question then is whether we can construct a general representation of a Slater determinant with a creation operator </p>
$$
\tilde{b}^{\dagger}_{i}=\sum_{p}f_{ip}a_{p}^{\dagger},
$$

<p>where \( f_{ip} \) is a matrix element of a unitary matrix which transforms our creation and annihilation operators
\( a^{\dagger} \) and \( a \) to \( \tilde{b}^{\dagger} \) and \( \tilde{b} \). These new operators define a new representation of a Slater determinant as
</p>
$$
|\tilde{c}\rangle=\prod_{i}\tilde{b}^{\dagger}_{i}|0\rangle.
$$


<!-- !split -->
<h2 id="showing-that-tilde-c-rangle-c-rangle" class="anchor">Showing that \( |\tilde{c}\rangle= |c'\rangle \)  </h2>

<p>We need to show that \( |\tilde{c}\rangle= |c'\rangle \). We need also to assume that the new state
is not orthogonal to \( |c\rangle \), that is \( \langle c| \tilde{c}\rangle \ne 0 \). From this it follows that 
</p>
$$
\langle c| \tilde{c}\rangle=\langle 0| a_{i_n}\dots a_{i_1}\left(\sum_{p=i_1}^{i_n}f_{i_1p}a_{p}^{\dagger} \right)\left(\sum_{q=i_1}^{i_n}f_{i_2q}a_{q}^{\dagger} \right)\dots \left(\sum_{t=i_1}^{i_n}f_{i_nt}a_{t}^{\dagger} \right)|0\rangle,
$$

<p>which is nothing but the determinant \( det(f_{ip}) \) which we can, using the intermediate normalization condition, 
normalize to one, that is
</p>
$$
det(f_{ip})=1,
$$

<p>meaning that \( f \) has an inverse defined as (since we are dealing with orthogonal, and in our case unitary as well, transformations)</p>
$$
\sum_{k} f_{ik}f^{-1}_{kj} = \delta_{ij},
$$

<p>and </p>
$$
\sum_{j} f^{-1}_{ij}f_{jk} = \delta_{ik}.
$$


<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>Using these relations we can then define the linear combination of creation (and annihilation as well) 
operators as
</p>
$$
\sum_{i}f^{-1}_{ki}\tilde{b}^{\dagger}_{i}=\sum_{i}f^{-1}_{ki}\sum_{p=i_1}^{\infty}f_{ip}a_{p}^{\dagger}=a_{k}^{\dagger}+\sum_{i}\sum_{p=i_{n+1}}^{\infty}f^{-1}_{ki}f_{ip}a_{p}^{\dagger}.
$$

<p>Defining </p>
$$
c_{kp}=\sum_{i \le F}f^{-1}_{ki}f_{ip},
$$

<p>we can redefine </p>
$$
a_{k}^{\dagger}+\sum_{i}\sum_{p=i_{n+1}}^{\infty}f^{-1}_{ki}f_{ip}a_{p}^{\dagger}=a_{k}^{\dagger}+\sum_{p=i_{n+1}}^{\infty}c_{kp}a_{p}^{\dagger}=b_k^{\dagger},
$$

<p>our starting point.</p>

<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>We have shown that our general representation of a Slater determinant </p>
$$
|\tilde{c}\rangle=\prod_{i}\tilde{b}^{\dagger}_{i}|0\rangle=|c'\rangle=\prod_{i}b^{\dagger}_{i}|0\rangle,
$$

<p>with </p>
$$
b_k^{\dagger}=a_{k}^{\dagger}+\sum_{p=i_{n+1}}^{\infty}c_{kp}a_{p}^{\dagger}.
$$


<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>This means that we can actually write an ansatz for the ground state of the system as a linear combination of
terms which contain the ansatz itself \( |c\rangle \) with  an admixture from an infinity of one-particle-one-hole states. The latter has important consequences when we wish to interpret the Hartree-Fock equations and their stability. We can rewrite the new representation as 
</p>
$$
|c'\rangle = |c\rangle+|\delta c\rangle,
$$

<p>where \( |\delta c\rangle \) can now be interpreted as a small variation. If we approximate this term with 
contributions from one-particle-one-hole (<em>1p-1h</em>) states only, we arrive at 
</p>
$$
|c'\rangle = \left(1+\sum_{ai}\delta C_{ai}a_{a}^{\dagger}a_i\right)|c\rangle.
$$


<!-- !split -->
<h2 id="thouless-theorem" class="anchor">Thouless' theorem </h2>

<p>In our derivation of the Hartree-Fock equations we have shown that </p>
$$
\langle \delta c| \hat{H} | c\rangle =0,
$$

<p>which means that we have to satisfy</p>
$$
\langle c|\sum_{ai}\delta C_{ai}\left\{a_{a}^{\dagger}a_i\right\} \hat{H} | c\rangle =0.
$$

<p>With this as a background, we are now ready to study the stability of the Hartree-Fock equations.
This is the topic for week 40.
</p>

<!-- !split -->
<h2 id="hartree-fock-in-second-quantization-and-stability-of-hf-solution" class="anchor">Hartree-Fock in second quantization and stability of HF solution </h2>

<p>The variational condition for deriving the Hartree-Fock equations
guarantees only that the expectation value \( \langle c | \hat{H} | c
\rangle \) has an extreme value, not necessarily a minimum. To figure
out whether the extreme value we have found is a minimum, we can use
second quantization to analyze our results and find a criterion for
the above expectation value to a local minimum. We will use Thouless'
theorem and show that
</p>

$$
\frac{\langle c' |\hat{H} | c'\rangle}{\langle c' |c'\rangle} \ge \langle c |\hat{H} | c\rangle= E_0,
$$

<p>with</p>
$$
 {|c'\rangle} = {|c\rangle + |\delta c\rangle}.
$$

<p>Using Thouless' theorem we can write out \( |c'\rangle \) as</p>
$$
\begin{align}
 {|c'\rangle}&=\exp\left\{\sum_{a > F}\sum_{i \le F}\delta C_{ai}a_{a}^{\dagger}a_{i}\right\}| c\rangle
\label{_auto5}\\ 
&=\left\{1+\sum_{a > F}\sum_{i \le F}\delta C_{ai}a_{a}^{\dagger}
a_{i}+\frac{1}{2!}\sum_{ab > F}\sum_{ij \le F}\delta C_{ai}\delta C_{bj}a_{a}^{\dagger}a_{i}a_{b}^{\dagger}a_{j}+\dots\right\}
\label{_auto6}
\end{align}
$$

<p>where the amplitudes \( \delta C \) are small.</p>

<p>The norm of \( |c'\rangle \) is given by (using the intermediate normalization condition \( \langle c' |c\rangle=1 \)) </p>
$$
\langle c' | c'\rangle = 1+\sum_{a>F}
\sum_{i\le F}|\delta C_{ai}|^2+O(\delta C_{ai}^3).
$$

<p>The expectation value for the energy is now given by (using the Hartree-Fock condition)</p>
$$
\langle c' |\hat{H} | c'\rangle=\langle c |\hat{H} | c\rangle +
\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}^*\delta C_{bj}\langle c |a_{i}^{\dagger}a_{a}\hat{H}a_{b}^{\dagger}a_{j}|c\rangle+
$$

$$
\frac{1}{2!}\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}\delta C_{bj}\langle c |\hat{H}a_{a}^{\dagger}a_{i}a_{b}^{\dagger}a_{j}|c\rangle+\frac{1}{2!}\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}^*\delta C_{bj}^*\langle c|a_{j}^{\dagger}a_{b}a_{i}^{\dagger}a_{a}\hat{H}|c\rangle
+\dots
$$

<p>We have already calculated the second term on the right-hand side of the previous equation</p>
$$
\begin{align}
\langle c | \left(\{a^\dagger_i a_a\} \hat{H} \{a^\dagger_b a_j\} \right) | c\rangle&=\sum_{pq} \sum_{ijab}\delta C_{ai}^*\delta C_{bj} \langle p|\hat{h}_0 |q\rangle 
            \langle c | \left(\{a^{\dagger}_i a_a\}\{a^{\dagger}_pa_q\} 
             \{a^{\dagger}_b a_j\} \right)| c\rangle
\label{_auto7}\\
& +\frac{1}{4} \sum_{pqrs} \sum_{ijab}\delta C_{ai}^*\delta C_{bj} \langle pq| \hat{v}|rs\rangle 
            \langle c | \left(\{a^\dagger_i a_a\}\{a^{\dagger}_p a^{\dagger}_q a_s  a_r\} \{a^{\dagger}_b a_j\} \right)| c\rangle ,
\label{_auto8}
\end{align}
$$

<p>resulting in</p>
$$
E_0\sum_{ai}|\delta C_{ai}|^2+\sum_{ai}|\delta C_{ai}|^2(\varepsilon_a-\varepsilon_i)-\sum_{ijab} \langle aj|\hat{v}| bi\rangle \delta C_{ai}^*\delta C_{bj}.
$$


$$
\frac{1}{2!}\langle c |\left(\{a^\dagger_j a_b\} \{a^\dagger_i a_a\} \hat{V}_N  \right) | c\rangle  = 
\frac{1}{2!}\langle c |\left( \hat{V}_N \{a^\dagger_a a_i\} \{a^\dagger_b a_j\} \right)^{\dagger} | c\rangle 
$$

<p>which is nothing but</p>
$$
\frac{1}{2!}\langle c |  \left( \hat{V}_N \{a^\dagger_a a_i\} \{a^\dagger_b a_j\} \right) | c\rangle^*
=\frac{1}{2} \sum_{ijab} (\langle ij|\hat{v}|ab\rangle)^*\delta C_{ai}^*\delta C_{bj}^*
$$

<p>or </p>
$$
\frac{1}{2} \sum_{ijab} (\langle ab|\hat{v}|ij\rangle)\delta C_{ai}^*\delta C_{bj}^*
$$

<p>where we have used the relation</p>
$$ 
\langle a |\hat{A} | b\rangle =  (\langle b |\hat{A}^{\dagger} | a\rangle)^*
$$

<p>due to the hermiticity of \( \hat{H} \) and \( \hat{V} \).</p>

<p>We define two matrix elements</p>
$$
A_{ai,bj}=-\langle aj|\hat{v} bi\rangle
$$

<p>and</p>
$$
B_{ai,bj}=\langle ab|\hat{v}|ij\rangle
$$

<p>both being anti-symmetrized.</p>

<p>With these definitions we write out the energy as</p>
$$
\begin{align}
\langle c'|H|c'\rangle& = \left(1+\sum_{ai}|\delta C_{ai}|^2\right)\langle c |H|c\rangle+\sum_{ai}|\delta C_{ai}|^2(\varepsilon_a^{HF}-\varepsilon_i^{HF})+\sum_{ijab}A_{ai,bj}\delta C_{ai}^*\delta C_{bj}+
\label{_auto9}\\
&\frac{1}{2} \sum_{ijab} B_{ai,bj}^*\delta C_{ai}\delta C_{bj}+\frac{1}{2} \sum_{ijab} B_{ai,bj}\delta C_{ai}^*\delta C_{bj}^*
+O(\delta C_{ai}^3),
\label{_auto10}
\end{align}
$$

<p>which can be rewritten as</p>
$$
\langle c'|H|c'\rangle = \left(1+\sum_{ai}|\delta C_{ai}|^2\right)\langle c |H|c\rangle+\Delta E+O(\delta C_{ai}^3),
$$

<p>and skipping higher-order terms we arrived</p>
$$
\frac{\langle c' |\hat{H} | c'\rangle}{\langle c' |c'\rangle} =E_0+\frac{\Delta E}{\left(1+\sum_{ai}|\delta C_{ai}|^2\right)}.
$$

<p>We have defined </p>
$$
\Delta E = \frac{1}{2} \langle \chi | \hat{M}| \chi \rangle
$$

<p>with the vectors </p>
$$ 
\chi = \left[ \delta C\hspace{0.2cm} \delta C^*\right]^T
$$

<p>and the matrix </p>
$$
\hat{M}=\left(\begin{array}{cc} \Delta + A & B \\ B^* & \Delta + A^*\end{array}\right),
$$

<p>with \( \Delta_{ai,bj} = (\varepsilon_a-\varepsilon_i)\delta_{ab}\delta_{ij} \).</p>

<p>The condition</p>
$$
\Delta E = \frac{1}{2} \langle \chi | \hat{M}| \chi \rangle \ge 0
$$

<p>for an arbitrary  vector </p>
$$ 
\chi = \left[ \delta C\hspace{0.2cm} \delta C^*\right]^T
$$

<p>means that all eigenvalues of the matrix have to be larger than or equal zero. 
A necessary (but no sufficient) condition is that the matrix elements (for all \( ai \) )
</p>
$$
(\varepsilon_a-\varepsilon_i)\delta_{ab}\delta_{ij}+A_{ai,bj} \ge 0.
$$

<p>This equation can be used as a first test of the stability of the Hartree-Fock equation.</p>

<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2025, Morten Hjorth-Jensen. Released under CC Attribution-NonCommercial 4.0 license
</center>
</body>
</html>

