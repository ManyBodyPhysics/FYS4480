\section{MBPT with a Hartree-Fock Reference: Dropping Hartree-Fock Insertions}
 
\subsection{Hamiltonian Partitioning and Hartree-Fock Reference}
 
In many-body perturbation theory (MBPT) we partition the Hamiltonian $\hat{H}$ into an unperturbed part $\hat{H}0$ and a residual interaction $\hat{H}1$. Using a Hartree–Fock (HF) basis, it is natural to choose $\hat{H}0$ as the Fock operator (the one-body HF Hamiltonian) and $\hat{H}1$ as the remaining two-body residual interaction. Formally, we write:
\hat{H} = \hat{H}_0 + \hat{H}_1,
with
\hat{H}_0 = \sum_{p} f_p \, a_p^\dagger a_p, \qquad \hat{H}_1 = \hat{H} - \hat{H}_0.
Here $a_p^\dagger, a_p$ are creation and annihilation operators for a single-particle state $p$ (in some orthonormal spin-orbital basis), and $f_p$ is the HF single-particle energy of orbital $p$. In practice, $\hat{H}0$ includes the kinetic energy and an average mean-field potential, $f{pq} = h{pq} + \sum{j\ \text{occ}}\langle pj||qj \rangle$, chosen such that $f{pq}$ is diagonal in the HF orbital basis (i.e. $f{pq}=f_p,\delta_{pq}$). We then identify the residual interaction $\hat{H}1$ as the difference between the true Hamiltonian and this mean-field part. In second-quantized form, for a two-body interaction $V$, one convenient form is:
\begin{equation}
\hat{H}1 ;=; \hat{V} - \hat{U},
\end{equation}
where $\hat{V} = \frac{1}{4}\sum{pqrs}\langle pq||rs\rangle,a_p^\dagger a_q^\dagger a_s a_r$ is the exact two-body interaction (in normal-ordered form), and $\hat{U} = \sum{p} U_p,a_p^\dagger a_p$ is the chosen one-body HF potential. By construction, $\hat{U}$ generates the same mean-field experienced by each particle in the HF state, so that $\hat{H}_0 = \hat{T} + \hat{U}$ (with $\hat{T}$ the one-body kinetic energy) is the Fock operator. Equivalently, $\hat{H}_1 = \hat{V} - \hat{U}$ represents the effective (residual) interaction beyond Hartree–Fock.
 
This choice of $\hat{H}0$ ensures that $\hat{H}0|\Phi_0\rangle = E{\mathrm{HF}}|\Phi_0\rangle$, where $|\Phi_0\rangle$ is the HF ground-state Slater determinant with energy $E{\mathrm{HF}}$. It also implies that $\hat{H}_1$ is strictly zero in all one-body matrix elements that are already accounted for by HF. In particular, any expectation value of $\hat{H}_1$ taken in the HF ground state vanishes by construction:
\langle \Phi_0|\hat{H}_1|\Phi_0\rangle \;=\; \langle \Phi_0|\hat{V}|\Phi_0\rangle - \langle \Phi_0|\hat{U}|\Phi_0\rangle \;=\; 0\,,
because $\hat{U}$ was chosen to exactly cancel the mean-field part of $\hat{V}$ in the reference state. This leads to the important result that there is no first-order energy correction beyond the HF energy when using a HF reference (the first-order term in MBPT is zero) . In other words, $E^{(1)} = \langle \Phi_0|\hat{H}_1|\Phi_0\rangle = 0$ in Møller–Plesset perturbation theory with an HF zeroth-order Hamiltonian.
 
\subsection{Hartree-Fock Self-Consistency and Vanishing One-Body Insertions}
 
A central property of the HF basis is the Hartree–Fock self-consistency condition, which implies that the HF determinant has no admixture with any singly-excited determinant. Formally, Brillouin’s theorem states that the Hamiltonian has zero coupling between the HF ground state and any single excitation:
\begin{equation}
\langle \Phi_0 \mid \hat{H} \mid \Phi_i^a \rangle ;=; 0,,
\end{equation}
where $|\Phi_i^a\rangle$ is a determinant obtained by exciting one electron from an occupied HF orbital $i$ to some virtual (unoccupied) orbital $a$.  Equivalently, $\langle \psi_0|\hat{H}|\psi_a^r\rangle = 0$ for any occupied $a$ and virtual $r$ . We can prove this by expanding the matrix element in terms of one- and two-body integrals (using Slater–Condon rules). In an orthonormal HF orbital basis, one finds:
\langle \Phi_0|\hat{H}|\Phi_i^a\rangle \;=\; \langle a|h|i\rangle + \sum_{j\ \text{occ}}\langle a j || i j \rangle\,,
where $h$ is the one-electron (kinetic + external potential) operator and $\langle a j||i j\rangle$ denotes an antisymmetrized two-electron integral. The first term is the one-body part that connects $i$ to $a$, and the second term represents the Coulomb and exchange interaction of the excited electron $a$ with each occupied orbital $j$. The sum of these terms is precisely the off-diagonal Fock matrix element $f_{ai} \equiv \langle a|\hat{F}|i\rangle$ . However, the Fock operator was defined to diagonalize the mean-field; hence for an optimized HF state, $f_{ai}=0$ for any occupied $i$ and virtual $a$ (the Fock matrix has no off-diagonal couplings between occupied and virtual orbitals by the HF variational principle ). Thus,
\begin{equation}
\langle \Phi_0|\hat{H}|\Phi_i^a\rangle ;=; \langle a|\hat{F}|i\rangle ;=; 0,,
\end{equation}
establishing that all single excitations decouple from the HF ground state .
 
Since $\hat{H}_1 = \hat{H} - \hat{H}_0$ and $\hat{H}_0$ is diagonal in the HF basis, the same conclusion holds for the residual interaction:
\begin{equation}
\langle \Phi_0 \mid \hat{H}_1 \mid \Phi_i^a \rangle ;=; 0,.
\end{equation}
This means any one-body “insertion” connecting the reference determinant to a singly-excited determinant has zero amplitude. Diagrammatically, such an insertion is often depicted as a single interaction line attached to one propagating particle line (for example, a tadpole diagram or a single exchange loop on an external line). The vanishing of these matrix elements implies that any Goldstone diagram containing a vertex that connects to the rest of the diagram by only one particle line will have a zero contribution. In essence, a Hartree-Fock insertion (an interaction that acts as a one-body potential on a single line) yields no net effect in perturbation theory when using a HF basis. The HF self-consistency ensures that the mean-field has already been accounted for, so such insertions are redundant or cancel out.
 
To make this concrete, consider the specific case of the Hartree and Fock self-energy diagrams. In a generic (non-self-consistent) basis, one can draw second-order diagrams in which an occupied particle propagator emits and reabsorbs a virtual excitation via the two-body interaction (these are the one-body self-energy corrections often called the Hartree diagram — a particle interacting with the average field of others — and the Fock (exchange) diagram). In an HF basis, the sum of the direct and exchange self-energy contributions on a given occupied line is exactly canceled by the counterterm coming from the $-,\hat{U}$ part of $\hat{H}_1$. In other words, the residual interaction $\hat{V}-\hat{U}$ is constructed so that any diagram consisting of a single $V$-insertion on an otherwise unperturbed line is nullified by the corresponding $-U$ insertion. This cancellation can be verified order by order: for example, at second order there are several diagrams containing a non-propagating interaction on a single line (i.e. an internal loop that immediately reconnects to the same line). In HF-MBPT all such diagrams cancel out, leaving only the truly correlated two-body diagrams (the familiar non-zero second-order diagrams correspond to genuine two-particle excitations, such as the Møller–Plesset second-order double-excitation graphs) . Thus, any perturbation diagram featuring an internal Hartree-Fock potential insertion or a one-body self-energy subdiagram yields zero contribution in the HF basis.
 
\subsection{Diagrammatic Consequences and Rules in the HF Basis}
 
The above results lead to simplifications in the diagrammatic expansion of MBPT (often drawn as Goldstone diagrams in time-ordered form). First, because $\langle \Phi_0|\hat{H}_1|\Phi_0\rangle = 0$, there are no first-order correlation diagrams beyond the trivial HF energy diagram. The first non-zero correlation diagrams appear at second order, and they correspond only to linked diagrams involving at least two interaction vertices. Any diagram consisting of a single interaction line attached to the reference (for instance, a single $V$ that creates and annihilates an excitation on the same line) is excluded — it cancels out due to the HF counterterm or yields zero by the HF condition .
 
Second, by virtue of working in a canonical HF basis, all diagrams containing a disconnected piece or a redundant one-body insertion can be discarded. Diagrams are considered disconnected if they factor into independent sub-diagrams with no mutual interactions (for example, a diagram where one part corresponds to an excitation and another part is just a separate loop on an occupied line). The linked-cluster theorem guarantees that such disconnected diagrams do not contribute to the connected energy of the system: they cancel out when one properly accounts for the exponential of the disconnected vacuum diagrams (or, equivalently, they are eliminated by the normalization of the wavefunction in Rayleigh–Schrödinger perturbation theory). Therefore, only linked (connected) diagrams need to be evaluated for the perturbation expansion of the energy or wavefunction. In an HF-based MBPT, this principle is neatly aligned with the fact that $\hat{H}_1$ is normal-ordered with respect to $|\Phi_0\rangle$ and has zero expectation value: any diagram not fully linked to external lines will contain a vacuum expectation part that cancels out.
 
Third, we can also ignore any one-particle-reducible diagrams in the correlation energy expansion. A one-particle-reducible diagram is one that can be split into two distinct parts by cutting a single propagator line. Such diagrams effectively represent a single-particle propagator being corrected by an intermediate self-energy insertion. However, since we use HF single-particle propagators (with energies $\varepsilon_p = f_p$) as the starting point, the effect of summing an infinite series of such self-energy insertions has already been encapsulated in those propagators. In other words, the HF basis provides dressed propagators that include mean-field self-energy effects, so one-particle-reducible contributions would double-count corrections already included. In practice, any one-particle-reducible diagram in MBPT containing a Hartree-Fock insertion on a line will evaluate to zero or cancel out against other diagrams because of the HF conditions discussed above. We thus restrict our attention to one-particle-irreducible (1PI) diagrams for the perturbative evaluation of proper energy corrections. All non-1PI diagrams either factorize into lower-order pieces or vanish due to the HF choice of $\hat{H}_0$.
 
In summary, using a Hartree-Fock reference leads to a perturbation expansion where many diagrams drop out by formal arguments:
 
No tadpoles or HF insertions: Any diagram with an interaction connecting only to a single external line (a Hartree or Fock self-energy insertion) gives zero contribution in a HF basis, due to the HF self-consistent field equations ($\langle \Phi_0| \hat{H}_1 |\Phi_0\rangle = 0$ and $\langle \Phi_0| \hat{H}_1 |\Phi_i^a\rangle = 0$) . Such diagrams are omitted from the Goldstone diagrammatic expansion.
Only linked diagrams contribute: Disconnected diagrams (those containing isolated parts not connected by interaction lines to the rest of the diagram) cancel out and do not affect observable quantities. This is ensured by the linked-cluster theorem and the structure of $\hat{H}_1$ in normal-ordered form. We include only connected (linked) diagrams in the MBPT expansion of energy and amplitudes.
Exclude reducible diagrams: Diagrams that are one-particle-reducible (having a cuttable propagator line that splits the diagram) are not included as separate contributions, since their effect is already absorbed in the HF single-particle energies. We count only irreducible diagrams which represent genuine new correlation effects beyond the mean field.
 
 
These rules streamline MBPT in the HF basis. The HF reference effectively serves as a vacuum with respect to which all perturbations are measured, and the HF equations guarantee that any spurious corrections (disconnected loops or single-particle shifts) vanish or cancel. The remaining Goldstone diagrams are exactly those that correspond to true many-body correlations (e.g. two-particle–two-hole excitations, etc.), and their contributions can be summed systematically. This results in a cleaner and more efficient perturbation series: for example, at second order only the two linked double-excitation diagrams survive (the direct and exchange $pphh$ diagrams for MP2), while all nine possible diagrams containing a $(V - U)$ insertion on a single line are eliminated in the HF basis . Thus, working in the Hartree-Fock basis allows us to drop all diagrams with Hartree-Fock insertions or disconnected parts, yielding a well-behaved, size-extensive perturbation expansion that starts at second order and includes only the relevant correlated diagrams.

Morten Hjorth-Jensen, Michigan State University and University of Oslo, Norway. http://mhjgit.github.io/info/doc/web
